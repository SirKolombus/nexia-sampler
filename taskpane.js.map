{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://nexia-sampler/webpack/bootstrap","webpack://nexia-sampler/webpack/runtime/global","webpack://nexia-sampler/webpack/runtime/hasOwnProperty shorthand","webpack://nexia-sampler/webpack/runtime/publicPath","webpack://nexia-sampler/webpack/runtime/jsonp chunk loading","webpack://nexia-sampler/./src/taskpane/FS_Parametry.js","webpack://nexia-sampler/./src/taskpane/taskpane.js","webpack://nexia-sampler/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// FS_Parametry — seznam všech kombinací pro druhou úlohu\n// Každý záznam má tvar: { controlRisk, inherentRisk, analyticalTests, controlTests, factor }\n// Pole \"factor\" je zde vyplněno textem \"DOPLŇ\" - doplň prosím požadované číslo pro každou kombinaci.\n\nconst rows = [\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Nízké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.1' },\n  { controlRisk: 'Nízké', inherentRisk: 'Střední', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.6' },\n  { controlRisk: 'Nízké', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: '0.7' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.4' },\n  { controlRisk: 'Střední', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '1.1' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '1.8' },\n  { controlRisk: 'Střední', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: '1.4' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: 'Test kontrol Error' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: '2.3' },\n  { controlRisk: 'Střední', inherentRisk: 'Vysoké', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: 'Test kontrol Error' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.1' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Nízké', rmmLevel: 'Nízké', analyticalTests: 'Ne', controlTests: 'Ne', factor: '1.9' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.4' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Střední', rmmLevel: 'Střední', analyticalTests: 'Ne', controlTests: 'Ne', factor: '2.3' },\n\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ano', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ano', controlTests: 'Ne', factor: '1.9' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ne', controlTests: 'Ano', factor: 'Test kontrol Error' },\n  { controlRisk: 'Vysoké', inherentRisk: 'Vysoké', rmmLevel: 'Vysoké', analyticalTests: 'Ne', controlTests: 'Ne', factor: '3' }\n];\n\nexport default rows;\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office, localStorage, setTimeout */\n\n// Globální proměnné pro konfiguraci vzorkovače\nlet reliabilityConfig = {\n  confidence: 95,\n  expectedError: 5,\n  populationSize: 1000\n};\n// Flag whether the reliability factor has been explicitly set by the user\nlet reliabilitySet = false;\n\n// Remember last computed total (SUM of ABS) for Task 5\nlet totalSumABS = null;\n// Requested/confirmed sample size (user-chosen)\nlet requestedSampleSize = null;\nlet requestedSampleReason = null;\n// Seed for reproducible RNG (Task6)\nlet task6Seed = null;\n\n// Import FS_PARAMETRY (in-code mapping of combinations to numeric factor)\nimport fsParams from './FS_Parametry';\n\n// Optimalized batch size for large datasets\nconst BATCH_SIZE = 2000; // Reduced from 5000 for better memory management\nconst LARGE_DATASET_THRESHOLD = 50000; // Warn user for datasets larger than this\nconst MEMORY_CRITICAL_THRESHOLD = 200000; // Extra precautions for very large datasets\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    \n  // Nastavení event listenerů (s kontrolou existence prvků)\n  const setReliabilityBtn = document.getElementById(\"set-reliability\");\n  if (setReliabilityBtn) setReliabilityBtn.onclick = openReliabilityDialog;\n\n  // wire reset sampler button\n  const resetBtnMain = document.getElementById('reset-sampler');\n  if (resetBtnMain) resetBtnMain.onclick = resetSampler;\n\n  const selectRangeBtn = document.getElementById(\"select-range\");\n  if (selectRangeBtn) selectRangeBtn.onclick = selectDataRange;\n\n  // New button to select column for value column (task 4)\n  const selectColumnBtn = document.getElementById(\"select-column\");\n  if (selectColumnBtn) selectColumnBtn.onclick = selectValueColumn;\n\n  // Task 5: compute sum button wiring\n  const task5Btn = document.getElementById('task5-compute-sum');\n  if (task5Btn) task5Btn.onclick = computeTask5Sum;\n\n  // Task 5: compute sample size wiring\n  const task5SizeBtn = document.getElementById('task5-calc-size');\n  if (task5SizeBtn) task5SizeBtn.onclick = computeTask5Size;\n\n  // Task 5: choice whether to use calculated size\n  const task5UseSelect = document.getElementById('task5-use-calculated');\n  if (task5UseSelect) task5UseSelect.onchange = handleTask5UseChoice;\n  // confirm button\n  const task5ConfirmBtn = document.getElementById('task5-confirm-size');\n  if (task5ConfirmBtn) task5ConfirmBtn.onclick = confirmRequestedSize;\n  // wire sampling method change to update Task6 method display\n  const samplingMethodEl = document.getElementById('sampling-method');\n  if (samplingMethodEl) samplingMethodEl.onchange = () => {\n    const m = document.getElementById('task6-method-display');\n    if (m) m.value = samplingMethodEl.options[samplingMethodEl.selectedIndex].text;\n  };\n  // also populate on load with current selection\n  try {\n    const m0 = document.getElementById('task6-method-display');\n    const samplingMethodEl0 = document.getElementById('sampling-method');\n    if (m0 && samplingMethodEl0) m0.value = samplingMethodEl0.options[samplingMethodEl0.selectedIndex].text;\n  } catch (e) {}\n\n  // Wire Task6: exclude-over-significance select\n  const task6ExcludeSel = document.getElementById('task6-exclude-over-significance');\n  if (task6ExcludeSel) {\n    task6ExcludeSel.onchange = (ev) => {\n      try { saveTask6ExcludeSetting(task6ExcludeSel.value); } catch (e) { console.warn('Nelze uložit volbu v Task6:', e); }\n    };\n  }\n  // load persisted value\n  try { loadTask6ExcludeSetting(); } catch (e) { /* ignore */ }\n  try { loadTask6PrintTarget(); } catch (e) { /* ignore */ }\n  // wire compute adjusted sum button if present\n  const task6ComputeBtn = document.getElementById('task6-compute-adjusted-sum');\n  if (task6ComputeBtn) task6ComputeBtn.onclick = computeTask6AdjustedSum;\n  // wire print target select\n  const printTargetSel = document.getElementById('task6-print-target');\n  if (printTargetSel) {\n    printTargetSel.onchange = () => { try { saveTask6PrintTarget(printTargetSel.value); } catch (e) { console.warn(e); } };\n  }\n  // wire generate sample button in Task6\n  const task6GenBtn = document.getElementById('task6-generate-sample');\n  if (task6GenBtn) task6GenBtn.onclick = task6GenerateSampleHandler;\n  const task6ParamsBtn = document.getElementById('task6-generate-parameters');\n  if (task6ParamsBtn) task6ParamsBtn.onclick = task6GenerateParametersHandler;\n\n  // wire seed input\n  const seedEl = document.getElementById('task6-seed');\n  if (seedEl) seedEl.onchange = () => { try { saveTask6Seed(seedEl.value); } catch (e) { console.warn(e); } };\n  try { loadTask6Seed(); } catch (e) {}\n\n  // wire seed buttons\n  const genSeedBtn = document.getElementById('task6-generate-seed');\n  const regenSeedBtn = document.getElementById('task6-regenerate-seed');\n  if (genSeedBtn) genSeedBtn.onclick = () => { const s = makeRandomSeed(); try { document.getElementById('task6-seed').value = s; saveTask6Seed(s); showNotification('Seed vygenerován.'); } catch (e) { console.warn(e); } };\n  if (regenSeedBtn) regenSeedBtn.onclick = () => { const s = makeRandomSeed(); try { document.getElementById('task6-seed').value = s; saveTask6Seed(s); showNotification('Seed znovu vygenerován.'); } catch (e) { console.warn(e); } };\n\n  // Significance (task 5) wiring\n  const fillSignificanceBtn = document.getElementById('fill-significance');\n  if (fillSignificanceBtn) fillSignificanceBtn.onclick = openSignificanceDialog;\n\n  // Modal buttons for significance\n  const sigSave = document.getElementById('significance-save-btn');\n  const sigCancel = document.getElementById('significance-cancel-btn');\n  const sigReset = document.getElementById('significance-reset-btn');\n  if (sigSave) sigSave.onclick = handleSignificanceSave;\n  if (sigCancel) sigCancel.onclick = () => { const m = document.getElementById('significance-modal'); if (m) m.style.display = 'none'; };\n  if (sigReset) sigReset.onclick = handleSignificanceReset;\n    \n    // Inicializace s výchozími hodnotami\n    // load persisted settings if any\n    loadReliabilityFromStorage();\n    updateReliabilityDisplay();\n\n    // Load significance value from storage\n    loadSignificanceFromStorage();\n  // Load last computed total for Task 5 if present\n  try { loadTotalSumAbsFromStorage(); } catch (e) {}\n\n    // Wire modal buttons if present\n    const modal = document.getElementById(\"reliability-modal\");\n    const saveBtn = document.getElementById(\"modal-save-btn\");\n    const cancelBtn = document.getElementById(\"modal-cancel-btn\");\n    const resetBtn = document.getElementById(\"modal-reset-btn\");\n    if (saveBtn) saveBtn.onclick = handleModalSave;\n    if (cancelBtn) cancelBtn.onclick = () => {\n      if (modal) modal.style.display = \"none\";\n    };\n    if (resetBtn) resetBtn.onclick = handleModalReset;\n  }\n});\n\n// Funkce pro otevření dialogu faktoru spolehlivosti\n// Open modal-based reliability dialog\nasync function openReliabilityDialog() {\n  const modal = document.getElementById(\"reliability-modal\");\n  if (!modal) {\n    showNotification(\"Dialog není dostupný.\");\n    return;\n  }\n  // populate selects with current values (if present)\n  const controlEl = document.getElementById(\"reliability-control-risk\");\n  const inherentEl = document.getElementById(\"reliability-inherent-risk\");\n  const rmmEl = document.getElementById(\"reliability-rmm-level\");\n  const analyticalEl = document.getElementById(\"reliability-analytical-tests\");\n  const controlTestsEl = document.getElementById(\"reliability-control-tests\");\n\n  if (controlEl && reliabilityConfig.controlRisk) controlEl.value = reliabilityConfig.controlRisk;\n  // Always set selects to stored value or empty string so placeholder '<Vyberte>' appears\n  if (controlEl) controlEl.value = reliabilityConfig.controlRisk || '';\n  if (inherentEl) inherentEl.value = reliabilityConfig.inherentRisk || '';\n  if (rmmEl) rmmEl.value = reliabilityConfig.rmmLevel || '';\n  if (analyticalEl) analyticalEl.value = reliabilityConfig.analyticalTests || '';\n  if (controlTestsEl) controlTestsEl.value = reliabilityConfig.controlTests || '';\n\n  modal.style.display = \"flex\";\n}\n\n// Reset all UI fields and stored settings to initial state\nfunction resetSampler() {\n  try {\n    // Clear various UI inputs\n    const idsToClear = [\n  'reliability-factor', 'significance-type-display', 'significance-value-display', 'significance-justification-display',\n  'sampling-method', 'data-range', 'value-column', 'task5-result-display', 'task5-size-display', 'task5-use-calculated', 'task5-override-size', 'task5-override-reason', 'task5-confirm-info',\n  'task6-method-display', 'task6-final-size-display', 'task6-exclude-over-significance', 'task6-param-sum-display', 'task6-significant-count-display', 'task6-print-target', 'task6-seed'\n    ];\n    idsToClear.forEach(id => {\n      try {\n        const el = document.getElementById(id);\n        if (!el) return;\n        if (el.tagName === 'SELECT') { el.value = ''; }\n        else el.value = '';\n      } catch (e) {}\n    });\n\n    // hide optional areas\n    const overrideArea = document.getElementById('task5-override-area'); if (overrideArea) overrideArea.style.display = 'none';\n    const countArea = document.getElementById('task6-count-area'); if (countArea) countArea.style.display = 'none';\n    const resultsDiv = document.getElementById('results'); if (resultsDiv) resultsDiv.style.display = 'none';\n\n    // Clear stored configs\n  const keys = ['reliabilityConfig','significanceConfig','TotalSumABS','task6ExcludeOverSignificance','task6PrintTarget','task6Seed'];\n    keys.forEach(k => { try { localStorage.removeItem(k); } catch (e) {} });\n\n    // Reset in-memory vars\n    reliabilityConfig = { confidence:95, expectedError:5, populationSize:1000 };\n    reliabilitySet = false;\n    totalSumABS = null;\n    requestedSampleSize = null;\n    requestedSampleReason = null;\n\n    // Update UI displays that need special handling\n    // ensure sampling method select and Task6 method display show placeholder\n    try {\n      const samplingMethodEl = document.getElementById('sampling-method');\n      if (samplingMethodEl) samplingMethodEl.value = '';\n      const task6MethodEl = document.getElementById('task6-method-display');\n      if (task6MethodEl) { task6MethodEl.value = '<Vyberte>'; }\n    } catch (e) {}\n    updateReliabilityDisplay();\n    showNotification('Vzorkovač byl restartován.');\n  } catch (e) {\n    console.error('Chyba při resetu vzorkovače:', e);\n    showNotification('Chyba při restartu vzorkovače.');\n  }\n}\n\n// Default handler for Task6 \"Vygenerovat výběr vzorku\" button.\n// Currently delegates to existing generateSample() function; can be extended per your design.\nasync function task6GenerateSampleHandler() {\n  let success = false;\n  try {\n    const methodEl = document.getElementById('sampling-method');\n    const method = methodEl ? methodEl.value : null;\n    if (method === 'monetary-random-walk') {\n      success = await generateMonetaryRandomWalkTask6();\n      } else if (method === 'random-number-generator') {\n        success = await generateRandomNumberGeneratorTask6();\n      } else {\n        await generateSample();\n        success = true;\n    }\n  } catch (e) {\n    console.error('Chyba při spuštění generování vzorku z Task6:', e);\n    showNotification('Chyba při generování vzorku.');\n  }\n}\n\n// Handler for the \"Vygenerovat parametry vzorkovače\" button\nasync function task6GenerateParametersHandler() {\n  try {\n    const target = _get_selected_value('task6-print-target');\n    if (target && target !== '') {\n      const params = gatherSamplerParameters();\n      await printParameters(params, target);\n      showNotification('Parametry byly vygenerovány.');\n    } else {\n      showNotification('Vyberte prosím cíl pro tisk parametrů.');\n    }\n  } catch (e) {\n    console.error('Chyba při generování parametrů:', e);\n    showNotification('Chyba při generování parametrů.');\n  }\n}\n\n// Implementation for \"Náhodný generátor čísel\" invoked from Task6\nasync function generateRandomNumberGeneratorTask6() {\n  try {\n    const dataRange = document.getElementById('data-range') && document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column') && document.getElementById('value-column').value;\n    if (!dataRange || !valueColumn) { showNotification('Nejdříve vyberte oblast dat a sloupec (úloha 4).'); return false; }\n\n    // exclude setting and significance\n    const excludeSel = document.getElementById('task6-exclude-over-significance');\n    const exclude = excludeSel && excludeSel.value === 'yes';\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) {}\n    if (exclude && (significance === null || Number.isNaN(significance))) {\n      showNotification('Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3).');\n      return false;\n    }\n\n    // determine sample size (prefer requestedSampleSize)\n    let sampleSize = requestedSampleSize || null;\n    if (!sampleSize) {\n      const display = document.getElementById('task5-size-display');\n      if (display && display.value) {\n        const parsed = parseNumberLoose(display.value);\n        if (parsed !== null) sampleSize = Math.ceil(parsed);\n      }\n    }\n    if (!sampleSize || sampleSize <= 0) { showNotification('Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5.'); return false; }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['values','rowIndex','columnIndex','rowCount','columnCount']);\n      await context.sync();\n\n      const values = range.values;\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n      const rowCount = range.rowCount || (values ? values.length : 0);\n\n      if (!Array.isArray(values) || values.length <= 1 || relColIndex < 0 || relColIndex >= (values[0] ? values[0].length : 0)) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        return false;\n      }\n\n      const dataRows = Math.max(0, rowCount - 1); // exclude header\n      if (dataRows === 0) { showNotification('Datová oblast neobsahuje žádné řádky.'); return false; }\n\n      // step based on number of rows (not sum)\n      const step = dataRows / sampleSize;\n      if (!isFinite(step) || step <= 0) { showNotification('Neplatný krok (krok <= 0).'); return false; }\n\n  // random start in [0, step)\n  const rng = getTask6Rng();\n  const start = (typeof rng === 'function' ? rng() : Math.random()) * step;\n\n      // selection counts per data row (0-based index for data rows)\n      const selCounts = new Array(dataRows).fill(0);\n\n      for (let k = 0; k < sampleSize; k++) {\n        const acc = start + k * step;\n        // wrap-around using modulo of dataRows\n        let posFloat = acc % dataRows;\n        if (posFloat < 0) posFloat += dataRows;\n        const posIndex = Math.floor(posFloat); // 0-based among data rows\n        selCounts[posIndex] = (selCounts[posIndex] || 0) + 1;\n      }\n\n      // Write header row\n      const newCols = 2;\n      const writeColIndex = range.columnIndex + range.columnCount;\n      const headerRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, 1, newCols);\n      headerRange.values = [['Pořadí', 'Výběr']];\n      headerRange.format.font.bold = true;\n\n      // Process data rows in batches\n      const batchGen = readRangeInBatches(context, worksheet, range, BATCH_SIZE);\n      for await (const { values: batchValues, startRow: batchStartRow } of batchGen) {\n        const isFirstBatch = batchStartRow === range.rowIndex;\n        const startIdx = isFirstBatch ? 1 : 0; // skip header row\n        const outputRows = [];\n        for (let i = startIdx; i < batchValues.length; i++) {\n          const absoluteRowIdx = (batchStartRow - range.rowIndex) + i; // 0‑based index within the range\n          const order = absoluteRowIdx; // same as row number (header is 0)\n          const absRaw = batchValues[i][relColIndex];\n          const parsed = parseNumberLoose(absRaw);\n          const absVal = parsed === null ? 0 : Math.abs(parsed);\n          const dataRowZeroBased = absoluteRowIdx - 1;\n          let selection = 'Ne';\n          if (exclude && significance !== null && absVal > significance) {\n            selection = 'Ano - významnost';\n          } else if (selCounts[dataRowZeroBased] && selCounts[dataRowZeroBased] > 0) {\n            const cnt = selCounts[dataRowZeroBased];\n            selection = cnt === 1 ? 'Ano - NGČ' : `Ano - NGČ (x${cnt})`;\n          }\n          outputRows.push([order, selection]);\n        }\n        const writeStartRow = range.rowIndex + (isFirstBatch ? 1 : (batchStartRow - range.rowIndex));\n        await writeRangeInBatches(context, worksheet, writeStartRow, writeColIndex, outputRows, BATCH_SIZE);\n      }\n\n      await context.sync();\n\n  const usedSeed2 = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value) || '';\n  showNotification('Generování (NGČ) dokončeno. Výsledky jsou vloženy do listu.' + (usedSeed2 ? ` Použit seed: ${usedSeed2}` : ''));\n    });\n    return true;\n  } catch (e) {\n    console.error('Chyba v generateRandomNumberGeneratorTask6:', e);\n    showNotification('Chyba při generování NGČ: ' + (e && e.message ? e.message : ''));\n    return false;\n  }\n}\n\n// New implementation for monetary random walk triggered from Task6\nasync function generateMonetaryRandomWalkTask6() {\n  try {\n    const dataRange = document.getElementById('data-range') && document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column') && document.getElementById('value-column').value;\n    if (!dataRange || !valueColumn) { showNotification('Nejdříve vyberte oblast dat a sloupec (úloha 4).'); return false; }\n\n    // determine exclude setting and significance\n    const excludeSel = document.getElementById('task6-exclude-over-significance');\n    const exclude = excludeSel && excludeSel.value === 'yes';\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) {}\n    if (exclude && (significance === null || Number.isNaN(significance))) {\n      showNotification('Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3).');\n      return false;\n    }\n\n    // determine sample size (prefer requestedSampleSize)\n    let sampleSize = requestedSampleSize || null;\n    if (!sampleSize) {\n      const display = document.getElementById('task5-size-display');\n      if (display && display.value) {\n        const parsed = parseNumberLoose(display.value);\n        if (parsed !== null) sampleSize = Math.ceil(parsed);\n      }\n    }\n    if (!sampleSize || sampleSize <= 0) { showNotification('Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5.'); return false; }\n\n    // read adjusted total sum from Task6 param display (or fallback to totalSumABS)\n    let totalSum = null;\n    try {\n      const p = document.getElementById('task6-param-sum-display');\n      if (p && p.value) {\n        const parsed = parseNumberLoose(p.value);\n        if (parsed !== null) totalSum = parsed;\n      }\n    } catch (e) {}\n    if (totalSum === null) totalSum = totalSumABS;\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['values','rowIndex','columnIndex','rowCount','columnCount']);\n      await context.sync();\n\n      const values = range.values;\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n      const rowCount = range.rowCount || (values ? values.length : 0);\n\n      if (!Array.isArray(values) || values.length <= 1 || relColIndex < 0 || relColIndex >= (values[0] ? values[0].length : 0)) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        return false;\n      }\n\n      // fallback compute totalSum if missing\n      if (totalSum === null || Number.isNaN(totalSum)) {\n        totalSum = getTotalAbsoluteSum(values, relColIndex);\n      }\n      if (!totalSum || Number.isNaN(totalSum) || totalSum <= 0) { showNotification('TotalSum je nula nebo neplatná.'); return false; }\n\n  const step = totalSum / sampleSize;\n  if (!isFinite(step) || step <= 0) { showNotification('Neplatný krok (krok <= 0).'); return false; }\n  const rng = getTask6Rng();\n  const start = (typeof rng === 'function' ? rng() : Math.random()) * step; // real random start in [0,step)\n\n      // prepare targets for NPP picks (sampleSize targets)\n      const targets = new Array(sampleSize);\n      for (let j = 0; j < sampleSize; j++) targets[j] = start + j * step;\n      let targetIndex = 0;\n\n      // prepare output array (rowCount rows x 5 cols)\n      const newCols = 5;\n      const out = new Array(rowCount);\n      // header row\n      out[0] = ['ABS', 'Kumulace ABS', 'Index/krok', 'Výběr', 'Důvod'];\n\n      // First pass: compute abs values and mark significance selections (exclude logic)\n      let significantCount = 0;\n      let nppCount = 0;\n      const absVals = new Array(rowCount);\n      const addVals = new Array(rowCount);\n      const selections = new Array(rowCount);\n      const reasons = new Array(rowCount);\n\n      for (let i = 0; i < rowCount; i++) {\n        selections[i] = 'Ne';\n        reasons[i] = '';\n      }\n\n      for (let i = 1; i < rowCount; i++) {\n        const raw = values[i][relColIndex];\n        const parsed = parseNumberLoose(raw);\n        const absVal = parsed === null ? 0 : Math.abs(parsed);\n        absVals[i] = absVal;\n        // default addVal is the abs value\n        let addVal = absVal;\n        // if exclude and exceeds significance, mark as significance and set addVal to 0\n        if (exclude && significance !== null && absVal > significance) {\n          addVal = 0;\n          selections[i] = 'Ano - významnost';\n          reasons[i] = 'přesah významnosti';\n          significantCount++;\n        }\n        addVals[i] = addVal;\n      }\n\n      // Second pass: compute cumulative and assign NPP based on integer-threshold crossings\n      let cumulative = 0;\n      for (let i = 1; i < rowCount; i++) {\n        const absVal = absVals[i] || 0;\n        const addVal = addVals[i] || 0;\n\n        const cumulativeBefore = (i === 1) ? start : cumulative;\n        const cumulativeAfter = cumulativeBefore + addVal;\n\n        const beforeIndex = Math.floor(cumulativeBefore / step);\n        const afterIndex = Math.floor(cumulativeAfter / step);\n        let hits = Math.max(0, afterIndex - beforeIndex);\n        if (hits > 0 && targetIndex + hits > targets.length) hits = Math.max(0, targets.length - targetIndex);\n        if (hits > 0) {\n          targetIndex += hits;\n          if (selections[i] === 'Ano - významnost') {\n            selections[i] = 'Ano - významnost; Ano - NPP';\n            reasons[i] = reasons[i] ? (reasons[i] + '; NPP') : 'NPP';\n          } else {\n            selections[i] = hits === 1 ? 'Ano - NPP' : `Ano - NPP (x${hits})`;\n            reasons[i] = 'NPP';\n          }\n          nppCount += hits;\n        }\n\n        cumulative = cumulativeAfter;\n        const idxVal = cumulative / step;\n        out[i] = [absVal, cumulative, idxVal, selections[i], reasons[i]];\n      }\n\n      // write out to worksheet to the right of range\n      const writeRowCount = rowCount;\n      const writeColIndex = range.columnIndex + range.columnCount;\n      const writeRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, writeRowCount, newCols);\n      writeRange.values = out;\n      // basic formatting: make header bold\n      const headerRange = worksheet.getRangeByIndexes(range.rowIndex, writeColIndex, 1, newCols);\n      headerRange.format.font.bold = true;\n\n      await context.sync();\n\n  // show minimal notification; results are written to the worksheet (no panel output)\n  const usedSeed = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value) || '';\n  showNotification('Generování dokončeno. Výsledky jsou vloženy do listu.' + (usedSeed ? ` Použit seed: ${usedSeed}` : ''));\n    });\n    return true;\n  } catch (e) {\n    console.error('Chyba v generateMonetaryRandomWalkTask6:', e);\n    showNotification('Chyba při generování mon. random walk: ' + (e && e.message ? e.message : ''));\n    return false;\n  }\n}\n\n// Compute adjusted sum for Task6 according to the exclude-over-significance setting\nasync function computeTask6AdjustedSum() {\n  try {\n    const dataRange = document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column').value;\n    const paramOut = document.getElementById('task6-param-sum-display');\n    const countArea = document.getElementById('task6-count-area');\n    const countOut = document.getElementById('task6-significant-count-display');\n\n    if (!dataRange || !valueColumn) {\n      showNotification('Prosím nejprve vyberte oblast dat a sloupec (úloha 4).');\n      if (paramOut) paramOut.value = '';\n      if (countArea) countArea.style.display = 'none';\n      return;\n    }\n\n    // determine whether to exclude over-significance\n    const sel = document.getElementById('task6-exclude-over-significance');\n    const exclude = sel && sel.value === 'yes';\n\n    // get significance value from storage\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && cfg.rawValue !== undefined && cfg.rawValue !== null) significance = Number(cfg.rawValue);\n      }\n    } catch (e) { /* ignore */ }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n\n      if (relColIndex < 0 || relColIndex >= range.columnCount) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        if (paramOut) paramOut.value = '';\n        if (countArea) countArea.style.display = 'none';\n        return;\n      }\n\n      let total = 0;\n      let significantCount = 0;\n      let batchNum = 0;\n      for await (const { values } of readRangeInBatches(context, worksheet, range)) {\n        batchNum++;\n        showNotification(`Zpracovává se dávka ${batchNum}...`);\n        for (let i = 1; i < values.length; i++) {\n          const raw = values[i][relColIndex];\n          const parsed = parseNumberLoose(raw);\n          if (parsed === null) continue;\n          const absVal = Math.abs(parsed);\n          if (exclude && significance !== null && !Number.isNaN(significance)) {\n            if (absVal <= significance) {\n              total += absVal;\n            } else {\n              significantCount += 1;\n            }\n          } else {\n            total += absVal;\n          }\n        }\n      }\n\n      // show results according to selection\n      if (!exclude) {\n        // show Task5 value reference\n        // prefer persisted totalSumABS if available\n        const displayVal = (totalSumABS !== null && totalSumABS !== undefined) ? totalSumABS : Math.ceil(total);\n        if (paramOut) paramOut.value = formatIntegerWithSpaces(Math.round(displayVal));\n        if (countArea) countArea.style.display = 'none';\n      } else {\n        if (paramOut) paramOut.value = formatIntegerWithSpaces(Math.ceil(total));\n        if (countArea) countArea.style.display = 'flex';\n        if (countOut) countOut.value = String(significantCount);\n      }\n\n      showNotification('Upravená suma spočítána.');\n    });\n\n  } catch (e) {\n    console.error('Chyba při výpočtu upravené sumy:', e);\n    showNotification('Chyba při výpočtu upravené sumy.');\n  }\n}\n\nfunction handleModalReset() {\n  try {\n    // Clear storage and reset config\n    localStorage.removeItem('reliabilityConfig');\n    delete reliabilityConfig.controlRisk;\n    delete reliabilityConfig.inherentRisk;\n    delete reliabilityConfig.analyticalTests;\n    delete reliabilityConfig.controlTests;\n    reliabilitySet = false;\n  // Also clear modal select elements so they display '<Vyberte>' next time\n  const controlEl = document.getElementById(\"reliability-control-risk\");\n  const inherentEl = document.getElementById(\"reliability-inherent-risk\");\n  const analyticalEl = document.getElementById(\"reliability-analytical-tests\");\n  const controlTestsEl = document.getElementById(\"reliability-control-tests\");\n  if (controlEl) controlEl.value = '';\n  if (inherentEl) inherentEl.value = '';\n  if (analyticalEl) analyticalEl.value = '';\n  if (controlTestsEl) controlTestsEl.value = '';\n    updateReliabilityDisplay();\n    const modal = document.getElementById('reliability-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Nastavení bylo resetováno.');\n  \n  } catch (e) {\n    console.error('Chyba při resetování:', e);\n    showNotification('Nepodařilo se resetovat nastavení.');\n  }\n}\n\n// Handler for modal save button\nfunction handleModalSave() {\n  try {\n    const modal = document.getElementById(\"reliability-modal\");\n    const controlRiskEl = document.getElementById(\"reliability-control-risk\");\n    const inherentRiskEl = document.getElementById(\"reliability-inherent-risk\");\n    const analyticalTestsEl = document.getElementById(\"reliability-analytical-tests\");\n    const controlTestsEl = document.getElementById(\"reliability-control-tests\");\n\n    // Allow partial updates: if user leaves a select empty, keep prior value\n    const controlRisk = controlRiskEl && controlRiskEl.value ? controlRiskEl.value : reliabilityConfig.controlRisk;\n    const inherentRisk = inherentRiskEl && inherentRiskEl.value ? inherentRiskEl.value : reliabilityConfig.inherentRisk;\n  const analyticalTests = analyticalTestsEl && analyticalTestsEl.value ? analyticalTestsEl.value : reliabilityConfig.analyticalTests;\n  const controlTests = controlTestsEl && controlTestsEl.value ? controlTestsEl.value : reliabilityConfig.controlTests;\n  const rmmLevel = document.getElementById('reliability-rmm-level') && document.getElementById('reliability-rmm-level').value ? document.getElementById('reliability-rmm-level').value : reliabilityConfig.rmmLevel;\n\n    // After fallback, require that all fields have some value\n  if (!controlRisk || !inherentRisk || !rmmLevel || !analyticalTests || !controlTests) {\n      showNotification(\"Po uložení musí být vyplněna všechna pole (nebo zvolena dříve). Vyplňte chybějící položky.\");\n      return;\n    }\n\n    // Store the selections into reliabilityConfig\n    reliabilityConfig.controlRisk = controlRisk;\n    reliabilityConfig.inherentRisk = inherentRisk;\n    reliabilityConfig.analyticalTests = analyticalTests;\n    reliabilityConfig.controlTests = controlTests;\n  reliabilityConfig.rmmLevel = rmmLevel;\n    reliabilitySet = true;\n    // persist\n    saveReliabilityToStorage();\n    updateReliabilityDisplay();\n    // update display with factor value only\n    const numeric = resolveFactorFromTable(reliabilityConfig);\n    const el = document.getElementById('reliability-factor');\n    if (el) {\n      if (numeric !== null) {\n        el.placeholder = '';\n        el.value = String(numeric);\n        applyFactorStyle(el, String(numeric));\n      } else {\n        el.value = '';\n        el.placeholder = '<Nevyplněno>';\n        applyFactorStyle(el, null);\n      }\n    }\n  \n    if (modal) modal.style.display = \"none\";\n  } catch (err) {\n    console.error(\"Chyba při ukládání nastavení spolehlivosti:\", err);\n    showNotification(\"Došlo k neočekávané chybě při ukládání.\");\n  }\n}\n\n// Persistence helpers\nfunction saveReliabilityToStorage() {\n  try {\n    const payload = {\n      controlRisk: reliabilityConfig.controlRisk,\n      inherentRisk: reliabilityConfig.inherentRisk,\n  analyticalTests: reliabilityConfig.analyticalTests,\n  controlTests: reliabilityConfig.controlTests,\n  rmmLevel: reliabilityConfig.rmmLevel\n    };\n    localStorage.setItem('reliabilityConfig', JSON.stringify(payload));\n  } catch (e) {\n    console.warn('Nelze uložit nastavení do localStorage:', e.message);\n  }\n}\n\nfunction loadReliabilityFromStorage() {\n  try {\n    const raw = localStorage.getItem('reliabilityConfig');\n    if (!raw) return;\n    const obj = JSON.parse(raw);\n    if (!obj) return;\n    reliabilityConfig.controlRisk = obj.controlRisk || reliabilityConfig.controlRisk;\n  reliabilityConfig.inherentRisk = obj.inherentRisk || reliabilityConfig.inherentRisk;\n  reliabilityConfig.rmmLevel = obj.rmmLevel || reliabilityConfig.rmmLevel;\n  reliabilityConfig.analyticalTests = obj.analyticalTests || reliabilityConfig.analyticalTests;\n  reliabilityConfig.controlTests = obj.controlTests || reliabilityConfig.controlTests;\n  reliabilitySet = true;\n    // after loading, resolve numeric factor from in-code table and show only factor\n    const numeric = resolveFactorFromTable(reliabilityConfig);\n    const el = document.getElementById('reliability-factor');\n    if (el) {\n      if (numeric !== null) {\n        el.placeholder = '';\n        el.value = String(numeric);\n        applyFactorStyle(el, String(numeric));\n      } else {\n        // show descriptive display if no factor available\n        updateReliabilityDisplay();\n      }\n    }\n  \n  } catch (e) {\n    console.warn('Nelze načíst nastavení z localStorage:', e.message);\n  }\n}\n\n// Resolve numeric factor from the in-code FS_Parametry table\nfunction resolveFactorFromTable(cfg) {\n  if (!cfg || !cfg.controlRisk) return null;\n  for (const r of fsParams) {\n    if (\n      r.controlRisk === cfg.controlRisk &&\n      r.inherentRisk === cfg.inherentRisk &&\n      r.rmmLevel === cfg.rmmLevel &&\n      r.analyticalTests === cfg.analyticalTests &&\n      r.controlTests === cfg.controlTests\n    ) {\n      return r.factor;\n    }\n  }\n  return null;\n}\n\n// Aktualizace zobrazení faktoru spolehlivosti\nfunction updateReliabilityDisplay() {\n  const el = document.getElementById(\"reliability-factor\");\n  if (!reliabilitySet) {\n    // Use placeholder so it appears with the same muted style as task 3's placeholder\n    el.value = \"\";\n    el.placeholder = \"<Nevyplněno>\";\n  // reset styling when not showing factor\n  el.style.color = '';\n  el.style.fontWeight = '';\n    return;\n  }\n\n  // Build display from the new selection fields if present\n  const control = reliabilityConfig.controlRisk || '-';\n  const inherent = reliabilityConfig.inherentRisk || '-';\n  const rmm = reliabilityConfig.rmmLevel || '-';\n  const analytical = reliabilityConfig.analyticalTests || '-';\n  const controls = reliabilityConfig.controlTests || '-';\n  const display = `Kontrolní riziko: ${control}, Přirozené riziko: ${inherent}, Hladina RMM: ${rmm}, Analytické testy: ${analytical}, Testy kontrol: ${controls}`;\n  el.placeholder = \"\";\n  el.value = display;\n  // reset styling when showing descriptive display\n  el.style.color = '';\n  el.style.fontWeight = '';\n}\n\n// Apply styling when factor is a specific error string\nfunction applyFactorStyle(el, factor) {\n  if (!el) return;\n  if (factor === 'Test kontrol Error') {\n    el.style.color = 'red';\n    el.style.fontWeight = '700';\n  } else {\n    el.style.color = '';\n    el.style.fontWeight = '';\n  }\n}\n\n// Funkce pro výběr datového rozsahu\nasync function selectDataRange() {\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"address\");\n      await context.sync();\n      \n      document.getElementById(\"data-range\").value = range.address;\n      console.log(`Vybrán rozsah: ${range.address}`);\n  \n    });\n  } catch (error) {\n    console.error(\"Chyba při výběru rozsahu:\", error);\n  showNotification(\"Chyba při výběru rozsahu. Ujistěte se, že máte vybraný rozsah v Excelu.\");\n  }\n}\n\n// Vybere sloupec z aktivní buňky a zapíše jeho označení do #value-column\nasync function selectValueColumn() {\n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load([\"columnIndex\"]);\n      await context.sync();\n\n      const colIdx = range.columnIndex; // 0-based\n      const colLetter = columnIndexToLetter(colIdx);\n      document.getElementById(\"value-column\").value = colLetter;\n  console.log(`Vybrán sloupec: ${colLetter}`);\n    });\n  } catch (error) {\n    console.error(\"Chyba při výběru sloupce:\", error);\n  showNotification(\"Chyba při výběru sloupce. Ujistěte se, že máte vybranou buňku v Excelu.\");\n  }\n}\n\n  \n\n// Převod 0-based indexu sloupce na písmenové označení (0 -> A)\nfunction columnIndexToLetter(index) {\n  let letter = '';\n  let temp = index + 1;\n  while (temp > 0) {\n    let rem = (temp - 1) % 26;\n    letter = String.fromCharCode(65 + rem) + letter;\n    temp = Math.floor((temp - 1) / 26);\n  }\n  return letter;\n}\n\n// Hlavní funkce pro generování vzorku - optimalizovaná verze\nasync function generateSample() {\n  try {\n    const method = document.getElementById(\"sampling-method\").value;\n    const dataRange = document.getElementById(\"data-range\").value;\n    const valueColumn = document.getElementById(\"value-column\").value;\n    \n    if (!dataRange || !valueColumn) {\n      showNotification(\"Prosím vyplňte všechna povinná pole.\");\n      return;\n    }\n    \n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // tolerate addresses like 'Sheet1!$A$1:$F$100' by removing sheet and $\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n      const range = worksheet.getRange(addr);\n      \n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n\n      if (relColIndex < 0 || relColIndex >= range.columnCount) {\n        showNotification(\"Zadaný sloupec není v rámci vybraného rozsahu dat.\");\n        return;\n      }\n\n      const totalRows = range.rowCount - 1; // Exclude header row\n      \n      // Memory safety checks\n      if (totalRows > MEMORY_CRITICAL_THRESHOLD) {\n        const confirmed = confirm(\n          `Varování: Dataset obsahuje ${totalRows.toLocaleString()} řádků. ` +\n          `To je velmi velký dataset, který může způsobit problémy s pamětí. ` +\n          `Doporučujeme rozdělit data na menší části. Pokračovat?`\n        );\n        if (!confirmed) {\n          showNotification(\"Operace zrušena uživatelem.\");\n          return;\n        }\n      } else if (totalRows > LARGE_DATASET_THRESHOLD) {\n        showNotification(\n          `Info: Dataset obsahuje ${totalRows.toLocaleString()} řádků. ` +\n          `Zpracování může trvat déle. Prosím čekejte...`\n        );\n      }\n      \n      showNotification(`Začíná zpracování ${totalRows.toLocaleString()} řádků...`);\n      \n      // Generování vzorku podle zvolené metody pomocí streaming algoritmu\n      let sample;\n      if (method === \"monetary-random-walk\") {\n        sample = await generateMonetaryRandomWalkStreaming(context, worksheet, range, relColIndex, totalRows);\n      } else {\n        sample = await generateRandomNumberSampleStreaming(context, worksheet, range, relColIndex, totalRows);\n      }\n      \n      // Zobrazení výsledků\n      displayResults(sample, totalRows + 1); // +1 for header\n      \n      // Zvýraznění vybraných řádků\n      await highlightSampleRows(context, worksheet, dataRange, sample);\n      \n      showNotification(`Vzorkování dokončeno! Vybráno ${sample.length} vzorků z ${totalRows.toLocaleString()} řádků.`);\n    });\n  } catch (error) {\n    console.error(\"Chyba při generování vzorku:\", error);\n    \n    // Better error messages for common issues\n    let errorMessage = \"Chyba při generování vzorku: \";\n    if (error.message && error.message.includes(\"memory\")) {\n      errorMessage += \"Nedostatek paměti. Zkuste rozdělit data na menší části.\";\n    } else if (error.message && error.message.includes(\"timeout\")) {\n      errorMessage += \"Operace trvala příliš dlouho. Zkuste menší dataset.\";\n    } else {\n      errorMessage += (error && error.message ? error.message : 'Neznámá chyba');\n    }\n    \n    showNotification(errorMessage, 8000); // Longer display for errors\n  }\n}\n\n// Převod označení sloupce na index\nfunction getColumnIndex(columnRef) {\n  if (!isNaN(columnRef)) {\n    return parseInt(columnRef) - 1;\n  }\n  \n  let result = 0;\n  for (let i = 0; i < columnRef.length; i++) {\n    result = result * 26 + (columnRef.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\n  }\n  return result - 1;\n}\n // Helper to write rows in batches (default batch size = BATCH_SIZE)\n async function writeRangeInBatches(context, worksheet, startRowIdx, startColIdx, rows, batchSize = BATCH_SIZE) {\n   for (let offset = 0; offset < rows.length; offset += batchSize) {\n     const batchRows = rows.slice(offset, offset + batchSize);\n     const batchRowCount = batchRows.length;\n     const writeRange = worksheet.getRangeByIndexes(startRowIdx + offset, startColIdx, batchRowCount, batchRows[0].length);\n     writeRange.values = batchRows;\n     await context.sync();\n   }\n }\n\n // Helper to read rows in batches with improved memory management\n async function* readRangeInBatches(context, worksheet, range, batchSize = BATCH_SIZE) {\n   const totalRows = range.rowCount;\n   const startRow = range.rowIndex;\n   const startCol = range.columnIndex;\n   const colCount = range.columnCount;\n   \n   // Memory warning for very large datasets\n   if (totalRows > 50000) {\n     showNotification(`Upozornění: Zpracovává se ${totalRows.toLocaleString()} řádků. Prosím čekejte...`);\n   }\n   \n   for (let offset = 0; offset < totalRows; offset += batchSize) {\n     const rows = Math.min(batchSize, totalRows - offset);\n     \n     try {\n       const subRange = worksheet.getRangeByIndexes(startRow + offset, startCol, rows, colCount);\n       subRange.load('values');\n       await context.sync();\n       \n       yield { values: subRange.values, startRow: startRow + offset };\n       \n       // Force garbage collection hint for large datasets\n       if (totalRows > 100000 && offset % (batchSize * 10) === 0) {\n         showNotification(`Zpracováno ${Math.round((offset / totalRows) * 100)}% - ${(offset + rows).toLocaleString()}/${totalRows.toLocaleString()} řádků...`);\n         // Give browser a chance to garbage collect\n         await new Promise(resolve => setTimeout(resolve, 10));\n       }\n     } catch (error) {\n       console.error(`Chyba při čtení dávky na pozici ${offset}:`, error);\n       throw new Error(`Chyba při čtení dat na řádku ${startRow + offset}: ${error.message}`);\n     }\n   }\n }\n\n\n// Optimalizovaná implementace náhodné peněžní procházky - streaming verze\nasync function generateMonetaryRandomWalkStreaming(context, worksheet, range, columnIndex, totalRows) {\n  // Nejdříve potřebujeme spočítat celkovou sumu pro výpočet intervalu\n  showNotification(\"Počítá se celková suma...\");\n  let totalValue = 0;\n  let batchNum = 0;\n  \n  for await (const { values } of readRangeInBatches(context, worksheet, range, BATCH_SIZE)) {\n    batchNum++;\n    showNotification(`Počítá se suma - dávka ${batchNum}...`);\n    const startIdx = batchNum === 1 ? 1 : 0; // Skip header in first batch\n    \n    for (let i = startIdx; i < values.length; i++) {\n      const raw = values[i][columnIndex];\n      const parsed = parseNumberLoose(raw);\n      const value = parsed !== null ? parsed : 0;\n      totalValue += Math.abs(value);\n    }\n  }\n\n  const sampleSize = calculateSampleSize(totalValue);\n  if (!sampleSize || sampleSize < 1) {\n    showNotification(\"Vypočtená velikost vzorku je neplatná.\");\n    return [];\n  }\n\n  const interval = totalValue / sampleSize;\n  const sample = [];\n  let currentSum = 0;\n  const rng = getTask6Rng();\n  let nextTarget = (typeof rng === 'function' ? rng() : Math.random()) * interval;\n  let globalRowIndex = 0; // Global row index (including header)\n  \n  showNotification(`Generuje se vzorek ${sampleSize} položek z celkové sumy ${totalValue.toLocaleString()}...`);\n  batchNum = 0;\n  \n  // Druhý průchod pro výběr vzorku\n  for await (const { values } of readRangeInBatches(context, worksheet, range, BATCH_SIZE)) {\n    batchNum++;\n    const startIdx = batchNum === 1 ? 1 : 0; // Skip header in first batch\n    \n    showNotification(`Zpracování vzorku - dávka ${batchNum}/${Math.ceil(totalRows / BATCH_SIZE)}...`);\n    \n    for (let i = startIdx; i < values.length; i++) {\n      globalRowIndex++;\n      const raw = values[i][columnIndex];\n      const parsed = parseNumberLoose(raw);\n      const value = parsed !== null ? Math.abs(parsed) : 0;\n      currentSum += value;\n      \n      if (currentSum >= nextTarget && sample.length < sampleSize) {\n        sample.push({\n          rowIndex: globalRowIndex,\n          rowData: values[i],\n          value: raw,\n          cumulativeValue: currentSum\n        });\n        nextTarget += interval;\n      }\n      \n      // Early exit if we have enough samples\n      if (sample.length >= sampleSize) {\n        showNotification(`Vzorkování dokončeno - nalezeno ${sample.length} vzorků.`);\n        return sample;\n      }\n    }\n  }\n  \n  return sample;\n}\n\n// Optimalizovaná implementace náhodného generátoru čísel - streaming verze\nasync function generateRandomNumberSampleStreaming(context, worksheet, range, columnIndex, totalRows) {\n  // Nejdříve potřebujeme spočítat celkovou sumu pro výpočet velikosti vzorku\n  showNotification(\"Počítá se celková suma...\");\n  let totalValue = 0;\n  let batchNum = 0;\n  \n  for await (const { values } of readRangeInBatches(context, worksheet, range, BATCH_SIZE)) {\n    batchNum++;\n    showNotification(`Počítá se suma - dávka ${batchNum}...`);\n    const startIdx = batchNum === 1 ? 1 : 0; // Skip header in first batch\n    \n    for (let i = startIdx; i < values.length; i++) {\n      const raw = values[i][columnIndex];\n      const parsed = parseNumberLoose(raw);\n      const value = parsed !== null ? parsed : 0;\n      totalValue += Math.abs(value);\n    }\n  }\n\n  const sampleSize = calculateSampleSize(totalValue);\n  if (!sampleSize || sampleSize < 1) {\n    showNotification(\"Vypočtená velikost vzorku je neplatná.\");\n    return [];\n  }\n\n  // Předem vybereme náhodné indexy řádků (0-based, bez hlavičky)\n  const selectedIndices = new Set();\n  const rng = getTask6Rng();\n  \n  while (selectedIndices.size < Math.min(sampleSize, totalRows)) {\n    const randomIndex = Math.floor((typeof rng === 'function' ? rng() : Math.random()) * totalRows);\n    selectedIndices.add(randomIndex);\n  }\n  \n  showNotification(`Generuje se vzorek ${selectedIndices.size} položek z ${totalRows.toLocaleString()} řádků...`);\n  \n  const sample = [];\n  let globalRowIndex = 0; // Global row index (0-based, excluding header)\n  batchNum = 0;\n  \n  // Průchod daty a výběr vzorku podle předem vybraných indexů\n  for await (const { values } of readRangeInBatches(context, worksheet, range, BATCH_SIZE)) {\n    batchNum++;\n    const startIdx = batchNum === 1 ? 1 : 0; // Skip header in first batch\n    \n    showNotification(`Zpracování vzorku - dávka ${batchNum}/${Math.ceil(totalRows / BATCH_SIZE)}...`);\n    \n    for (let i = startIdx; i < values.length; i++) {\n      if (selectedIndices.has(globalRowIndex)) {\n        sample.push({\n          rowIndex: globalRowIndex + 1, // +1 because we want 1-based indexing relative to header\n          rowData: values[i],\n          value: values[i][columnIndex]\n        });\n      }\n      globalRowIndex++;\n      \n      // Early exit if we have all samples\n      if (sample.length >= selectedIndices.size) {\n        showNotification(`Vzorkování dokončeno - nalezeno ${sample.length} vzorků.`);\n        return sample;\n      }\n    }\n  }\n  \n  return sample;\n}\n\n// Výpočet velikosti vzorku na základě faktoru spolehlivosti\n// Calculate sample size using TotalSum * factor / materiality when totalSum is provided.\n// If totalSum is not provided or materiality/factor missing, falls back to the previous statistical method.\nfunction calculateSampleSize(totalSum) {\n  // Try to read factor from the reliability display first\n  let factorNum = null;\n  try {\n    const factorEl = document.getElementById('reliability-factor');\n    if (factorEl && factorEl.value) {\n      const parsed = parseNumberLoose(factorEl.value);\n      if (parsed !== null) factorNum = parsed;\n    }\n  } catch (e) {}\n\n  // If not numeric, try to resolve from table mapping\n  if (factorNum === null || Number.isNaN(factorNum)) {\n    const resolved = resolveFactorFromTable(reliabilityConfig);\n    if (typeof resolved === 'number' && !Number.isNaN(resolved)) factorNum = resolved;\n  }\n\n  // Try to read materiality from stored significance config\n  let materiality = null;\n  try {\n    const raw = localStorage.getItem('significanceConfig');\n    if (raw) {\n      const cfg = JSON.parse(raw);\n      if (cfg && typeof cfg.rawValue === 'number') materiality = cfg.rawValue;\n      // if rawValue stored as string, try to parse\n      else if (cfg && cfg.rawValue) {\n        const m = parseNumberLoose(cfg.rawValue);\n        if (m !== null) materiality = m;\n      }\n    }\n  } catch (e) {}\n\n  // If totalSum provided and factor & materiality available, use the absolute-sum formula\n  if (typeof totalSum === 'number' && !Number.isNaN(totalSum) && factorNum && materiality && materiality > 0) {\n    const raw = (totalSum * factorNum) / materiality;\n    const n = Math.ceil(raw);\n    return Math.max(1, n);\n  }\n\n  // Fallback: previous simple statistical method using reliabilityConfig\n  try {\n    const { confidence, expectedError, populationSize } = reliabilityConfig;\n    const z = confidence === 95 ? 1.96 : confidence === 99 ? 2.58 : 1.645;\n    const p = 0.5;\n    const e = expectedError / 100;\n    let n = (z * z * p * (1 - p)) / (e * e);\n    if (populationSize > 0) {\n      n = n / (1 + (n - 1) / populationSize);\n    }\n    return Math.ceil(n);\n  } catch (e) {\n    return 1;\n  }\n}\n\n// Helper to compute absolute sum for a column from a 2D values array (skip header row)\nfunction getTotalAbsoluteSum(values, columnIndex) {\n  // Expect values to be a 2D array as returned by Excel range.values\n  // Sum absolute values starting from second row (skip header)\n  if (!Array.isArray(values) || values.length <= 1) return 0;\n  return values.slice(1).reduce((sum, row) => {\n    const raw = row && row.length > columnIndex ? row[columnIndex] : null;\n    const parsed = parseNumberLoose(raw);\n    if (parsed === null) return sum;\n    return sum + Math.abs(parsed);\n  }, 0);\n}\n\n// Robust number parser: accepts '1 234,56', '1234.56', '1,234.56' and returns Number or null\nfunction parseNumberLoose(input) {\n  if (input === null || input === undefined) return null;\n  let s = String(input).trim();\n  if (s === '') return null;\n  // remove non-breaking spaces and regular spaces\n  s = s.replace(/\\s+/g, '');\n  // If contains comma but no dot, assume comma is decimal separator\n  if (s.indexOf(',') !== -1 && s.indexOf('.') === -1) {\n    s = s.replace(',', '.');\n  } else {\n    // remove commas used as thousand separators\n    s = s.replace(/,/g, '');\n  }\n  // remove any other non-digit/.- characters\n  s = s.replace(/[^0-9.\\-]/g, '');\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\n// Persist last computed TotalSumABS\nfunction saveTotalSumAbsToStorage(val) {\n  try {\n    localStorage.setItem('TotalSumABS', JSON.stringify(val));\n  } catch (e) {\n    console.warn('Nelze uložit TotalSumABS:', e && e.message ? e.message : e);\n  }\n}\n\nfunction loadTotalSumAbsFromStorage() {\n  try {\n    const raw = localStorage.getItem('TotalSumABS');\n    if (!raw) return;\n    const v = JSON.parse(raw);\n    if (v !== null && v !== undefined) {\n      totalSumABS = v;\n      const outEl = document.getElementById('task5-result-display');\n      if (outEl) outEl.value = formatIntegerWithSpaces(Math.round(totalSumABS));\n    }\n  } catch (e) {\n    console.warn('Nelze načíst TotalSumABS:', e && e.message ? e.message : e);\n  }\n}\n\n// Persist/load Task6 exclude-over-significance choice\nfunction saveTask6ExcludeSetting(val) {\n  try {\n    localStorage.setItem('task6ExcludeOverSignificance', String(val));\n  } catch (e) {\n    console.warn('Nelze uložiť volbu Task6 do storage:', e && e.message ? e.message : e);\n  }\n}\n\nfunction saveTask6PrintTarget(val) {\n  try { localStorage.setItem('task6PrintTarget', String(val)); } catch (e) { console.warn('Nelze uložit tisk target:', e); }\n}\n\nfunction loadTask6PrintTarget() {\n  try {\n    const raw = localStorage.getItem('task6PrintTarget');\n    const sel = document.getElementById('task6-print-target');\n    if (!sel) return;\n    sel.value = raw || '';\n  } catch (e) { console.warn('Nelze načíst tisk target:', e); }\n}\n\n// Seed persistence for Task6\nfunction saveTask6Seed(val) {\n  try { localStorage.setItem('task6Seed', String(val)); task6Seed = val; } catch (e) { console.warn('Nelze uložit seed:', e); }\n}\n\nfunction loadTask6Seed() {\n  try {\n    const raw = localStorage.getItem('task6Seed');\n    const el = document.getElementById('task6-seed');\n    if (raw && el) { el.value = raw; task6Seed = raw; }\n  } catch (e) { console.warn('Nelze načíst seed:', e); }\n}\n\n// Small deterministic PRNG helpers: xfnv1a hash -> mulberry32\nfunction xfnv1aHash(str) {\n  let h = 2166136261 >>> 0;\n  for (let i = 0; i < str.length; i++) {\n    h ^= str.charCodeAt(i);\n    h = Math.imul(h, 16777619) >>> 0;\n  }\n  h += h << 13; h ^= h >>> 7; h += h << 3; h ^= h >>> 17; h += h << 5;\n  return h >>> 0;\n}\n\nfunction mulberry32(a) {\n  return function() {\n    a |= 0;\n    a = (a + 0x6D2B79F5) | 0;\n    let t = Math.imul(a ^ (a >>> 15), 1 | a);\n    t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t;\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  };\n}\n\n// Return RNG function or null to indicate fallback to Math.random\nfunction getTask6Rng() {\n  try {\n    const seedVal = task6Seed || (document.getElementById('task6-seed') && document.getElementById('task6-seed').value);\n    if (!seedVal && seedVal !== 0) return null;\n    const s = String(seedVal);\n    const h = xfnv1aHash(s);\n    return mulberry32(h);\n  } catch (e) { return null; }\n}\n\n// Create a short random seed string (timestamp + random suffix)\nfunction makeRandomSeed() {\n  const t = Date.now().toString(36);\n  const r = Math.floor(Math.random() * 1e6).toString(36);\n  return `${t}-${r}`;\n}\n\nfunction loadTask6ExcludeSetting() {\n  try {\n    const raw = localStorage.getItem('task6ExcludeOverSignificance');\n    const sel = document.getElementById('task6-exclude-over-significance');\n    if (!sel) return;\n    if (!raw) { sel.value = ''; return; }\n    sel.value = raw;\n  } catch (e) {\n    console.warn('Nelze načíst volbu Task6 z storage:', e && e.message ? e.message : e);\n  }\n}\n\n  \n\n  \n\n// Zobrazení výsledků\nfunction displayResults(sample, totalRows) {\n  const resultsDiv = document.getElementById(\"results\");\n  const sampleInfo = document.getElementById(\"sample-info\");\n  const sampleList = document.getElementById(\"sample-list\");\n  \n  sampleInfo.innerHTML = `\n    <strong>Celkem řádků:</strong> ${totalRows}<br>\n    <strong>Velikost vzorku:</strong> ${sample.length}<br>\n    <strong>Procento vzorku:</strong> ${((sample.length / totalRows) * 100).toFixed(2)}%\n  `;\n  \n  let listHtml = \"<strong>Vybrané řádky:</strong><br>\";\n  sample.forEach((item, index) => {\n    listHtml += `${index + 1}. Řádek ${item.rowIndex + 1}, Hodnota: ${item.value}<br>`;\n  });\n  \n  sampleList.innerHTML = listHtml;\n  resultsDiv.style.display = \"block\";\n}\n\n// Zvýraznění vybraných řádků v Excelu\nasync function highlightSampleRows(context, worksheet, dataRange, sample) {\n  try {\n    // Nejdříve vyčistíme předchozí zvýraznění\n    const fullRange = worksheet.getRange(dataRange);\n    fullRange.format.fill.clear();\n    \n    // Zvýrazníme vybrané řádky\n    for (const item of sample) {\n      const rowAddress = dataRange.split(':')[0].replace(/\\d+/, (item.rowIndex + 1).toString()) + \n                        ':' + \n                        dataRange.split(':')[1].replace(/\\d+/, (item.rowIndex + 1).toString());\n      \n      const rowRange = worksheet.getRange(rowAddress);\n      rowRange.format.fill.color = \"yellow\";\n    }\n    \n    await context.sync();\n  } catch (error) {\n    console.log(\"Varování: Nepodařilo se zvýraznit řádky:\", error.message);\n  }\n}\n\n// Zachování původní run funkce pro kompatibilitu\nexport async function run() {\n  await generateSample();\n}\n\n// Simple notification helper (replaces unsupported alert())\nfunction showNotification(message, timeout = 4000) {\n  try {\n    const el = document.getElementById('notification');\n    if (!el) return;\n    el.textContent = message;\n    el.style.display = 'block';\n    setTimeout(() => { el.style.display = 'none'; }, timeout);\n  } catch (e) {\n    // last resort: log to console\n    console.log('Notifikace:', message);\n  }\n}\n\n// -------------------- Significance (Hladina Významnosti) --------------------\n// significanceConfig structure: { type: string, rawValue: number|null, justification: string }\nfunction openSignificanceDialog() {\n  const modal = document.getElementById('significance-modal');\n  const typeEl = document.getElementById('significance-type');\n  const valueEl = document.getElementById('significance-value');\n  const justEl = document.getElementById('significance-justification');\n  if (!modal || !typeEl || !valueEl || !justEl) {\n    showNotification('Dialog hladiny významnosti není dostupný.');\n    return;\n  }\n  // load stored config\n  const raw = localStorage.getItem('significanceConfig');\n  let cfg = null;\n  try { cfg = raw ? JSON.parse(raw) : null; } catch (e) { cfg = null; }\n  if (cfg) {\n    typeEl.value = cfg.type || '';\n    // rawValue saved as number -> show unformatted in edit field\n    valueEl.value = (cfg.rawValue !== undefined && cfg.rawValue !== null) ? String(cfg.rawValue) : '';\n    justEl.value = cfg.justification || '';\n  } else {\n    typeEl.value = '';\n    valueEl.value = '';\n    justEl.value = '';\n  }\n  // Apply rule: if Prováděcí then justification readonly and set to 'NEVYPLŇOVAT'\n  if (typeEl.value === 'Prováděcí') {\n    justEl.value = 'NEVYPLŇOVAT';\n    justEl.readOnly = true;\n  } else {\n    justEl.readOnly = false;\n    if (justEl.value === 'NEVYPLŇOVAT') justEl.value = '';\n  }\n\n  // Wire dynamic behavior inside modal: when type changes adjust justification field\n  typeEl.onchange = () => {\n    if (typeEl.value === 'Prováděcí') {\n      justEl.value = 'NEVYPLŇOVAT';\n      justEl.readOnly = true;\n    } else {\n      if (justEl.value === 'NEVYPLŇOVAT') justEl.value = '';\n      justEl.readOnly = false;\n    }\n  };\n\n  // Live formatting for the numeric input (group thousands while typing)\n  const liveFormatFn = (ev) => {\n    formatIntegerInputWithCursor(valueEl, ev);\n  };\n  valueEl.removeEventListener('input', liveFormatFn);\n  valueEl.addEventListener('input', liveFormatFn);\n\n  modal.style.display = 'flex';\n}\n\nfunction handleSignificanceSave() {\n  try {\n    const typeEl = document.getElementById('significance-type');\n    const valueEl = document.getElementById('significance-value');\n    const justEl = document.getElementById('significance-justification');\n    if (!typeEl || !valueEl || !justEl) return;\n\n    const type = typeEl.value || '';\n    let rawInput = valueEl.value ? valueEl.value.trim() : '';\n    let justification = justEl.value ? justEl.value.trim() : '';\n\n    // Basic validation: type required\n    if (!type) {\n      showNotification('Prosím vyberte typ významnosti.');\n      return;\n    }\n\n    // If type is not Prováděcí, justification is required\n    if (type !== 'Prováděcí' && !justification) {\n      showNotification('Pokud není zvoleno \"Prováděcí\", je potřeba zadat zdůvodnění.');\n      return;\n    }\n\n    // Normalize numeric value: remove percent, non-digit etc., then parse integer and take absolute\n    let rawNumber = null;\n    if (rawInput) {\n      rawInput = rawInput.replace(/%/g, '');\n      const digits = rawInput.replace(/[^0-9\\-]/g, '');\n      if (digits !== '' && digits !== '-' && digits !== '+') {\n        rawNumber = parseInt(digits, 10);\n        if (Number.isNaN(rawNumber)) rawNumber = null;\n        else rawNumber = Math.abs(rawNumber);\n      }\n    }\n\n    // Require value to be present (as integer)\n    if (rawNumber === null) {\n      showNotification('Prosím zadejte hodnotu hladiny významnosti jako celé číslo.');\n      return;\n    }\n\n    if (type === 'Prováděcí') justification = 'NEVYPLŇOVAT';\n\n    const cfg = { type, rawValue: rawNumber, justification };\n    localStorage.setItem('significanceConfig', JSON.stringify(cfg));\n\n    // Update main panel displays\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (typeDisplay) typeDisplay.value = type;\n    if (valueDisplay) valueDisplay.value = formatIntegerWithSpaces(rawNumber);\n    if (justDisplay) justDisplay.value = justification;\n\n  \n\n    const modal = document.getElementById('significance-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Hladina významnosti uložena.');\n  } catch (e) {\n    console.error('Chyba při ukládání hladiny významnosti:', e);\n    showNotification('Nelze uložit hladinu významnosti.');\n  }\n}\n\nfunction handleSignificanceReset() {\n  try {\n    localStorage.removeItem('significanceConfig');\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (typeDisplay) { typeDisplay.value = ''; typeDisplay.placeholder = 'Typ významnosti'; }\n    if (valueDisplay) { valueDisplay.value = ''; valueDisplay.placeholder = 'Hodnota (bez deset.)'; }\n    if (justDisplay) { justDisplay.value = ''; justDisplay.placeholder = 'Zdůvodnění / stav'; }\n  \n    const modal = document.getElementById('significance-modal');\n    if (modal) modal.style.display = 'none';\n    showNotification('Hladina významnosti byla resetována.');\n  } catch (e) {\n    console.error('Chyba při resetování hladiny významnosti:', e);\n    showNotification('Nelze resetovat hladinu významnosti.');\n  }\n}\n\nfunction loadSignificanceFromStorage() {\n  try {\n    const raw = localStorage.getItem('significanceConfig');\n    let cfg = null;\n    try { cfg = raw ? JSON.parse(raw) : null; } catch (e) { cfg = null; }\n    const typeDisplay = document.getElementById('significance-type-display');\n    const valueDisplay = document.getElementById('significance-value-display');\n    const justDisplay = document.getElementById('significance-justification-display');\n    if (cfg) {\n      if (typeDisplay) typeDisplay.value = cfg.type || '';\n      if (valueDisplay) valueDisplay.value = (cfg.rawValue !== undefined && cfg.rawValue !== null) ? formatIntegerWithSpaces(cfg.rawValue) : '';\n      if (justDisplay) justDisplay.value = cfg.justification || '';\n    } else {\n      if (typeDisplay) { typeDisplay.value = ''; typeDisplay.placeholder = 'Typ významnosti'; }\n      if (valueDisplay) { valueDisplay.value = ''; valueDisplay.placeholder = 'Hodnota (bez deset.)'; }\n      if (justDisplay) { justDisplay.value = ''; justDisplay.placeholder = 'Zdůvodnění / stav'; }\n    }\n  } catch (e) {\n    console.warn('Nelze načíst hladinu významnosti ze storage:', e.message);\n  }\n}\n\nfunction formatIntegerWithSpaces(n) {\n  if (n === null || n === undefined) return '';\n  const s = String(Math.round(n));\n  return s.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n\n// Format input element's value as integer with spaces while trying to preserve caret position\nfunction formatIntegerInputWithCursor(inputEl, ev) {\n  if (!inputEl) return;\n  const old = inputEl.value;\n  const selStart = inputEl.selectionStart;\n  // extract digits and sign\n  let cleaned = old.replace(/%/g, '').replace(/[^0-9\\-]/g, '');\n  if (cleaned === '' || cleaned === '-' || cleaned === '+') {\n    inputEl.value = cleaned;\n    return;\n  }\n  const asNum = Math.abs(parseInt(cleaned, 10));\n  if (Number.isNaN(asNum)) {\n    inputEl.value = '';\n    return;\n  }\n  const formatted = String(asNum).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n\n  // compute new caret position: estimate number of non-digit chars before original caret\n  let digitsBefore = 0;\n  for (let i = 0; i < selStart; i++) if (/[0-9]/.test(old[i])) digitsBefore++;\n  // map digitsBefore into formatted position\n  let newPos = 0;\n  let digitsSeen = 0;\n  while (newPos < formatted.length && digitsSeen < digitsBefore) {\n    if (/[0-9]/.test(formatted[newPos])) digitsSeen++;\n    newPos++;\n  }\n\n  inputEl.value = formatted;\n  // set caret\n  try { inputEl.setSelectionRange(newPos, newPos); } catch (e) {}\n}\n\n// Task 5: compute sum of absolute values for chosen column within chosen range\nasync function computeTask5Sum() {\n  // declare outEl in outer scope so the catch block can clear it on error\n  let outEl = null;\n  try {\n    const dataRange = document.getElementById('data-range').value;\n    const valueColumn = document.getElementById('value-column').value;\n    outEl = document.getElementById('task5-result-display');\n\n    if (!dataRange || !valueColumn) {\n      showNotification('Prosím nejprve vyberte oblast dat a sloupec (úloha 4).');\n      if (outEl) outEl.value = '';\n      return;\n    }\n\n    await Excel.run(async (context) => {\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      // sanitize address (remove sheet name and $)\n      let addr = dataRange;\n      if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n      addr = addr.replace(/\\$/g, '').trim();\n\n      const range = worksheet.getRange(addr);\n      range.load(['rowIndex', 'columnIndex', 'rowCount', 'columnCount']);\n      await context.sync();\n\n      const absColIndex = getColumnIndex(String(valueColumn).toUpperCase());\n      const rangeStartCol = typeof range.columnIndex === 'number' ? range.columnIndex : 0;\n      const relColIndex = absColIndex - rangeStartCol;\n\n      if (relColIndex < 0 || relColIndex >= range.columnCount) {\n        showNotification('Zadaný sloupec není v rámci vybraného rozsahu dat.');\n        if (outEl) outEl.value = '';\n        return;\n      }\n\n      let total = 0;\n      let batchNum = 0;\n      for await (const { values } of readRangeInBatches(context, worksheet, range)) {\n        batchNum++;\n        showNotification(`Zpracovává se dávka ${batchNum}...`);\n        total += getTotalAbsoluteSum(values, relColIndex);\n      }\n\n      // store and display as integer rounded up to units\n      const totalCeil = Math.ceil(total);\n      if (outEl) outEl.value = formatIntegerWithSpaces(totalCeil);\n      // persist value (integer)\n      totalSumABS = totalCeil;\n      try { saveTotalSumAbsToStorage(totalSumABS); } catch (e) {}\n      showNotification('Suma byla spočítána.');\n    });\n  } catch (e) {\n  console.error('Chyba při výpočtu Task5 sumy:', e && e.stack ? e.stack : e);\n  const msg = (e && e.message) ? e.message : String(e);\n  if (outEl) outEl.value = '';\n  showNotification('Chyba při výpočtu sumy: ' + msg);\n  }\n}\n\n// Compute sample size using persisted TotalSumABS, reliability factor and significance\nfunction computeTask5Size() {\n  try {\n    const outEl = document.getElementById('task5-size-display');\n\n    // Read factor from the display (task 2) or resolve from table\n    let factorNum = null;\n    const factorEl = document.getElementById('reliability-factor');\n    if (factorEl && factorEl.value) {\n      const p = parseNumberLoose(factorEl.value);\n      if (p !== null) factorNum = p;\n    }\n    if (factorNum === null || Number.isNaN(factorNum)) {\n      const resolved = resolveFactorFromTable(reliabilityConfig);\n      if (typeof resolved === 'number' && !Number.isNaN(resolved)) factorNum = resolved;\n    }\n\n    // Read significance\n    let significance = null;\n    try {\n      const raw = localStorage.getItem('significanceConfig');\n      if (raw) {\n        const cfg = JSON.parse(raw);\n        if (cfg && typeof cfg.rawValue === 'number') significance = cfg.rawValue;\n        else if (cfg && cfg.rawValue) {\n          const m = parseNumberLoose(cfg.rawValue);\n          if (m !== null) significance = m;\n        }\n      }\n    } catch (e) {}\n\n    // Read TotalSumABS from memory/storage or UI\n    let total = totalSumABS;\n    if ((total === null || total === undefined) && document.getElementById('task5-result-display')) {\n      const txt = document.getElementById('task5-result-display').value;\n      const parsed = parseNumberLoose(txt);\n      if (parsed !== null) total = parsed;\n    }\n\n    if (factorNum === null || significance === null || total === null || significance === 0) {\n      if (outEl) outEl.value = '';\n      showNotification('Pro výpočet velikosti vzorku musí být nastaven faktor, významnost a spočítaná suma.');\n      return;\n    }\n\n    const raw = (factorNum * total) / significance;\n    const n = Math.ceil(raw);\n    if (outEl) outEl.value = String(n);\n    showNotification('Velikost vzorku byla spočítána.');\n  } catch (e) {\n    console.error('Chyba při výpočtu velikosti vzorku:', e && e.stack ? e.stack : e);\n    const msg = (e && e.message) ? e.message : String(e);\n    const outEl = document.getElementById('task5-size-display');\n    if (outEl) outEl.value = '';\n    showNotification('Chyba při výpočtu velikosti vzorku: ' + msg);\n  }\n}\n\n// Show/hide override inputs when user chooses whether to use calculated size\nfunction handleTask5UseChoice(ev) {\n  try {\n    const sel = document.getElementById('task5-use-calculated');\n    const area = document.getElementById('task5-override-area');\n    const overrideSize = document.getElementById('task5-override-size');\n    const overrideReason = document.getElementById('task5-override-reason');\n    if (!sel || !area) return;\n    if (sel.value === 'no') {\n      area.style.display = 'flex';\n      area.style.flexDirection = 'column';\n    } else {\n      // hide and clear\n      area.style.display = 'none';\n      if (overrideSize) overrideSize.value = '';\n      if (overrideReason) overrideReason.value = '';\n    }\n  } catch (e) {\n    console.error('Error handling Task5 use choice:', e);\n  }\n}\n\nfunction confirmRequestedSize() {\n  try {\n    const useSel = document.getElementById('task5-use-calculated');\n    const overrideSizeEl = document.getElementById('task5-override-size');\n    const overrideReasonEl = document.getElementById('task5-override-reason');\n    const infoEl = document.getElementById('task5-confirm-info');\n\n    if (!useSel) {\n      showNotification('Vyberte prosím, zda chcete použít vypočtenou velikost.');\n      return;\n    }\n\n    if (useSel.value === 'yes') {\n      // Use the value currently displayed in the size field (task5-size-display)\n      const sizeEl = document.getElementById('task5-size-display');\n      if (!sizeEl || !sizeEl.value) {\n        showNotification('Neexistuje vypočtená hodnota. Nejprve spočítejte velikost.');\n        return;\n      }\n      const parsed = parseNumberLoose(sizeEl.value);\n      if (parsed === null) {\n        showNotification('Nelze načíst vypočtenou velikost z pole.');\n        return;\n      }\n      const requested = Math.ceil(parsed);\n      requestedSampleSize = requested;\n      requestedSampleReason = 'Použito vypočtené n';\n  if (infoEl) infoEl.textContent = '';\n  // populate Task 6 final displays\n  const task6Size = document.getElementById('task6-final-size-display');\n  if (task6Size) task6Size.value = String(requestedSampleSize);\n  const task6Method = document.getElementById('task6-method-display');\n  const samplingMethodEl = document.getElementById('sampling-method');\n  if (task6Method && samplingMethodEl) task6Method.value = samplingMethodEl.options[samplingMethodEl.selectedIndex].text;\n  // (override flag/reason are shown in Task 5 only)\n      showNotification('Velikost vzorku potvrzena (použito vypočtené).');\n      // reflect in UI (ensure integer display)\n      if (sizeEl) sizeEl.value = String(requestedSampleSize);\n      return;\n    }\n\n    if (useSel.value === 'no') {\n      // Use override value\n      if (!overrideSizeEl || !overrideSizeEl.value) {\n        showNotification('Zadejte prosím požadovanou velikost.');\n        return;\n      }\n      const parsed = parseNumberLoose(overrideSizeEl.value);\n      if (parsed === null || parsed <= 0) {\n        showNotification('Žádaná velikost musí být kladné číslo.');\n        return;\n      }\n      const requested = Math.ceil(parsed);\n      requestedSampleSize = requested;\n      requestedSampleReason = overrideReasonEl ? (overrideReasonEl.value || '') : '';\n  if (infoEl) infoEl.textContent = '';\n\n  // START OF MODIFIED LOGIC\n  // Only update Task 6's \"Wanted sample size\" display\n  const task6Size = document.getElementById('task6-final-size-display');\n  if (task6Size) task6Size.value = String(requestedSampleSize);\n  \n  // DO NOT update the main size display in Task 5\n  showNotification('Žádaná velikost byla potvrzena a aplikována pouze do Úkolu 6.');\n  return;\n    }\n\n    showNotification('Vyberte prosím možnost Ano nebo Ne.');\n  } catch (e) {\n    console.error('Chyba při potvrzení požadované velikosti:', e);\n    showNotification('Chyba při potvrzení velikosti.');\n  }\n}\n\n// Helper to safely get value from an element\nfunction _get_value(id) {\n  const el = document.getElementById(id);\n  if (el) {\n    if (el.tagName === 'SELECT') {\n      try { return el.options[el.selectedIndex].text; } catch (e) { return ''; }\n    }\n    return el.value || '';\n  }\n  return '';\n}\n\nfunction _get_selected_value(id) {\n  const el = document.getElementById(id);\n  return el ? el.value : '';\n}\n\n// Formats parameters into a 2D array for writing to the worksheet\nfunction _format_params(params) {\n  const out = [];\n  out.push(['Parametry vzorkovače', '']);\n  for (const key in params) {\n    if (Object.hasOwnProperty.call(params, key)) {\n      const value = params[key];\n      out.push([key, value === null || value === undefined ? '' : value]);\n    }\n  }\n  return out;\n}\n\n// Prints parameters to the specified location\nasync function printParameters(params, target) {\n  try {\n    await Excel.run(async (context) => {\n      const formatted = _format_params(params);\n      if (target === 'new-sheet') {\n        const newSheet = context.workbook.worksheets.add(\"ParametryVzorku\");\n        newSheet.activate();\n        const range = newSheet.getRange('A1');\n        range.worksheet.getRangeByIndexes(0, 0, formatted.length, 2).values = formatted;\n      } else if (target === 'above') {\n        const dataRange = document.getElementById('data-range').value;\n        if (!dataRange) {\n          showNotification('Oblast dat není vybrána. Parametry budou vloženy na nový list.');\n          const newSheet = context.workbook.worksheets.add();\n          newSheet.activate();\n          const range = newSheet.getRange('A1');\n          range.worksheet.getRangeByIndexes(0, 0, formatted.length, 2).values = formatted;\n          return;\n        }\n        let addr = dataRange;\n        if (addr.indexOf('!') !== -1) addr = addr.split('!').pop();\n        addr = addr.replace(/\\$/g, '').trim();\n        const range = context.workbook.worksheets.getActiveWorksheet().getRange(addr);\n        range.load(['rowIndex']);\n        await context.sync();\n        const startRow = range.rowIndex;\n        const sheet = context.workbook.worksheets.getActiveWorksheet();\n        const usedRange = sheet.getUsedRange();\n        usedRange.load('columnCount');\n        await context.sync();\n        const columnCount = usedRange.columnCount;\n        sheet.getRangeByIndexes(startRow, 0, formatted.length, columnCount).insert(Excel.InsertShiftDirection.down);\n        sheet.getRangeByIndexes(startRow, 0, formatted.length, 2).values = formatted;\n      }\n      await context.sync();\n    });\n  } catch (e) {\n    console.error('Chyba při tisku parametrů:', e);\n    showNotification('Chyba při tisku parametrů.');\n  }\n}\n\n// Gathers all sampler parameters from UI and storage\nfunction gatherSamplerParameters() {\n  const params = {};\n  // Task 2\n  params['Kontrolní riziko'] = reliabilityConfig.controlRisk || '';\n  params['Přirozené riziko'] = reliabilityConfig.inherentRisk || '';\n  params['Hladina RMM'] = reliabilityConfig.rmmLevel || '';\n  params['Provádím analytické testy?'] = reliabilityConfig.analyticalTests || '';\n  params['Provádím testy kontrol?'] = reliabilityConfig.controlTests || '';\n  params['Faktor spolehlivosti (výsledný)'] = _get_value('reliability-factor');\n  // Task 3\n  params['Typ významnosti'] = _get_value('significance-type-display');\n  params['Hodnota významnosti'] = _get_value('significance-value-display');\n  params['Zdůvodnění významnosti'] = _get_value('significance-justification-display');\n  // Task 4\n  params['Oblast dat'] = _get_value('data-range');\n  params['Sloupec pro výběr'] = _get_value('value-column');\n  // Task 5\n  params['Celková suma absolutních hodnot'] = _get_value('task5-result-display');\n  params['Vypočtená velikost vzorku'] = _get_value('task5-size-display');\n  const useCalculated = _get_value('task5-use-calculated');\n  params['Použít vypočtenou velikost'] = useCalculated;\n  if (useCalculated === 'Ne') {\n    params['Uživatelská velikost vzorku'] = _get_value('task5-override-size');\n    params['Důvod uživatelské velikosti'] = _get_value('task5-override-reason');\n  }\n  // Task 6\n  params['Metoda výběru vzorku'] = _get_value('task6-method-display');\n  params['Finální velikost vzorku'] = _get_value('task6-final-size-display');\n  params['Vyloučit nadlimitní položky'] = _get_value('task6-exclude-over-significance');\n  params['Suma pro výpočet (po úpravě)'] = _get_value('task6-param-sum-display');\n  params['Počet položek nad významností'] = _get_value('task6-significant-count-display');\n  params['Seed pro generátor'] = _get_value('task6-seed');\n  // Add new parameters\n  params['Autor vzorku'] = \"Neznámý uživatel\";\n  params['Datum a čas vyhotovení'] = new Date().toLocaleString();\n\n  return params;\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/Head.png\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Auditní vzorkovač</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div style=\\\"text-align:center;margin-bottom:12px\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Auditní vzorkovač\\\" title=\\\"Auditní vzorkovač\\\" style=\\\"width:240px;height:160px;object-fit:cover;display:inline-block\\\"/> </div> <div style=\\\"display:flex;justify-content:center;margin-bottom:12px\\\"> <button id=\\\"reset-sampler\\\" class=\\\"ms-Button ms-Button--hero\\\"> <span class=\\\"ms-Button-label\\\">Restartovat vzorkovač</span> </button> </div> <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">1. Metoda výběru vzorku</div> <label class=\\\"ms-Label\\\">Vyberte metodu výběru vzorku:</label> <select id=\\\"sampling-method\\\" class=\\\"ms-Dropdown\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"monetary-random-walk\\\">Náhodná peněžní procházka</option> <option value=\\\"random-number-generator\\\">Náhodný generátor čísel</option> </select> </div> </div> </div> <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">2. Faktor spolehlivosti</div> <label class=\\\"ms-Label\\\">Rozklikněte políčko \\\"Nastavit\\\" a definujte velikost faktoru spolehlivosti</label> <div style=\\\"display:flex;align-items:center\\\"> <button id=\\\"set-reliability\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Nastavit</span> </button> <input type=\\\"text\\\" id=\\\"reliability-factor\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Klikněte pro nastavení\\\" style=\\\"flex:1\\\"> </div> </div> </div> </div> <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">3. Hladina Významnosti</div> <label class=\\\"ms-Label\\\">Rozklikněte políčko \\\"Nastavit\\\" a vyplňte okénka (3 části).</label> <div style=\\\"display:flex;gap:8px;margin-top:8px;flex-direction:column\\\"> <button id=\\\"fill-significance\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"align-self:flex-start\\\"> <span class=\\\"ms-Button-label\\\">Nastavit</span> </button> <div style=\\\"display:flex;flex-direction:column;gap:8px;width:100%\\\"> <input type=\\\"text\\\" id=\\\"significance-type-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Typ významnosti\\\"> <input type=\\\"text\\\" id=\\\"significance-value-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Hodnota (bez deset.)\\\"> <input type=\\\"text\\\" id=\\\"significance-justification-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Zdůvodnění / stav\\\"> </div> </div> </div> </div> </div>   <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">4. Oblast dat pro výběr vzorku</div> <label class=\\\"ms-Label\\\">Označte plochu dat, z které se bude tvořit vzorek:</label> <div style=\\\"display:flex;align-items:center\\\"> <button id=\\\"select-range\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Vybrat</span> </button> <input type=\\\"text\\\" id=\\\"data-range\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"klikněte na 'Vybrat'\\\" style=\\\"flex:1\\\"> </div> <div style=\\\"height:8px\\\"></div> <label class=\\\"ms-Label\\\">Označte sloupec obsahující hodnoty a klikněte na \\\"Sloupec\\\":</label> <div style=\\\"display:flex;align-items:center;margin-top:6px\\\"> <button id=\\\"select-column\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Sloupec</span> </button> <input type=\\\"text\\\" id=\\\"value-column\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"klikněte na 'Sloupec'\\\" style=\\\"flex:1\\\"> </div> <div style=\\\"height:8px\\\"></div> </div> </div> </div> <div id=\\\"results\\\" class=\\\"ms-Grid\\\" style=\\\"margin-top:20px;display:none\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <h3 class=\\\"ms-font-l\\\">Výsledky vzorkování:</h3> <div id=\\\"sample-info\\\" class=\\\"ms-font-m\\\"></div> <div id=\\\"sample-list\\\" style=\\\"margin-top:10px\\\"></div> </div> </div> </div> <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">5. Stanovení velikosti vzorku</div> <label class=\\\"ms-Label\\\">Stiskněte tlačítko pro spočítání součtu absolutních hodnot datového pole z úlohy 4.</label> <div style=\\\"display:flex;gap:8px;margin-top:8px;align-items:center\\\"> <button id=\\\"task5-compute-sum\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Spočítat sumu</span> </button> <input type=\\\"text\\\" id=\\\"task5-result-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Výsledek (součet absolutních hodnot)\\\" style=\\\"flex:1\\\"> </div> <div style=\\\"height:8px\\\"></div> <label class=\\\"ms-Label\\\">Stiskněte tlačítko pro vypočítání velikosti vzorku:</label> <div style=\\\"display:flex;gap:8px;margin-top:8px;align-items:center\\\"> <button id=\\\"task5-calc-size\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Velikost vzorku</span> </button> <input type=\\\"text\\\" id=\\\"task5-size-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Velikost vzorku (n)\\\" style=\\\"flex:1\\\"> </div> <div style=\\\"height:12px\\\"></div> <div style=\\\"display:flex;align-items:center;gap:12px\\\"> <label class=\\\"ms-Label\\\" style=\\\"margin:0\\\">Chceme použít vypočtenou velikost vzorku?</label> <select id=\\\"task5-use-calculated\\\" class=\\\"ms-Dropdown\\\" style=\\\"width:160px\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"yes\\\">Ano</option> <option value=\\\"no\\\">Ne</option> </select> </div> <div id=\\\"task5-override-area\\\" style=\\\"display:none;margin-top:8px;gap:8px\\\"> <div style=\\\"font-weight:600;margin-bottom:6px\\\">Vyplňte žádanou velikost a zdůvodněte změnu</div> <input type=\\\"text\\\" id=\\\"task5-override-size\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"Žádaná velikost\\\"> <input type=\\\"text\\\" id=\\\"task5-override-reason\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"Důvod pro změnu\\\"> </div> <div style=\\\"height:8px\\\"></div> <div style=\\\"display:flex;gap:8px;margin-top:8px\\\"> <button id=\\\"task5-confirm-size\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Potvrdit velikost vzorku</span> </button> <div id=\\\"task5-confirm-info\\\" style=\\\"align-self:center;color:#666\\\">&nbsp;</div> </div> </div> </div> </div> <div class=\\\"ms-Grid\\\" style=\\\"margin-bottom:20px\\\"> <div class=\\\"ms-Grid-row\\\"> <div class=\\\"ms-Grid-col ms-sm12\\\"> <div class=\\\"ui-field-title\\\">6. Tvorba vzorku</div> <label class=\\\"ms-Label\\\">Zvolena metoda:</label> <input type=\\\"text\\\" id=\\\"task6-method-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Vybraná metoda\\\" style=\\\"margin-bottom:8px\\\"> <label class=\\\"ms-Label\\\">Velikost vzorku:</label> <input type=\\\"text\\\" id=\\\"task6-final-size-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Potvrzená velikost vzorku\\\"> <div style=\\\"height:8px\\\"></div> <label class=\\\"ms-Label\\\">Vyloučit hodnoty přesahující významnost?</label> <select id=\\\"task6-exclude-over-significance\\\" class=\\\"ms-Dropdown\\\" style=\\\"width:160px;margin-top:6px\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"yes\\\">Ano</option> <option value=\\\"no\\\">Ne</option> </select> <div style=\\\"height:12px\\\"></div> <div style=\\\"display:flex;gap:8px;align-items:center\\\"> <button id=\\\"task6-compute-adjusted-sum\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"margin-right:10px\\\"> <span class=\\\"ms-Button-label\\\">Spočítat upravenou sumu</span> </button> <input type=\\\"text\\\" id=\\\"task6-param-sum-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Parametr sumy\\\" style=\\\"flex:1\\\"> </div> <div id=\\\"task6-count-area\\\" style=\\\"display:none;margin-top:8px;gap:8px\\\"> <label class=\\\"ms-Label\\\">Počet významných položek</label> <input type=\\\"text\\\" id=\\\"task6-significant-count-display\\\" class=\\\"ms-TextField-field\\\" readonly=\\\"readonly\\\" placeholder=\\\"Počet\\\"> </div> <div style=\\\"height:8px\\\"></div> <label class=\\\"ms-Label\\\">Seed pro reprodukovatelnost (volitelně)</label> <input type=\\\"text\\\" id=\\\"task6-seed\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"volitelně: seed pro reprodukovatelnost\\\" style=\\\"margin-top:6px\\\"> <div style=\\\"height:8px\\\"></div> <div style=\\\"display:flex;gap:8px\\\"> <button id=\\\"task6-generate-seed\\\" class=\\\"ms-Button ms-Button--primary\\\" style=\\\"padding:6px 8px\\\">Generovat seed</button> <button id=\\\"task6-regenerate-seed\\\" class=\\\"ms-Button\\\" style=\\\"padding:6px 8px\\\">Znovu generovat seed</button> </div> <div style=\\\"height:12px\\\"></div> <div style=\\\"display:flex;gap:8px\\\"> <button id=\\\"task6-generate-sample\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Vygenerovat výběr vzorku</span> </button> </div> <div style=\\\"height:12px\\\"></div> <label class=\\\"ms-Label\\\">Vytisknout parametry vzorkovače na:</label> <select id=\\\"task6-print-target\\\" class=\\\"ms-Dropdown\\\" style=\\\"width:220px;margin-top:6px\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"above\\\">Nad tabulku</option> <option value=\\\"new-sheet\\\">Na nový list</option> </select> <div style=\\\"height:12px\\\"></div> <div style=\\\"display:flex;gap:8px\\\"> <button id=\\\"task6-generate-parameters\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Vygenerovat parametry vzorkovače</span> </button> </div> </div> </div> </div> <div id=\\\"reliability-modal\\\" class=\\\"modal-overlay\\\" style=\\\"display:none\\\"> <div class=\\\"modal\\\" role=\\\"dialog\\\" aria-modal=\\\"true\\\" aria-labelledby=\\\"reliability-modal-title\\\"> <h3 id=\\\"reliability-modal-title\\\">Nastavení parametrů faktoru spolehlivosti</h3> <div class=\\\"modal-row\\\"> <label for=\\\"reliability-control-risk\\\">1. Kontrolní riziko</label> <select id=\\\"reliability-control-risk\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Nízké\\\">Nízké</option> <option value=\\\"Střední\\\">Střední</option> <option value=\\\"Vysoké\\\">Vysoké</option> </select> </div> <div class=\\\"modal-row\\\"> <label for=\\\"reliability-inherent-risk\\\">2. Přirozené riziko</label> <select id=\\\"reliability-inherent-risk\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Nízké\\\">Nízké</option> <option value=\\\"Střední\\\">Střední</option> <option value=\\\"Vysoké\\\">Vysoké</option> </select> </div> <div class=\\\"modal-row\\\"> <label for=\\\"reliability-rmm-level\\\">3. Hladina RMM</label> <select id=\\\"reliability-rmm-level\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Nízké\\\">Nízké</option> <option value=\\\"Střední\\\">Střední</option> <option value=\\\"Vysoké\\\">Vysoké</option> </select> </div> <div class=\\\"modal-row\\\"> <label for=\\\"reliability-analytical-tests\\\">4. Provádím analytické testy?</label> <select id=\\\"reliability-analytical-tests\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Ano\\\">Ano</option> <option value=\\\"Ne\\\">Ne</option> </select> </div> <div class=\\\"modal-row\\\"> <label for=\\\"reliability-control-tests\\\">5. Provádím testy kontrol?</label> <select id=\\\"reliability-control-tests\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Ano\\\">Ano</option> <option value=\\\"Ne\\\">Ne</option> </select> </div> <div style=\\\"display:flex;gap:8px;margin-top:12px\\\"> <button id=\\\"modal-save-btn\\\" class=\\\"ms-Button ms-Button--primary\\\"><span class=\\\"ms-Button-label\\\">Uložit</span></button> <button id=\\\"modal-reset-btn\\\" class=\\\"ms-Button\\\"><span class=\\\"ms-Button-label\\\">Resetovat</span></button> <button id=\\\"modal-cancel-btn\\\" class=\\\"ms-Button\\\"><span class=\\\"ms-Button-label\\\">Zrušit</span></button> </div> </div> </div> <div id=\\\"significance-modal\\\" class=\\\"modal-overlay\\\" style=\\\"display:none\\\"> <div class=\\\"modal\\\" role=\\\"dialog\\\" aria-modal=\\\"true\\\" aria-labelledby=\\\"significance-modal-title\\\"> <h3 id=\\\"significance-modal-title\\\">Hladina Významnosti</h3> <div class=\\\"modal-row\\\"> <label for=\\\"significance-type\\\">1. O jakou významnost se jedná?</label> <select id=\\\"significance-type\\\"> <option value=\\\"\\\">-Vyberte-</option> <option value=\\\"Prováděcí\\\">Prováděcí</option> <option value=\\\"Specifická\\\">Specifická</option> <option value=\\\"Jiná\\\">Jiná</option> </select> </div> <div class=\\\"modal-row\\\"> <label for=\\\"significance-value\\\">2. Prosím vyplňte hladinu významnosti (bez desetin):</label> <input id=\\\"significance-value\\\" type=\\\"text\\\" placeholder=\\\"např. 5000 nebo 5 % (bude normalizováno)\\\"/> </div> <div class=\\\"modal-row\\\"> <label for=\\\"significance-justification\\\">3. Zdůvodněte použití jiné významnosti než prováděcí</label> <textarea id=\\\"significance-justification\\\" rows=\\\"3\\\" placeholder=\\\"Důvod (pokud je typ 'Prováděcí', bude zobrazeno 'NEVYPLŇOVAT')\\\"></textarea> </div> <div style=\\\"display:flex;gap:8px;margin-top:12px\\\"> <button id=\\\"significance-save-btn\\\" class=\\\"ms-Button ms-Button--primary\\\"><span class=\\\"ms-Button-label\\\">Uložit</span></button> <button id=\\\"significance-reset-btn\\\" class=\\\"ms-Button\\\"><span class=\\\"ms-Button-label\\\">Resetovat</span></button> <button id=\\\"significance-cancel-btn\\\" class=\\\"ms-Button\\\"><span class=\\\"ms-Button-label\\\">Zrušit</span></button> </div> </div> </div> <div id=\\\"notification\\\" class=\\\"notification\\\" style=\\\"display:none\\\"></div> <div style=\\\"text-align:center;margin-top:12px;color:#666;font-style:italic;font-size:12px\\\">Author: Tomáš Pavlovič - developed using GPT-5</div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","controlRisk","inherentRisk","rmmLevel","analyticalTests","controlTests","factor","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","_createForOfIteratorHelper","Array","isArray","_arrayLikeToArray","toString","slice","constructor","name","from","_unsupportedIterableToArray","_n2","F","s","next","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_awaitAsyncGenerator","_OverloadYield","AsyncGenerator","resume","k","settle","reject","key","arg","_asyncIterator","asyncIterator","AsyncFromSyncIterator","AsyncFromSyncIteratorContinuation","throw","reliabilityConfig","confidence","expectedError","populationSize","reliabilitySet","totalSumABS","requestedSampleSize","task6Seed","BATCH_SIZE","openReliabilityDialog","_openReliabilityDialog","_callee2","modal","controlEl","inherentEl","rmmEl","analyticalEl","controlTestsEl","_context2","getElementById","showNotification","style","display","resetSampler","forEach","id","el","overrideArea","countArea","resultsDiv","localStorage","removeItem","samplingMethodEl","task6MethodEl","updateReliabilityDisplay","console","error","task6GenerateSampleHandler","_task6GenerateSampleHandler","_callee3","methodEl","method","_t2","_context3","generateMonetaryRandomWalkTask6","generateRandomNumberGeneratorTask6","generateSample","task6GenerateParametersHandler","_task6GenerateParametersHandler","_callee4","target","params","_t3","_context4","_get_selected_value","gatherSamplerParameters","printParameters","_generateRandomNumberGeneratorTask","_callee6","dataRange","valueColumn","excludeSel","exclude","significance","raw","cfg","sampleSize","parsed","_t5","_context6","getItem","JSON","parse","rawValue","Number","isNaN","parseNumberLoose","Math","ceil","Excel","run","_ref","_callee5","context","worksheet","addr","range","values","absColIndex","rangeStartCol","relColIndex","rowCount","dataRows","step","rng","start","selCounts","posFloat","posIndex","writeColIndex","headerRange","batchGen","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_step","_step$value","batchValues","batchStartRow","isFirstBatch","outputRows","absoluteRowIdx","order","absRaw","_parsed2","absVal","dataRowZeroBased","selection","cnt","writeStartRow","usedSeed2","_t4","_context5","workbook","worksheets","getActiveWorksheet","indexOf","split","pop","trim","getRange","load","sync","getColumnIndex","String","columnIndex","max","isFinite","getTask6Rng","random","fill","floor","columnCount","getRangeByIndexes","rowIndex","format","font","bold","readRangeInBatches","startRow","abs","concat","push","writeRangeInBatches","_x23","message","_generateMonetaryRandomWalkTask","_callee8","totalSum","_parsed3","_t6","_context8","_ref2","_callee7","targets","j","targetIndex","out","absVals","addVals","selections","reasons","_i","_raw3","_parsed4","addVal","cumulative","_i2","_absVal","_addVal","cumulativeBefore","cumulativeAfter","beforeIndex","afterIndex","hits","idxVal","writeRowCount","usedSeed","_context7","getTotalAbsoluteSum","_x24","computeTask6AdjustedSum","_computeTask6AdjustedSum","_callee0","paramOut","countOut","sel","_t8","_context0","_ref3","_callee9","total","significantCount","batchNum","_iteratorAbruptCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","_raw4","displayVal","_t7","_context9","formatIntegerWithSpaces","round","_x25","handleModalReset","handleModalSave","controlRiskEl","inherentRiskEl","analyticalTestsEl","payload","setItem","stringify","warn","saveReliabilityToStorage","numeric","resolveFactorFromTable","placeholder","applyFactorStyle","err","_step8","_iterator8","fsParams","color","fontWeight","control","inherent","rmm","analytical","controls","selectDataRange","_selectDataRange","_callee10","_t9","_context10","_ref4","_callee1","_context1","getSelectedRange","address","log","_x26","selectValueColumn","_selectValueColumn","_callee12","_t0","_context12","_ref5","_callee11","colIdx","colLetter","_context11","columnIndexToLetter","_x27","index","letter","temp","rem","fromCharCode","_generateSample","_callee14","errorMessage","_t1","_context14","_ref6","_callee13","totalRows","sample","_context13","confirm","toLocaleString","generateMonetaryRandomWalkStreaming","generateRandomNumberSampleStreaming","displayResults","highlightSampleRows","_x28","includes","columnRef","parseInt","result","charCodeAt","_x4","_x5","_x6","_x7","_x8","_writeRangeInBatches","_callee15","startRowIdx","startColIdx","rows","batchSize","offset","batchRows","batchRowCount","_args15","_context15","_x","_x2","_x3","_readRangeInBatches","_callee","startCol","colCount","subRange","_t","_context","min","setTimeout","_x9","_x0","_x1","_x10","_x11","_generateMonetaryRandomWalkStreaming","_callee16","totalValue","_iteratorAbruptCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","interval","currentSum","nextTarget","globalRowIndex","_iteratorAbruptCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","_values","_startIdx","_i3","_raw5","_parsed5","_value","_t10","_t11","_context16","calculateSampleSize","startIdx","rowData","cumulativeValue","_x12","_x13","_x14","_x15","_x16","_generateRandomNumberSampleStreaming","_callee17","_iteratorAbruptCompletion5","_didIteratorError5","_iteratorError5","_iterator5","_step5","selectedIndices","randomIndex","_iteratorAbruptCompletion6","_didIteratorError6","_iteratorError6","_iterator6","_step6","_values2","_startIdx2","_i4","_t12","_t13","_context17","Set","size","add","has","factorNum","factorEl","resolved","materiality","_reliabilityConfig","z","reduce","sum","row","input","saveTotalSumAbsToStorage","val","saveTask6Seed","seedVal","h","str","imul","xfnv1aHash","makeRandomSeed","Date","now","sampleInfo","sampleList","innerHTML","toFixed","listHtml","item","_x17","_x18","_x19","_x20","_highlightSampleRows","_callee18","_iterator9","_step9","rowAddress","_t14","_context18","clear","timeout","textContent","openSignificanceDialog","typeEl","valueEl","justEl","type","justification","readOnly","onchange","liveFormatFn","ev","inputEl","old","selStart","selectionStart","cleaned","asNum","formatted","digitsBefore","newPos","digitsSeen","setSelectionRange","formatIntegerInputWithCursor","removeEventListener","addEventListener","handleSignificanceSave","rawInput","rawNumber","digits","typeDisplay","valueDisplay","justDisplay","handleSignificanceReset","computeTask5Sum","_computeTask5Sum","_callee21","outEl","msg","_t16","_context21","_ref7","_callee20","_iteratorAbruptCompletion7","_didIteratorError7","_iteratorError7","_iterator7","_step7","totalCeil","_t15","_context20","_x29","stack","computeTask5Size","handleTask5UseChoice","area","overrideSize","overrideReason","flexDirection","confirmRequestedSize","useSel","overrideSizeEl","overrideReasonEl","infoEl","sizeEl","requested","task6Size","task6Method","options","selectedIndex","text","_get_value","_format_params","_x21","_x22","_printParameters","_callee23","_t17","_context23","_ref8","_callee22","newSheet","_newSheet","_range2","sheet","usedRange","_context22","activate","getUsedRange","insert","InsertShiftDirection","down","_x30","useCalculated","Office","onReady","info","host","HostType","setReliabilityBtn","onclick","resetBtnMain","selectRangeBtn","selectColumnBtn","task5Btn","task5SizeBtn","task5UseSelect","task5ConfirmBtn","m0","samplingMethodEl0","task6ExcludeSel","saveTask6ExcludeSetting","loadTask6ExcludeSetting","loadTask6PrintTarget","task6ComputeBtn","printTargetSel","saveTask6PrintTarget","task6GenBtn","task6ParamsBtn","seedEl","loadTask6Seed","genSeedBtn","regenSeedBtn","fillSignificanceBtn","sigSave","sigCancel","sigReset","loadReliabilityFromStorage","loadSignificanceFromStorage","loadTotalSumAbsFromStorage","saveBtn","cancelBtn","resetBtn","URL"],"sourceRoot":""}