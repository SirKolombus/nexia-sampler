/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={3432:function(e,t,n){e.exports=n.p+"assets/Head.png"},58394:function(e,t,n){e.exports=n.p+"9b5d5f4f1a617c087646.css"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){var e=[{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"0.7"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"1.1"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"0.7"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"1.6"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0.7"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"1.4"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"1.1"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"1.8"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"1.4"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"2.3"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"1.1"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"1.9"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"1.4"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"2.3"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ano",controlTests:"Ne",factor:"1.9"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ne",controlTests:"Ne",factor:"3"}];function t(){var e,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function i(t,a,o,l){var i=a&&a.prototype instanceof c?a:c,u=Object.create(i.prototype);return n(u,"_invoke",function(t,n,a){var o,l,i,c=0,u=a||[],d=!1,v={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,l=0,i=e,v.n=n,s}};function m(t,n){for(l=t,i=n,r=0;!d&&c&&!a&&r<u.length;r++){var a,o=u[r],m=v.p,y=o[2];t>3?(a=y===n)&&(i=o[(l=o[4])?5:(l=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=t<2&&m<o[1])?(l=0,v.v=n,v.n=o[1]):m<y&&(a=t<3||o[0]>n||n>y)&&(o[4]=t,o[5]=n,v.n=y,l=0))}if(a||t>1)return s;throw d=!0,n}return function(a,u,y){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,y),l=u,i=y;(r=l<2?e:i)||!d;){o||(l?l<3?(l>1&&(v.n=-1),m(l,i)):v.n=i:v.v=i);try{if(c=2,o){if(l||(a="next"),r=o[a]){if(!(r=r.call(o,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,l<2&&(l=0)}else 1===l&&(r=o.return)&&r.call(o),l<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),l=1);o=e}else if((r=(d=v.n<0)?i:t.call(n,v))!==s)break}catch(t){o=e,l=1,i=t}finally{c=1}}return{value:r,done:d}}}(t,o,l),!0),u}var s={};function c(){}function u(){}function d(){}r=Object.getPrototypeOf;var v=[][o]?r(r([][o]())):(n(r={},o,function(){return this}),r),m=d.prototype=c.prototype=Object.create(v);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,n(m,"constructor",d),n(d,"constructor",u),u.displayName="GeneratorFunction",n(d,l,"GeneratorFunction"),n(m),n(m,l,"Generator"),n(m,o,function(){return this}),n(m,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:y}})()}function n(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}n=function(e,t,r,a){function l(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(l("next",0),l("throw",1),l("return",2))},n(e,t,r,a)}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw l}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n,r,a,o,l){try{var i=e[o](l),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var l=e.apply(t,n);function i(e){o(l,r,a,i,s,"next",e)}function s(e){o(l,r,a,i,s,"throw",e)}i(void 0)})}}function i(e){return new c(e,0)}function s(e){var t,n;function r(t,n){try{var o=e[t](n),l=o.value,i=l instanceof c;Promise.resolve(i?l.v:l).then(function(n){if(i){var s="return"===t?"return":"next";if(!l.k||n.done)return r(s,n);n=e[s](n).value}a(o.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise(function(o,l){var i={key:e,arg:a,resolve:o,reject:l,next:null};n?n=n.next=i:(t=n=i,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function c(e,t){this.v=e,this.k=t}function u(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new d(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function d(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return d=function(e){this.s=e,this.n=e.next},d.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new d(e)}s.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},s.prototype.next=function(e){return this._invoke("next",e)},s.prototype.throw=function(e){return this._invoke("throw",e)},s.prototype.return=function(e){return this._invoke("return",e)};var v={confidence:95,expectedError:5,populationSize:1e3},m=!1,y=null,f=null,p=null,k=5e3;function g(){return h.apply(this,arguments)}function h(){return(h=l(t().m(function e(){var n,r,a,o,l,i;return t().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("reliability-modal")){e.n=1;break}return le("Dialog není dostupný."),e.a(2);case 1:r=document.getElementById("reliability-control-risk"),a=document.getElementById("reliability-inherent-risk"),o=document.getElementById("reliability-rmm-level"),l=document.getElementById("reliability-analytical-tests"),i=document.getElementById("reliability-control-tests"),r&&v.controlRisk&&(r.value=v.controlRisk),r&&(r.value=v.controlRisk||""),a&&(a.value=v.inherentRisk||""),o&&(o.value=v.rmmLevel||""),l&&(l.value=v.analyticalTests||""),i&&(i.value=v.controlTests||""),n.style.display="flex";case 2:return e.a(2)}},e)}))).apply(this,arguments)}function b(){try{["reliability-factor","significance-type-display","significance-value-display","significance-justification-display","sampling-method","data-range","value-column","task5-result-display","task5-size-display","task5-use-calculated","task5-override-size","task5-override-reason","task5-confirm-info","task6-method-display","task6-final-size-display","task6-exclude-over-significance","task6-param-sum-display","task6-significant-count-display","task6-print-target","task6-seed"].forEach(function(e){try{var t=document.getElementById(e);if(!t)return;t.tagName,t.value=""}catch(e){}});var e=document.getElementById("task5-override-area");e&&(e.style.display="none");var t=document.getElementById("task6-count-area");t&&(t.style.display="none");var n=document.getElementById("results");n&&(n.style.display="none"),["reliabilityConfig","significanceConfig","TotalSumABS","task6ExcludeOverSignificance","task6PrintTarget","task6Seed"].forEach(function(e){try{localStorage.removeItem(e)}catch(e){}}),v={confidence:95,expectedError:5,populationSize:1e3},m=!1,y=null,f=null;try{var r=document.getElementById("sampling-method");r&&(r.value="");var a=document.getElementById("task6-method-display");a&&(a.value="<Vyberte>")}catch(e){}P(),le("Vzorkovač byl restartován.")}catch(e){console.error("Chyba při resetu vzorkovače:",e),le("Chyba při restartu vzorkovače.")}}function I(){return E.apply(this,arguments)}function E(){return(E=l(t().m(function e(){var n,r,a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=1,n=document.getElementById("sampling-method"),"monetary-random-walk"!==(r=n?n.value:null)){e.n=3;break}return e.n=2,T();case 2:e.v,e.n=7;break;case 3:if("random-number-generator"!==r){e.n=5;break}return e.n=4,z();case 4:e.v,e.n=7;break;case 5:return e.n=6,G();case 6:case 7:e.n=9;break;case 8:e.p=8,a=e.v,console.error("Chyba při spuštění generování vzorku z Task6:",a),le("Chyba při generování vzorku.");case 9:return e.a(2)}},e,null,[[1,8]])}))).apply(this,arguments)}function w(){return N.apply(this,arguments)}function N(){return(N=l(t().m(function e(){var n,r,a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(n=ke("task6-print-target"))||""===n){e.n=2;break}return r=Ie(),e.n=1,he(r,n);case 1:le("Parametry byly vygenerovány."),e.n=3;break;case 2:le("Vyberte prosím cíl pro tisk parametrů.");case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.error("Chyba při generování parametrů:",a),le("Chyba při generování parametrů.");case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function z(){return B.apply(this,arguments)}function B(){return B=l(t().m(function e(){var n,r,a,o,i,s,c,d,v,m,y;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("data-range")&&document.getElementById("data-range").value,r=document.getElementById("value-column")&&document.getElementById("value-column").value,n&&r){e.n=1;break}return le("Nejdříve vyberte oblast dat a sloupec (úloha 4)."),e.a(2,!1);case 1:a=document.getElementById("task6-exclude-over-significance"),o=a&&"yes"===a.value,i=null;try{(s=localStorage.getItem("significanceConfig"))&&(c=JSON.parse(s))&&void 0!==c.rawValue&&null!==c.rawValue&&(i=Number(c.rawValue))}catch(e){}if(!o||null!==i&&!Number.isNaN(i)){e.n=2;break}return le("Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3)."),e.a(2,!1);case 2:if((d=f||null)||(v=document.getElementById("task5-size-display"))&&v.value&&null!==(m=Q(v.value))&&(d=Math.ceil(m)),d&&!(d<=0)){e.n=3;break}return le("Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5."),e.a(2,!1);case 3:return e.n=4,Excel.run(function(){var e=l(t().m(function e(a){var l,s,c,v,m,y,f,g,h,b,I,E,w,N,z,B,T,S,R,x,A,C,V,P,L,j,O,M,U,D,G,H,Z,$,_,Y,K,q,X,ee,ne;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=a.workbook.worksheets.getActiveWorksheet(),-1!==(s=n).indexOf("!")&&(s=s.split("!").pop()),s=s.replace(/\$/g,"").trim(),(c=l.getRange(s)).load(["values","rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,a.sync();case 1:if(v=c.values,m=J(String(r).toUpperCase()),y="number"==typeof c.columnIndex?c.columnIndex:0,f=m-y,g=c.rowCount||(v?v.length:0),!(!Array.isArray(v)||v.length<=1||f<0||f>=(v[0]?v[0].length:0))){e.n=2;break}return le("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2,!1);case 2:if(0!==(h=Math.max(0,g-1))){e.n=3;break}return le("Datová oblast neobsahuje žádné řádky."),e.a(2,!1);case 3:if(b=h/d,isFinite(b)&&!(b<=0)){e.n=4;break}return le("Neplatný krok (krok <= 0)."),e.a(2,!1);case 4:for(I=te(),E=("function"==typeof I?I():Math.random())*b,w=new Array(h).fill(0),N=0;N<d;N++)(z=(E+N*b)%h)<0&&(z+=h),B=Math.floor(z),w[B]=(w[B]||0)+1;T=c.columnIndex+c.columnCount,(S=l.getRangeByIndexes(c.rowIndex,T,1,2)).values=[["Pořadí","Výběr"]],S.format.font.bold=!0,R=F(a,l,c,k),x=!1,A=!1,e.p=5,V=u(R);case 6:return e.n=7,V.next();case 7:if(!(x=!(P=e.v).done)){e.n=9;break}for(L=P.value,j=L.values,O=L.startRow,M=O===c.rowIndex,U=[],D=M?1:0;D<j.length;D++)G=O-c.rowIndex+D,H=G,Z=j[D][f],$=Q(Z),_=null===$?0:Math.abs($),Y=G-1,K="Ne",o&&null!==i&&_>i?K="Ano - významnost":w[Y]&&w[Y]>0&&(q=w[Y],K=1===q?"Ano - NGČ":"Ano - NGČ (x".concat(q,")")),U.push([H,K]);return X=c.rowIndex+(M?1:O-c.rowIndex),e.n=8,W(a,l,X,T,U,k);case 8:x=!1,e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,ne=e.v,A=!0,C=ne;case 11:if(e.p=11,e.p=12,!x||null==V.return){e.n=13;break}return e.n=13,V.return();case 13:if(e.p=13,!A){e.n=14;break}throw C;case 14:return e.f(13);case 15:return e.f(11);case 16:return e.n=17,a.sync();case 17:le("Generování (NGČ) dokončeno. Výsledky jsou vloženy do listu."+((ee=p||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value||"")?" Použit seed: ".concat(ee):""));case 18:return e.a(2)}},e,null,[[12,,13,15],[5,10,11,16]])}));return function(t){return e.apply(this,arguments)}}());case 4:return e.a(2,!0);case 5:return e.p=5,y=e.v,console.error("Chyba v generateRandomNumberGeneratorTask6:",y),le("Chyba při generování NGČ: "+(y&&y.message?y.message:"")),e.a(2,!1)}},e,null,[[0,5]])})),B.apply(this,arguments)}function T(){return S.apply(this,arguments)}function S(){return S=l(t().m(function e(){var n,r,a,o,i,s,c,u,d,v,m,k,g,h;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("data-range")&&document.getElementById("data-range").value,r=document.getElementById("value-column")&&document.getElementById("value-column").value,n&&r){e.n=1;break}return le("Nejdříve vyberte oblast dat a sloupec (úloha 4)."),e.a(2,!1);case 1:a=document.getElementById("task6-exclude-over-significance"),o=a&&"yes"===a.value,i=null;try{(s=localStorage.getItem("significanceConfig"))&&(c=JSON.parse(s))&&void 0!==c.rawValue&&null!==c.rawValue&&(i=Number(c.rawValue))}catch(e){}if(!o||null!==i&&!Number.isNaN(i)){e.n=2;break}return le("Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3)."),e.a(2,!1);case 2:if((u=f||null)||(d=document.getElementById("task5-size-display"))&&d.value&&null!==(v=Q(d.value))&&(u=Math.ceil(v)),u&&!(u<=0)){e.n=3;break}return le("Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5."),e.a(2,!1);case 3:m=null;try{(k=document.getElementById("task6-param-sum-display"))&&k.value&&null!==(g=Q(k.value))&&(m=g)}catch(e){}return null===m&&(m=y),e.n=4,Excel.run(function(){var e=l(t().m(function e(a){var l,s,c,d,v,y,f,k,g,h,b,I,E,w,N,z,B,T,S,R,x,A,C,V,P,L,j,O,M,U,D,G,H,W,Z,F,$,_;return t().w(function(e){for(;;)switch(e.n){case 0:return l=a.workbook.worksheets.getActiveWorksheet(),-1!==(s=n).indexOf("!")&&(s=s.split("!").pop()),s=s.replace(/\$/g,"").trim(),(c=l.getRange(s)).load(["values","rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,a.sync();case 1:if(d=c.values,v=J(String(r).toUpperCase()),y="number"==typeof c.columnIndex?c.columnIndex:0,f=v-y,k=c.rowCount||(d?d.length:0),!(!Array.isArray(d)||d.length<=1||f<0||f>=(d[0]?d[0].length:0))){e.n=2;break}return le("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2,!1);case 2:if((null===m||Number.isNaN(m))&&(m=q(d,f)),!(!m||Number.isNaN(m)||m<=0)){e.n=3;break}return le("TotalSum je nula nebo neplatná."),e.a(2,!1);case 3:if(g=m/u,isFinite(g)&&!(g<=0)){e.n=4;break}return le("Neplatný krok (krok <= 0)."),e.a(2,!1);case 4:for(h=te(),b=("function"==typeof h?h():Math.random())*g,I=new Array(u),E=0;E<u;E++)I[E]=b+E*g;for(w=0,(N=new Array(k))[0]=["ABS","Kumulace ABS","Index/krok","Výběr","Důvod"],z=new Array(k),B=new Array(k),T=new Array(k),S=new Array(k),R=0;R<k;R++)T[R]="Ne",S[R]="";for(x=1;x<k;x++)A=d[x][f],C=Q(A),V=null===C?0:Math.abs(C),z[x]=V,P=V,o&&null!==i&&V>i&&(P=0,T[x]="Ano - významnost",S[x]="přesah významnosti"),B[x]=P;for(L=0,j=1;j<k;j++)O=z[j]||0,M=B[j]||0,D=(U=1===j?b:L)+M,G=Math.floor(U/g),H=Math.floor(D/g),(W=Math.max(0,H-G))>0&&w+W>I.length&&(W=Math.max(0,I.length-w)),W>0&&(w+=W,"Ano - významnost"===T[j]?(T[j]="Ano - významnost; Ano - NPP",S[j]=S[j]?S[j]+"; NPP":"NPP"):(T[j]=1===W?"Ano - NPP":"Ano - NPP (x".concat(W,")"),S[j]="NPP")),Z=(L=D)/g,N[j]=[O,L,Z,T[j],S[j]];return F=k,$=c.columnIndex+c.columnCount,l.getRangeByIndexes(c.rowIndex,$,F,5).values=N,l.getRangeByIndexes(c.rowIndex,$,1,5).format.font.bold=!0,e.n=5,a.sync();case 5:le("Generování dokončeno. Výsledky jsou vloženy do listu."+((_=p||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value||"")?" Použit seed: ".concat(_):""));case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.a(2,!0);case 5:return e.p=5,h=e.v,console.error("Chyba v generateMonetaryRandomWalkTask6:",h),le("Chyba při generování mon. random walk: "+(h&&h.message?h.message:"")),e.a(2,!1)}},e,null,[[0,5]])})),S.apply(this,arguments)}function R(){return x.apply(this,arguments)}function x(){return x=l(t().m(function e(){var n,r,a,o,i,s,c,d,v,m,f;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("data-range").value,r=document.getElementById("value-column").value,a=document.getElementById("task6-param-sum-display"),o=document.getElementById("task6-count-area"),i=document.getElementById("task6-significant-count-display"),n&&r){e.n=1;break}return le("Prosím nejprve vyberte oblast dat a sloupec (úloha 4)."),a&&(a.value=""),o&&(o.style.display="none"),e.a(2);case 1:s=document.getElementById("task6-exclude-over-significance"),c=s&&"yes"===s.value,d=null;try{(v=localStorage.getItem("significanceConfig"))&&(m=JSON.parse(v))&&void 0!==m.rawValue&&null!==m.rawValue&&(d=Number(m.rawValue))}catch(e){}return e.n=2,Excel.run(function(){var e=l(t().m(function e(l){var s,v,m,f,p,k,g,h,b,I,E,w,N,z,B,T,S,R,x,A,C;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=l.workbook.worksheets.getActiveWorksheet(),-1!==(v=n).indexOf("!")&&(v=v.split("!").pop()),v=v.replace(/\$/g,"").trim(),(m=s.getRange(v)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,l.sync();case 1:if(f=J(String(r).toUpperCase()),p="number"==typeof m.columnIndex?m.columnIndex:0,!((k=f-p)<0||k>=m.columnCount)){e.n=2;break}return le("Zadaný sloupec není v rámci vybraného rozsahu dat."),a&&(a.value=""),o&&(o.style.display="none"),e.a(2);case 2:g=0,h=0,b=0,I=!1,E=!1,e.p=3,N=u(F(l,s,m));case 4:return e.n=5,N.next();case 5:if(!(I=!(z=e.v).done)){e.n=10;break}B=z.value.values,b++,le("Zpracovává se dávka ".concat(b,"...")),T=1;case 6:if(!(T<B.length)){e.n=9;break}if(S=B[T][k],null!==(R=Q(S))){e.n=7;break}return e.a(3,8);case 7:x=Math.abs(R),c&&null!==d&&!Number.isNaN(d)?x<=d?g+=x:h+=1:g+=x;case 8:T++,e.n=6;break;case 9:I=!1,e.n=4;break;case 10:e.n=12;break;case 11:e.p=11,C=e.v,E=!0,w=C;case 12:if(e.p=12,e.p=13,!I||null==N.return){e.n=14;break}return e.n=14,N.return();case 14:if(e.p=14,!E){e.n=15;break}throw w;case 15:return e.f(14);case 16:return e.f(12);case 17:c?(a&&(a.value=ue(Math.ceil(g))),o&&(o.style.display="flex"),i&&(i.value=String(h))):(A=null!=y?y:Math.ceil(g),a&&(a.value=ue(Math.round(A))),o&&(o.style.display="none")),le("Upravená suma spočítána.");case 18:return e.a(2)}},e,null,[[13,,14,16],[3,11,12,17]])}));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,f=e.v,console.error("Chyba při výpočtu upravené sumy:",f),le("Chyba při výpočtu upravené sumy.");case 4:return e.a(2)}},e,null,[[0,3]])})),x.apply(this,arguments)}function A(){try{localStorage.removeItem("reliabilityConfig"),delete v.controlRisk,delete v.inherentRisk,delete v.analyticalTests,delete v.controlTests,m=!1;var e=document.getElementById("reliability-control-risk"),t=document.getElementById("reliability-inherent-risk"),n=document.getElementById("reliability-analytical-tests"),r=document.getElementById("reliability-control-tests");e&&(e.value=""),t&&(t.value=""),n&&(n.value=""),r&&(r.value=""),P();var a=document.getElementById("reliability-modal");a&&(a.style.display="none"),le("Nastavení bylo resetováno.")}catch(e){console.error("Chyba při resetování:",e),le("Nepodařilo se resetovat nastavení.")}}function C(){try{var e=document.getElementById("reliability-modal"),t=document.getElementById("reliability-control-risk"),n=document.getElementById("reliability-inherent-risk"),r=document.getElementById("reliability-analytical-tests"),a=document.getElementById("reliability-control-tests"),o=t&&t.value?t.value:v.controlRisk,l=n&&n.value?n.value:v.inherentRisk,i=r&&r.value?r.value:v.analyticalTests,s=a&&a.value?a.value:v.controlTests,c=document.getElementById("reliability-rmm-level")&&document.getElementById("reliability-rmm-level").value?document.getElementById("reliability-rmm-level").value:v.rmmLevel;if(!(o&&l&&c&&i&&s))return void le("Po uložení musí být vyplněna všechna pole (nebo zvolena dříve). Vyplňte chybějící položky.");v.controlRisk=o,v.inherentRisk=l,v.analyticalTests=i,v.controlTests=s,v.rmmLevel=c,m=!0,function(){try{var e={controlRisk:v.controlRisk,inherentRisk:v.inherentRisk,analyticalTests:v.analyticalTests,controlTests:v.controlTests,rmmLevel:v.rmmLevel};localStorage.setItem("reliabilityConfig",JSON.stringify(e))}catch(e){console.warn("Nelze uložit nastavení do localStorage:",e.message)}}(),P();var u=V(v),d=document.getElementById("reliability-factor");d&&(null!==u?(d.placeholder="",d.value=String(u),L(d,String(u))):(d.value="",d.placeholder="<Nevyplněno>",L(d,null))),e&&(e.style.display="none")}catch(e){console.error("Chyba při ukládání nastavení spolehlivosti:",e),le("Došlo k neočekávané chybě při ukládání.")}}function V(t){if(!t||!t.controlRisk)return null;var n,a=r(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.controlRisk===t.controlRisk&&o.inherentRisk===t.inherentRisk&&o.rmmLevel===t.rmmLevel&&o.analyticalTests===t.analyticalTests&&o.controlTests===t.controlTests)return o.factor}}catch(e){a.e(e)}finally{a.f()}return null}function P(){var e=document.getElementById("reliability-factor");if(!m)return e.value="",e.placeholder="<Nevyplněno>",e.style.color="",void(e.style.fontWeight="");var t=v.controlRisk||"-",n=v.inherentRisk||"-",r=v.rmmLevel||"-",a=v.analyticalTests||"-",o=v.controlTests||"-",l="Kontrolní riziko: ".concat(t,", Přirozené riziko: ").concat(n,", Hladina RMM: ").concat(r,", Analytické testy: ").concat(a,", Testy kontrol: ").concat(o);e.placeholder="",e.value=l,e.style.color="",e.style.fontWeight=""}function L(e,t){e&&("Test kontrol Error"===t?(e.style.color="red",e.style.fontWeight="700"):(e.style.color="",e.style.fontWeight=""))}function j(){return O.apply(this,arguments)}function O(){return O=l(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(t().m(function e(n){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load("address"),e.n=1,n.sync();case 1:document.getElementById("data-range").value=r.address,console.log("Vybrán rozsah: ".concat(r.address));case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Chyba při výběru rozsahu:",n),le("Chyba při výběru rozsahu. Ujistěte se, že máte vybraný rozsah v Excelu.");case 3:return e.a(2)}},e,null,[[0,2]])})),O.apply(this,arguments)}function M(){return U.apply(this,arguments)}function U(){return U=l(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(t().m(function e(n){var r,a,o;return t().w(function(e){for(;;)switch(e.n){case 0:return(r=n.workbook.getSelectedRange()).load(["columnIndex"]),e.n=1,n.sync();case 1:a=r.columnIndex,o=D(a),document.getElementById("value-column").value=o,console.log("Vybrán sloupec: ".concat(o));case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Chyba při výběru sloupce:",n),le("Chyba při výběru sloupce. Ujistěte se, že máte vybranou buňku v Excelu.");case 3:return e.a(2)}},e,null,[[0,2]])})),U.apply(this,arguments)}function D(e){for(var t="",n=e+1;n>0;){var r=(n-1)%26;t=String.fromCharCode(65+r)+t,n=Math.floor((n-1)/26)}return t}function G(){return H.apply(this,arguments)}function H(){return H=l(t().m(function e(){var n,r,a,o;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("sampling-method").value,r=document.getElementById("data-range").value,a=document.getElementById("value-column").value,r&&a){e.n=1;break}return le("Prosím vyplňte všechna povinná pole."),e.a(2);case 1:return e.n=2,Excel.run(function(){var e=l(t().m(function e(o){var l,i,s,c,d,v,m,y,f,p,g,h,b,I,E,w;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=o.workbook.worksheets.getActiveWorksheet(),-1!==(i=r).indexOf("!")&&(i=i.split("!").pop()),i=i.replace(/\$/g,"").trim(),(s=l.getRange(i)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,o.sync();case 1:if(c=J(String(a).toUpperCase()),d="number"==typeof s.columnIndex?s.columnIndex:0,!((v=c-d)<0||v>=s.columnCount)){e.n=2;break}return le("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2);case 2:m=[],y=0,f=!1,p=!1,e.p=3,h=u(F(o,l,s,k));case 4:return e.n=5,h.next();case 5:if(!(f=!(b=e.v).done)){e.n=7;break}I=b.value.values,y++,le("Zpracovává se dávka ".concat(y,"...")),0===m.length&&m.push(I[0]),m=m.concat(I.slice(1));case 6:f=!1,e.n=4;break;case 7:e.n=9;break;case 8:e.p=8,w=e.v,p=!0,g=w;case 9:if(e.p=9,e.p=10,!f||null==h.return){e.n=11;break}return e.n=11,h.return();case 11:if(e.p=11,!p){e.n=12;break}throw g;case 12:return e.f(11);case 13:return e.f(9);case 14:return re(E="monetary-random-walk"===n?_(m,v):Y(m,v),m.length),e.n=15,ae(o,l,r,E);case 15:return e.a(2)}},e,null,[[10,,11,13],[3,8,9,14]])}));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,o=e.v,console.error("Chyba při generování vzorku:",o),le("Chyba při generování vzorku: "+(o&&o.message?o.message:""));case 4:return e.a(2)}},e,null,[[0,3]])})),H.apply(this,arguments)}function J(e){if(!isNaN(e))return parseInt(e)-1;for(var t=0,n=0;n<e.length;n++)t=26*t+(e.charCodeAt(n)-"A".charCodeAt(0)+1);return t-1}function W(e,t,n,r,a){return Z.apply(this,arguments)}function Z(){return Z=l(t().m(function e(n,r,a,o,l){var i,s,c,u,d=arguments;return t().w(function(e){for(;;)switch(e.n){case 0:i=d.length>5&&void 0!==d[5]?d[5]:k,s=0;case 1:if(!(s<l.length)){e.n=3;break}return c=l.slice(s,s+i),u=c.length,r.getRangeByIndexes(a+s,o,u,c[0].length).values=c,e.n=2,n.sync();case 2:s+=i,e.n=1;break;case 3:return e.a(2)}},e)})),Z.apply(this,arguments)}function F(e,t,n){return $.apply(this,arguments)}function $(){var e;return e=function(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;return t().m(function o(){var l,s,c,u,d,v,m;return t().w(function(t){for(;;)switch(t.n){case 0:l=r.rowCount,s=r.rowIndex,c=r.columnIndex,u=r.columnCount,d=0;case 1:if(!(d<l)){t.n=4;break}return v=Math.min(a,l-d),(m=n.getRangeByIndexes(s+d,c,v,u)).load("values"),t.n=2,i(e.sync());case 2:return t.n=3,{values:m.values,startRow:s+d};case 3:d+=a,t.n=1;break;case 4:return t.a(2)}},o)})()},$=function(){return new s(e.apply(this,arguments))},$.apply(this,arguments)}function _(e,t){var n=e.slice(1).reduce(function(e,n){var r=Q(n[t]),a=null!==r?r:0;return e+Math.abs(a)},0),r=K(n);if(!r||r<1)return[];for(var a=n/r,o=[],l=0,i=te(),s=("function"==typeof i?i():Math.random())*a,c=1;c<e.length;c++){var u=Q(e[c][t]);(l+=null!==u?Math.abs(u):0)>=s&&(o.push({rowIndex:c,rowData:e[c],value:e[c][t],cumulativeValue:l}),s+=a)}return o.slice(0,r)}function Y(e,t){for(var n=K(e.slice(1).reduce(function(e,n){var r=Q(n[t]),a=null!==r?r:0;return e+Math.abs(a)},0)),r=e.slice(1),a=[],o=new Set;a.length<n&&a.length<r.length;){var l=te(),i=Math.floor(("function"==typeof l?l():Math.random())*r.length);o.has(i)||(o.add(i),a.push({rowIndex:i+1,rowData:r[i],value:r[i][t]}))}return a}function K(e){var t=null;try{var n=document.getElementById("reliability-factor");if(n&&n.value){var r=Q(n.value);null!==r&&(t=r)}}catch(k){}if(null===t||Number.isNaN(t)){var a=V(v);"number"!=typeof a||Number.isNaN(a)||(t=a)}var o=null;try{var l=localStorage.getItem("significanceConfig");if(l){var i=JSON.parse(l);if(i&&"number"==typeof i.rawValue)o=i.rawValue;else if(i&&i.rawValue){var s=Q(i.rawValue);null!==s&&(o=s)}}}catch(k){}if("number"==typeof e&&!Number.isNaN(e)&&t&&o&&o>0){var c=e*t/o,u=Math.ceil(c);return Math.max(1,u)}try{var d=v,m=d.confidence,y=d.expectedError,f=d.populationSize,p=95===m?1.96:99===m?2.58:1.645,k=y/100,g=p*p*.5*.5/(k*k);return f>0&&(g/=1+(g-1)/f),Math.ceil(g)}catch(k){return 1}}function q(e,t){return!Array.isArray(e)||e.length<=1?0:e.slice(1).reduce(function(e,n){var r=Q(n&&n.length>t?n[t]:null);return null===r?e:e+Math.abs(r)},0)}function Q(e){if(null==e)return null;var t=String(e).trim();if(""===t)return null;t=(t=-1!==(t=t.replace(/\s+/g,"")).indexOf(",")&&-1===t.indexOf(".")?t.replace(",","."):t.replace(/,/g,"")).replace(/[^0-9.\-]/g,"");var n=Number(t);return Number.isFinite(n)?n:null}function X(e){try{localStorage.setItem("TotalSumABS",JSON.stringify(e))}catch(e){console.warn("Nelze uložit TotalSumABS:",e&&e.message?e.message:e)}}function ee(e){try{localStorage.setItem("task6Seed",String(e)),p=e}catch(e){console.warn("Nelze uložit seed:",e)}}function te(){try{var e=p||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value;if(!e&&0!==e)return null;var t=function(e){for(var t=2166136261,n=0;n<e.length;n++)t^=e.charCodeAt(n),t=Math.imul(t,16777619)>>>0;return t+=t<<13,t^=t>>>7,t+=t<<3,t^=t>>>17,(t+=t<<5)>>>0}(String(e));return n=t,function(){n=1831565813+(n|=0)|0;var e=Math.imul(n^n>>>15,1|n);return(((e=e+Math.imul(e^e>>>7,61|e)^e)^e>>>14)>>>0)/4294967296}}catch(e){return null}var n}function ne(){var e=Date.now().toString(36),t=Math.floor(1e6*Math.random()).toString(36);return"".concat(e,"-").concat(t)}function re(e,t){var n=document.getElementById("results"),r=document.getElementById("sample-info"),a=document.getElementById("sample-list");r.innerHTML="\n    <strong>Celkem řádků:</strong> ".concat(t,"<br>\n    <strong>Velikost vzorku:</strong> ").concat(e.length,"<br>\n    <strong>Procento vzorku:</strong> ").concat((e.length/t*100).toFixed(2),"%\n  ");var o="<strong>Vybrané řádky:</strong><br>";e.forEach(function(e,t){o+="".concat(t+1,". Řádek ").concat(e.rowIndex+1,", Hodnota: ").concat(e.value,"<br>")}),a.innerHTML=o,n.style.display="block"}function ae(e,t,n,r){return oe.apply(this,arguments)}function oe(){return(oe=l(t().m(function e(n,a,o,l){var i,s,c,u,d;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,a.getRange(o).format.fill.clear(),i=r(l);try{for(i.s();!(s=i.n()).done;)c=s.value,u=o.split(":")[0].replace(/\d+/,(c.rowIndex+1).toString())+":"+o.split(":")[1].replace(/\d+/,(c.rowIndex+1).toString()),a.getRange(u).format.fill.color="yellow"}catch(e){i.e(e)}finally{i.f()}return e.n=1,n.sync();case 1:e.n=3;break;case 2:e.p=2,d=e.v,console.log("Varování: Nepodařilo se zvýraznit řádky:",d.message);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;try{var n=document.getElementById("notification");if(!n)return;n.textContent=e,n.style.display="block",setTimeout(function(){n.style.display="none"},t)}catch(t){console.log("Notifikace:",e)}}function ie(){var e=document.getElementById("significance-modal"),t=document.getElementById("significance-type"),n=document.getElementById("significance-value"),r=document.getElementById("significance-justification");if(e&&t&&n&&r){var a=localStorage.getItem("significanceConfig"),o=null;try{o=a?JSON.parse(a):null}catch(e){o=null}o?(t.value=o.type||"",n.value=void 0!==o.rawValue&&null!==o.rawValue?String(o.rawValue):"",r.value=o.justification||""):(t.value="",n.value="",r.value=""),"Prováděcí"===t.value?(r.value="NEVYPLŇOVAT",r.readOnly=!0):(r.readOnly=!1,"NEVYPLŇOVAT"===r.value&&(r.value="")),t.onchange=function(){"Prováděcí"===t.value?(r.value="NEVYPLŇOVAT",r.readOnly=!0):("NEVYPLŇOVAT"===r.value&&(r.value=""),r.readOnly=!1)};var l=function(e){!function(e){if(e){var t=e.value,n=e.selectionStart,r=t.replace(/%/g,"").replace(/[^0-9\-]/g,"");if(""!==r&&"-"!==r&&"+"!==r){var a=Math.abs(parseInt(r,10));if(Number.isNaN(a))e.value="";else{for(var o=String(a).replace(/\B(?=(\d{3})+(?!\d))/g," "),l=0,i=0;i<n;i++)/[0-9]/.test(t[i])&&l++;for(var s=0,c=0;s<o.length&&c<l;)/[0-9]/.test(o[s])&&c++,s++;e.value=o;try{e.setSelectionRange(s,s)}catch(e){}}}else e.value=r}}(n)};n.removeEventListener("input",l),n.addEventListener("input",l),e.style.display="flex"}else le("Dialog hladiny významnosti není dostupný.")}function se(){try{var e=document.getElementById("significance-type"),t=document.getElementById("significance-value"),n=document.getElementById("significance-justification");if(!e||!t||!n)return;var r=e.value||"",a=t.value?t.value.trim():"",o=n.value?n.value.trim():"";if(!r)return void le("Prosím vyberte typ významnosti.");if("Prováděcí"!==r&&!o)return void le('Pokud není zvoleno "Prováděcí", je potřeba zadat zdůvodnění.');var l=null;if(a){var i=(a=a.replace(/%/g,"")).replace(/[^0-9\-]/g,"");""!==i&&"-"!==i&&"+"!==i&&(l=parseInt(i,10),l=Number.isNaN(l)?null:Math.abs(l))}if(null===l)return void le("Prosím zadejte hodnotu hladiny významnosti jako celé číslo.");"Prováděcí"===r&&(o="NEVYPLŇOVAT");var s={type:r,rawValue:l,justification:o};localStorage.setItem("significanceConfig",JSON.stringify(s));var c=document.getElementById("significance-type-display"),u=document.getElementById("significance-value-display"),d=document.getElementById("significance-justification-display");c&&(c.value=r),u&&(u.value=ue(l)),d&&(d.value=o);var v=document.getElementById("significance-modal");v&&(v.style.display="none"),le("Hladina významnosti uložena.")}catch(e){console.error("Chyba při ukládání hladiny významnosti:",e),le("Nelze uložit hladinu významnosti.")}}function ce(){try{localStorage.removeItem("significanceConfig");var e=document.getElementById("significance-type-display"),t=document.getElementById("significance-value-display"),n=document.getElementById("significance-justification-display");e&&(e.value="",e.placeholder="Typ významnosti"),t&&(t.value="",t.placeholder="Hodnota (bez deset.)"),n&&(n.value="",n.placeholder="Zdůvodnění / stav");var r=document.getElementById("significance-modal");r&&(r.style.display="none"),le("Hladina významnosti byla resetována.")}catch(e){console.error("Chyba při resetování hladiny významnosti:",e),le("Nelze resetovat hladinu významnosti.")}}function ue(e){return null==e?"":String(Math.round(e)).replace(/\B(?=(\d{3})+(?!\d))/g," ")}function de(){return ve.apply(this,arguments)}function ve(){return ve=l(t().m(function e(){var n,r,a,o,i;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null,e.p=1,r=document.getElementById("data-range").value,a=document.getElementById("value-column").value,n=document.getElementById("task5-result-display"),r&&a){e.n=2;break}return le("Prosím nejprve vyberte oblast dat a sloupec (úloha 4)."),n&&(n.value=""),e.a(2);case 2:return e.n=3,Excel.run(function(){var e=l(t().m(function e(o){var l,i,s,c,d,v,m,f,p,k,g,h,b,I,E,w;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=o.workbook.worksheets.getActiveWorksheet(),-1!==(i=r).indexOf("!")&&(i=i.split("!").pop()),i=i.replace(/\$/g,"").trim(),(s=l.getRange(i)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,o.sync();case 1:if(c=J(String(a).toUpperCase()),d="number"==typeof s.columnIndex?s.columnIndex:0,!((v=c-d)<0||v>=s.columnCount)){e.n=2;break}return le("Zadaný sloupec není v rámci vybraného rozsahu dat."),n&&(n.value=""),e.a(2);case 2:m=0,f=0,p=!1,k=!1,e.p=3,h=u(F(o,l,s));case 4:return e.n=5,h.next();case 5:if(!(p=!(b=e.v).done)){e.n=7;break}I=b.value.values,f++,le("Zpracovává se dávka ".concat(f,"...")),m+=q(I,v);case 6:p=!1,e.n=4;break;case 7:e.n=9;break;case 8:e.p=8,w=e.v,k=!0,g=w;case 9:if(e.p=9,e.p=10,!p||null==h.return){e.n=11;break}return e.n=11,h.return();case 11:if(e.p=11,!k){e.n=12;break}throw g;case 12:return e.f(11);case 13:return e.f(9);case 14:E=Math.ceil(m),n&&(n.value=ue(E)),y=E;try{X(y)}catch(e){}le("Suma byla spočítána.");case 15:return e.a(2)}},e,null,[[10,,11,13],[3,8,9,14]])}));return function(t){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,i=e.v,console.error("Chyba při výpočtu Task5 sumy:",i&&i.stack?i.stack:i),o=i&&i.message?i.message:String(i),n&&(n.value=""),le("Chyba při výpočtu sumy: "+o);case 5:return e.a(2)}},e,null,[[1,4]])})),ve.apply(this,arguments)}function me(){try{var e=document.getElementById("task5-size-display"),t=null,n=document.getElementById("reliability-factor");if(n&&n.value){var r=Q(n.value);null!==r&&(t=r)}if(null===t||Number.isNaN(t)){var a=V(v);"number"!=typeof a||Number.isNaN(a)||(t=a)}var o=null;try{var l=localStorage.getItem("significanceConfig");if(l){var i=JSON.parse(l);if(i&&"number"==typeof i.rawValue)o=i.rawValue;else if(i&&i.rawValue){var s=Q(i.rawValue);null!==s&&(o=s)}}}catch(e){}var c=y;if(null==c&&document.getElementById("task5-result-display")){var u=Q(document.getElementById("task5-result-display").value);null!==u&&(c=u)}if(null===t||null===o||null===c||0===o)return e&&(e.value=""),void le("Pro výpočet velikosti vzorku musí být nastaven faktor, významnost a spočítaná suma.");var d=t*c/o,m=Math.ceil(d);e&&(e.value=String(m)),le("Velikost vzorku byla spočítána.")}catch(e){console.error("Chyba při výpočtu velikosti vzorku:",e&&e.stack?e.stack:e);var f=e&&e.message?e.message:String(e),p=document.getElementById("task5-size-display");p&&(p.value=""),le("Chyba při výpočtu velikosti vzorku: "+f)}}function ye(e){try{var t=document.getElementById("task5-use-calculated"),n=document.getElementById("task5-override-area"),r=document.getElementById("task5-override-size"),a=document.getElementById("task5-override-reason");if(!t||!n)return;"no"===t.value?(n.style.display="flex",n.style.flexDirection="column"):(n.style.display="none",r&&(r.value=""),a&&(a.value=""))}catch(e){console.error("Error handling Task5 use choice:",e)}}function fe(){try{var e=document.getElementById("task5-use-calculated"),t=document.getElementById("task5-override-size"),n=document.getElementById("task5-override-reason"),r=document.getElementById("task5-confirm-info");if(!e)return void le("Vyberte prosím, zda chcete použít vypočtenou velikost.");if("yes"===e.value){var a=document.getElementById("task5-size-display");if(!a||!a.value)return void le("Neexistuje vypočtená hodnota. Nejprve spočítejte velikost.");var o=Q(a.value);if(null===o)return void le("Nelze načíst vypočtenou velikost z pole.");var l=Math.ceil(o);f=l,r&&(r.textContent="");var i=document.getElementById("task6-final-size-display");i&&(i.value=String(f));var s=document.getElementById("task6-method-display"),c=document.getElementById("sampling-method");return s&&c&&(s.value=c.options[c.selectedIndex].text),le("Velikost vzorku potvrzena (použito vypočtené)."),void(a&&(a.value=String(f)))}if("no"===e.value){if(!t||!t.value)return void le("Zadejte prosím požadovanou velikost.");var u=Q(t.value);if(null===u||u<=0)return void le("Žádaná velikost musí být kladné číslo.");var d=Math.ceil(u);f=d,n&&n.value,r&&(r.textContent="");var v=document.getElementById("task6-final-size-display");return v&&(v.value=String(f)),void le("Žádaná velikost byla potvrzena a aplikována pouze do Úkolu 6.")}le("Vyberte prosím možnost Ano nebo Ne.")}catch(e){console.error("Chyba při potvrzení požadované velikosti:",e),le("Chyba při potvrzení velikosti.")}}function pe(e){var t=document.getElementById(e);if(t){if("SELECT"===t.tagName)try{return t.options[t.selectedIndex].text}catch(e){return""}return t.value||""}return""}function ke(e){var t=document.getElementById(e);return t?t.value:""}function ge(e){var t=[];for(var n in t.push(["Parametry vzorkovače",""]),e)if(Object.hasOwnProperty.call(e,n)){var r=e[n];t.push([n,null==r?"":r])}return t}function he(e,t){return be.apply(this,arguments)}function be(){return be=l(t().m(function e(n,r){var a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(t().m(function e(a){var o,l,i,s,c,u,d,v,m,y;return t().w(function(e){for(;;)switch(e.n){case 0:if(o=ge(n),"new-sheet"!==r){e.n=1;break}(l=a.workbook.worksheets.add("ParametryVzorku")).activate(),l.getRange("A1").worksheet.getRangeByIndexes(0,0,o.length,2).values=o,e.n=5;break;case 1:if("above"!==r){e.n=5;break}if(i=document.getElementById("data-range").value){e.n=2;break}return le("Oblast dat není vybrána. Parametry budou vloženy na nový list."),(s=a.workbook.worksheets.add()).activate(),s.getRange("A1").worksheet.getRangeByIndexes(0,0,o.length,2).values=o,e.a(2);case 2:return-1!==(c=i).indexOf("!")&&(c=c.split("!").pop()),c=c.replace(/\$/g,"").trim(),(u=a.workbook.worksheets.getActiveWorksheet().getRange(c)).load(["rowIndex"]),e.n=3,a.sync();case 3:return d=u.rowIndex,v=a.workbook.worksheets.getActiveWorksheet(),(m=v.getUsedRange()).load("columnCount"),e.n=4,a.sync();case 4:y=m.columnCount,v.getRangeByIndexes(d,0,o.length,y).insert(Excel.InsertShiftDirection.down),v.getRangeByIndexes(d,0,o.length,2).values=o;case 5:return e.n=6,a.sync();case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error("Chyba při tisku parametrů:",a),le("Chyba při tisku parametrů.");case 3:return e.a(2)}},e,null,[[0,2]])})),be.apply(this,arguments)}function Ie(){var e={};e["Kontrolní riziko"]=v.controlRisk||"",e["Přirozené riziko"]=v.inherentRisk||"",e["Hladina RMM"]=v.rmmLevel||"",e["Provádím analytické testy?"]=v.analyticalTests||"",e["Provádím testy kontrol?"]=v.controlTests||"",e["Faktor spolehlivosti (výsledný)"]=pe("reliability-factor"),e["Typ významnosti"]=pe("significance-type-display"),e["Hodnota významnosti"]=pe("significance-value-display"),e["Zdůvodnění významnosti"]=pe("significance-justification-display"),e["Oblast dat"]=pe("data-range"),e["Sloupec pro výběr"]=pe("value-column"),e["Celková suma absolutních hodnot"]=pe("task5-result-display"),e["Vypočtená velikost vzorku"]=pe("task5-size-display");var t=pe("task5-use-calculated");return e["Použít vypočtenou velikost"]=t,"Ne"===t&&(e["Uživatelská velikost vzorku"]=pe("task5-override-size"),e["Důvod uživatelské velikosti"]=pe("task5-override-reason")),e["Metoda výběru vzorku"]=pe("task6-method-display"),e["Finální velikost vzorku"]=pe("task6-final-size-display"),e["Vyloučit nadlimitní položky"]=pe("task6-exclude-over-significance"),e["Suma pro výpočet (po úpravě)"]=pe("task6-param-sum-display"),e["Počet položek nad významností"]=pe("task6-significant-count-display"),e["Seed pro generátor"]=pe("task6-seed"),e["Autor vzorku"]="Neznámý uživatel",e["Datum a čas vyhotovení"]=(new Date).toLocaleString(),e}Office.onReady(function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var t=document.getElementById("set-reliability");t&&(t.onclick=g);var n=document.getElementById("reset-sampler");n&&(n.onclick=b);var r=document.getElementById("select-range");r&&(r.onclick=j);var a=document.getElementById("select-column");a&&(a.onclick=M);var o=document.getElementById("task5-compute-sum");o&&(o.onclick=de);var l=document.getElementById("task5-calc-size");l&&(l.onclick=me);var i=document.getElementById("task5-use-calculated");i&&(i.onchange=ye);var s=document.getElementById("task5-confirm-size");s&&(s.onclick=fe);var c=document.getElementById("sampling-method");c&&(c.onchange=function(){var e=document.getElementById("task6-method-display");e&&(e.value=c.options[c.selectedIndex].text)});try{var u=document.getElementById("task6-method-display"),d=document.getElementById("sampling-method");u&&d&&(u.value=d.options[d.selectedIndex].text)}catch(e){}var f=document.getElementById("task6-exclude-over-significance");f&&(f.onchange=function(e){try{!function(e){try{localStorage.setItem("task6ExcludeOverSignificance",String(e))}catch(e){console.warn("Nelze uložiť volbu Task6 do storage:",e&&e.message?e.message:e)}}(f.value)}catch(e){console.warn("Nelze uložit volbu v Task6:",e)}});try{!function(){try{var e=localStorage.getItem("task6ExcludeOverSignificance"),t=document.getElementById("task6-exclude-over-significance");if(!t)return;if(!e)return void(t.value="");t.value=e}catch(e){console.warn("Nelze načíst volbu Task6 z storage:",e&&e.message?e.message:e)}}()}catch(e){}try{!function(){try{var e=localStorage.getItem("task6PrintTarget"),t=document.getElementById("task6-print-target");if(!t)return;t.value=e||""}catch(e){console.warn("Nelze načíst tisk target:",e)}}()}catch(e){}var k=document.getElementById("task6-compute-adjusted-sum");k&&(k.onclick=R);var h=document.getElementById("task6-print-target");h&&(h.onchange=function(){try{!function(e){try{localStorage.setItem("task6PrintTarget",String(e))}catch(e){console.warn("Nelze uložit tisk target:",e)}}(h.value)}catch(e){console.warn(e)}});var E=document.getElementById("task6-generate-sample");E&&(E.onclick=I);var N=document.getElementById("task6-generate-parameters");N&&(N.onclick=w);var z=document.getElementById("task6-seed");z&&(z.onchange=function(){try{ee(z.value)}catch(e){console.warn(e)}});try{!function(){try{var e=localStorage.getItem("task6Seed"),t=document.getElementById("task6-seed");e&&t&&(t.value=e,p=e)}catch(e){console.warn("Nelze načíst seed:",e)}}()}catch(e){}var B=document.getElementById("task6-generate-seed"),T=document.getElementById("task6-regenerate-seed");B&&(B.onclick=function(){var e=ne();try{document.getElementById("task6-seed").value=e,ee(e),le("Seed vygenerován.")}catch(e){console.warn(e)}}),T&&(T.onclick=function(){var e=ne();try{document.getElementById("task6-seed").value=e,ee(e),le("Seed znovu vygenerován.")}catch(e){console.warn(e)}});var S=document.getElementById("fill-significance");S&&(S.onclick=ie);var x=document.getElementById("significance-save-btn"),O=document.getElementById("significance-cancel-btn"),U=document.getElementById("significance-reset-btn");x&&(x.onclick=se),O&&(O.onclick=function(){var e=document.getElementById("significance-modal");e&&(e.style.display="none")}),U&&(U.onclick=ce),function(){try{var e=localStorage.getItem("reliabilityConfig");if(!e)return;var t=JSON.parse(e);if(!t)return;v.controlRisk=t.controlRisk||v.controlRisk,v.inherentRisk=t.inherentRisk||v.inherentRisk,v.rmmLevel=t.rmmLevel||v.rmmLevel,v.analyticalTests=t.analyticalTests||v.analyticalTests,v.controlTests=t.controlTests||v.controlTests,m=!0;var n=V(v),r=document.getElementById("reliability-factor");r&&(null!==n?(r.placeholder="",r.value=String(n),L(r,String(n))):P())}catch(e){console.warn("Nelze načíst nastavení z localStorage:",e.message)}}(),P(),function(){try{var e=localStorage.getItem("significanceConfig"),t=null;try{t=e?JSON.parse(e):null}catch(e){t=null}var n=document.getElementById("significance-type-display"),r=document.getElementById("significance-value-display"),a=document.getElementById("significance-justification-display");t?(n&&(n.value=t.type||""),r&&(r.value=void 0!==t.rawValue&&null!==t.rawValue?ue(t.rawValue):""),a&&(a.value=t.justification||"")):(n&&(n.value="",n.placeholder="Typ významnosti"),r&&(r.value="",r.placeholder="Hodnota (bez deset.)"),a&&(a.value="",a.placeholder="Zdůvodnění / stav"))}catch(e){console.warn("Nelze načíst hladinu významnosti ze storage:",e.message)}}();try{!function(){try{var e=localStorage.getItem("TotalSumABS");if(!e)return;var t=JSON.parse(e);if(null!=t){y=t;var n=document.getElementById("task5-result-display");n&&(n.value=ue(Math.round(y)))}}catch(e){console.warn("Nelze načíst TotalSumABS:",e&&e.message?e.message:e)}}()}catch(e){}var D=document.getElementById("reliability-modal"),G=document.getElementById("modal-save-btn"),H=document.getElementById("modal-cancel-btn"),J=document.getElementById("modal-reset-btn");G&&(G.onclick=C),H&&(H.onclick=function(){D&&(D.style.display="none")}),J&&(J.onclick=A)}})}(),new URL(n(58394),n.b),new URL(n(3432),n.b)}();
//# sourceMappingURL=taskpane.js.map