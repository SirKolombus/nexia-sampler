/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={3432:function(e,n,t){e.exports=t.p+"assets/Head.png"},58394:function(e,n,t){e.exports=t.p+"9b5d5f4f1a617c087646.css"}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){var e=[{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"0.7"},{controlRisk:"Nízké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"1.1"},{controlRisk:"Nízké",inherentRisk:"Střední",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"0.7"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"1.6"},{controlRisk:"Nízké",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"0.7"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"1.4"},{controlRisk:"Střední",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"1.1"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"1.8"},{controlRisk:"Střední",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"1.4"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"2.3"},{controlRisk:"Střední",inherentRisk:"Vysoké",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ano",controlTests:"Ne",factor:"1.1"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Nízké",rmmLevel:"Nízké",analyticalTests:"Ne",controlTests:"Ne",factor:"1.9"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ano",controlTests:"Ne",factor:"1.4"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Střední",rmmLevel:"Střední",analyticalTests:"Ne",controlTests:"Ne",factor:"2.3"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ano",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ano",controlTests:"Ne",factor:"1.9"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ne",controlTests:"Ano",factor:"Test kontrol Error"},{controlRisk:"Vysoké",inherentRisk:"Vysoké",rmmLevel:"Vysoké",analyticalTests:"Ne",controlTests:"Ne",factor:"3"}];function n(){var e,r,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function s(n,a,o,l){var s=a&&a.prototype instanceof i?a:i,u=Object.create(s.prototype);return t(u,"_invoke",function(n,t,a){var o,l,s,i=0,u=a||[],d=!1,v={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return o=n,l=0,s=e,v.n=t,c}};function m(n,t){for(l=n,s=t,r=0;!d&&i&&!a&&r<u.length;r++){var a,o=u[r],m=v.p,y=o[2];n>3?(a=y===t)&&(s=o[(l=o[4])?5:(l=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=n<2&&m<o[1])?(l=0,v.v=t,v.n=o[1]):m<y&&(a=n<3||o[0]>t||t>y)&&(o[4]=n,o[5]=t,v.n=y,l=0))}if(a||n>1)return c;throw d=!0,t}return function(a,u,y){if(i>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,y),l=u,s=y;(r=l<2?e:s)||!d;){o||(l?l<3?(l>1&&(v.n=-1),m(l,s)):v.n=s:v.v=s);try{if(i=2,o){if(l||(a="next"),r=o[a]){if(!(r=r.call(o,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,l<2&&(l=0)}else 1===l&&(r=o.return)&&r.call(o),l<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),l=1);o=e}else if((r=(d=v.n<0)?s:n.call(t,v))!==c)break}catch(n){o=e,l=1,s=n}finally{i=1}}return{value:r,done:d}}}(n,o,l),!0),u}var c={};function i(){}function u(){}function d(){}r=Object.getPrototypeOf;var v=[][o]?r(r([][o]())):(t(r={},o,function(){return this}),r),m=d.prototype=i.prototype=Object.create(v);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,t(m,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,l,"GeneratorFunction"),t(m),t(m,l,"Generator"),t(m,o,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:y}})()}function t(e,n,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}t=function(e,n,r,a){function l(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(l("next",0),l("throw",1),l("return",2))},t(e,n,r,a)}function r(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return a(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){c=!0,l=e},f:function(){try{s||null==t.return||t.return()}finally{if(c)throw l}}}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n,t,r,a,o,l){try{var s=e[o](l),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var l=e.apply(n,t);function s(e){o(l,r,a,s,c,"next",e)}function c(e){o(l,r,a,s,c,"throw",e)}s(void 0)})}}function s(e){return new i(e,0)}function c(e){var n,t;function r(n,t){try{var o=e[n](t),l=o.value,s=l instanceof i;Promise.resolve(s?l.v:l).then(function(t){if(s){var c="return"===n?"return":"next";if(!l.k||t.done)return r(c,t);t=e[c](t).value}a(o.done?"return":"normal",t)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":n.resolve({value:a,done:!0});break;case"throw":n.reject(a);break;default:n.resolve({value:a,done:!1})}(n=n.next)?r(n.key,n.arg):t=null}this._invoke=function(e,a){return new Promise(function(o,l){var s={key:e,arg:a,resolve:o,reject:l,next:null};t?t=t.next=s:(n=t=s,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function i(e,n){this.v=e,this.k=n}function u(e){var n,t,r,a=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(t&&null!=(n=e[t]))return n.call(e);if(r&&null!=(n=e[r]))return new d(n.call(e));t="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function d(e){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var n=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:n}})}return d=function(e){this.s=e,this.n=e.next},d.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):n(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):n(t.apply(this.s,arguments))}},new d(e)}c.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},c.prototype.next=function(e){return this._invoke("next",e)},c.prototype.throw=function(e){return this._invoke("throw",e)},c.prototype.return=function(e){return this._invoke("return",e)};var v={confidence:95,expectedError:5,populationSize:1e3},m=!1,y=null,f=null,k=null,p=2e3;function g(){return h.apply(this,arguments)}function h(){return(h=l(n().m(function e(){var t,r,a,o,l,s;return n().w(function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("reliability-modal")){e.n=1;break}return ce("Dialog není dostupný."),e.a(2);case 1:r=document.getElementById("reliability-control-risk"),a=document.getElementById("reliability-inherent-risk"),o=document.getElementById("reliability-rmm-level"),l=document.getElementById("reliability-analytical-tests"),s=document.getElementById("reliability-control-tests"),r&&v.controlRisk&&(r.value=v.controlRisk),r&&(r.value=v.controlRisk||""),a&&(a.value=v.inherentRisk||""),o&&(o.value=v.rmmLevel||""),l&&(l.value=v.analyticalTests||""),s&&(s.value=v.controlTests||""),t.style.display="flex";case 2:return e.a(2)}},e)}))).apply(this,arguments)}function b(){try{["reliability-factor","significance-type-display","significance-value-display","significance-justification-display","sampling-method","data-range","value-column","task5-result-display","task5-size-display","task5-use-calculated","task5-override-size","task5-override-reason","task5-confirm-info","task6-method-display","task6-final-size-display","task6-exclude-over-significance","task6-param-sum-display","task6-significant-count-display","task6-print-target","task6-seed"].forEach(function(e){try{var n=document.getElementById(e);if(!n)return;n.tagName,n.value=""}catch(e){}});var e=document.getElementById("task5-override-area");e&&(e.style.display="none");var n=document.getElementById("task6-count-area");n&&(n.style.display="none");var t=document.getElementById("results");t&&(t.style.display="none"),["reliabilityConfig","significanceConfig","TotalSumABS","task6ExcludeOverSignificance","task6PrintTarget","task6Seed"].forEach(function(e){try{localStorage.removeItem(e)}catch(e){}}),v={confidence:95,expectedError:5,populationSize:1e3},m=!1,y=null,f=null;try{var r=document.getElementById("sampling-method");r&&(r.value="");var a=document.getElementById("task6-method-display");a&&(a.value="<Vyberte>")}catch(e){}P(),ce("Vzorkovač byl restartován.")}catch(e){console.error("Chyba při resetu vzorkovače:",e),ce("Chyba při restartu vzorkovače.")}}function I(){return w.apply(this,arguments)}function w(){return(w=l(n().m(function e(){var t,r,a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=1,t=document.getElementById("sampling-method"),"monetary-random-walk"!==(r=t?t.value:null)){e.n=3;break}return e.n=2,T();case 2:e.v,e.n=7;break;case 3:if("random-number-generator"!==r){e.n=5;break}return e.n=4,N();case 4:e.v,e.n=7;break;case 5:return e.n=6,U();case 6:case 7:e.n=9;break;case 8:e.p=8,a=e.v,console.error("Chyba při spuštění generování vzorku z Task6:",a),ce("Chyba při generování vzorku.");case 9:return e.a(2)}},e,null,[[1,8]])}))).apply(this,arguments)}function E(){return z.apply(this,arguments)}function z(){return(z=l(n().m(function e(){var t,r,a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(t=he("task6-print-target"))||""===t){e.n=2;break}return r=Ee(),e.n=1,Ie(r,t);case 1:ce("Parametry byly vygenerovány."),e.n=3;break;case 2:ce("Vyberte prosím cíl pro tisk parametrů.");case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.error("Chyba při generování parametrů:",a),ce("Chyba při generování parametrů.");case 5:return e.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function N(){return S.apply(this,arguments)}function S(){return S=l(n().m(function e(){var t,r,a,o,s,c,i,d,v,m,y;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("data-range")&&document.getElementById("data-range").value,r=document.getElementById("value-column")&&document.getElementById("value-column").value,t&&r){e.n=1;break}return ce("Nejdříve vyberte oblast dat a sloupec (úloha 4)."),e.a(2,!1);case 1:a=document.getElementById("task6-exclude-over-significance"),o=a&&"yes"===a.value,s=null;try{(c=localStorage.getItem("significanceConfig"))&&(i=JSON.parse(c))&&void 0!==i.rawValue&&null!==i.rawValue&&(s=Number(i.rawValue))}catch(e){}if(!o||null!==s&&!Number.isNaN(s)){e.n=2;break}return ce("Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3)."),e.a(2,!1);case 2:if((d=f||null)||(v=document.getElementById("task5-size-display"))&&v.value&&null!==(m=ee(v.value))&&(d=Math.ceil(m)),d&&!(d<=0)){e.n=3;break}return ce("Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5."),e.a(2,!1);case 3:return e.n=4,Excel.run(function(){var e=l(n().m(function e(a){var l,c,i,v,m,y,f,g,h,b,I,w,E,z,N,S,T,B,x,R,A,V,C,P,L,j,O,M,Z,D,U,G,J,$,_,Y,K,q,Q,X,ne;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=a.workbook.worksheets.getActiveWorksheet(),-1!==(c=t).indexOf("!")&&(c=c.split("!").pop()),c=c.replace(/\$/g,"").trim(),(i=l.getRange(c)).load(["values","rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,a.sync();case 1:if(v=i.values,m=F(String(r).toUpperCase()),y="number"==typeof i.columnIndex?i.columnIndex:0,f=m-y,g=i.rowCount||(v?v.length:0),!(!Array.isArray(v)||v.length<=1||f<0||f>=(v[0]?v[0].length:0))){e.n=2;break}return ce("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2,!1);case 2:if(0!==(h=Math.max(0,g-1))){e.n=3;break}return ce("Datová oblast neobsahuje žádné řádky."),e.a(2,!1);case 3:if(b=h/d,isFinite(b)&&!(b<=0)){e.n=4;break}return ce("Neplatný krok (krok <= 0)."),e.a(2,!1);case 4:for(I=re(),w=("function"==typeof I?I():Math.random())*b,E=new Array(h).fill(0),z=0;z<d;z++)(N=(w+z*b)%h)<0&&(N+=h),S=Math.floor(N),E[S]=(E[S]||0)+1;T=i.columnIndex+i.columnCount,(B=l.getRangeByIndexes(i.rowIndex,T,1,2)).values=[["Pořadí","Výběr"]],B.format.font.bold=!0,x=W(a,l,i,p),R=!1,A=!1,e.p=5,C=u(x);case 6:return e.n=7,C.next();case 7:if(!(R=!(P=e.v).done)){e.n=9;break}for(L=P.value,j=L.values,O=L.startRow,M=O===i.rowIndex,Z=[],D=M?1:0;D<j.length;D++)U=O-i.rowIndex+D,G=U,J=j[D][f],$=ee(J),_=null===$?0:Math.abs($),Y=U-1,K="Ne",o&&null!==s&&_>s?K="Ano - významnost":E[Y]&&E[Y]>0&&(q=E[Y],K=1===q?"Ano - NGČ":"Ano - NGČ (x".concat(q,")")),Z.push([G,K]);return Q=i.rowIndex+(M?1:O-i.rowIndex),e.n=8,H(a,l,Q,T,Z,p);case 8:R=!1,e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,ne=e.v,A=!0,V=ne;case 11:if(e.p=11,e.p=12,!R||null==C.return){e.n=13;break}return e.n=13,C.return();case 13:if(e.p=13,!A){e.n=14;break}throw V;case 14:return e.f(13);case 15:return e.f(11);case 16:return e.n=17,a.sync();case 17:ce("Generování (NGČ) dokončeno. Výsledky jsou vloženy do listu."+((X=k||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value||"")?" Použit seed: ".concat(X):""));case 18:return e.a(2)}},e,null,[[12,,13,15],[5,10,11,16]])}));return function(n){return e.apply(this,arguments)}}());case 4:return e.a(2,!0);case 5:return e.p=5,y=e.v,console.error("Chyba v generateRandomNumberGeneratorTask6:",y),ce("Chyba při generování NGČ: "+(y&&y.message?y.message:"")),e.a(2,!1)}},e,null,[[0,5]])})),S.apply(this,arguments)}function T(){return B.apply(this,arguments)}function B(){return B=l(n().m(function e(){var t,r,a,o,s,c,i,u,d,v,m,p,g,h;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("data-range")&&document.getElementById("data-range").value,r=document.getElementById("value-column")&&document.getElementById("value-column").value,t&&r){e.n=1;break}return ce("Nejdříve vyberte oblast dat a sloupec (úloha 4)."),e.a(2,!1);case 1:a=document.getElementById("task6-exclude-over-significance"),o=a&&"yes"===a.value,s=null;try{(c=localStorage.getItem("significanceConfig"))&&(i=JSON.parse(c))&&void 0!==i.rawValue&&null!==i.rawValue&&(s=Number(i.rawValue))}catch(e){}if(!o||null!==s&&!Number.isNaN(s)){e.n=2;break}return ce("Není nastavena významnost, přepněte nebo uložte hladinu významnosti (úloha 3)."),e.a(2,!1);case 2:if((u=f||null)||(d=document.getElementById("task5-size-display"))&&d.value&&null!==(v=ee(d.value))&&(u=Math.ceil(v)),u&&!(u<=0)){e.n=3;break}return ce("Neexistuje validní velikost vzorku. Nejprve ji potvrďte v úloze 5."),e.a(2,!1);case 3:m=null;try{(p=document.getElementById("task6-param-sum-display"))&&p.value&&null!==(g=ee(p.value))&&(m=g)}catch(e){}return null===m&&(m=y),e.n=4,Excel.run(function(){var e=l(n().m(function e(a){var l,c,i,d,v,y,f,p,g,h,b,I,w,E,z,N,S,T,B,x,R,A,V,C,P,L,j,O,M,Z,D,U,G,H,J,W,$,_;return n().w(function(e){for(;;)switch(e.n){case 0:return l=a.workbook.worksheets.getActiveWorksheet(),-1!==(c=t).indexOf("!")&&(c=c.split("!").pop()),c=c.replace(/\$/g,"").trim(),(i=l.getRange(c)).load(["values","rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,a.sync();case 1:if(d=i.values,v=F(String(r).toUpperCase()),y="number"==typeof i.columnIndex?i.columnIndex:0,f=v-y,p=i.rowCount||(d?d.length:0),!(!Array.isArray(d)||d.length<=1||f<0||f>=(d[0]?d[0].length:0))){e.n=2;break}return ce("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2,!1);case 2:if((null===m||Number.isNaN(m))&&(m=X(d,f)),!(!m||Number.isNaN(m)||m<=0)){e.n=3;break}return ce("TotalSum je nula nebo neplatná."),e.a(2,!1);case 3:if(g=m/u,isFinite(g)&&!(g<=0)){e.n=4;break}return ce("Neplatný krok (krok <= 0)."),e.a(2,!1);case 4:for(h=re(),b=("function"==typeof h?h():Math.random())*g,I=new Array(u),w=0;w<u;w++)I[w]=b+w*g;for(E=0,(z=new Array(p))[0]=["ABS","Kumulace ABS","Index/krok","Výběr","Důvod"],N=new Array(p),S=new Array(p),T=new Array(p),B=new Array(p),x=0;x<p;x++)T[x]="Ne",B[x]="";for(R=1;R<p;R++)A=d[R][f],V=ee(A),C=null===V?0:Math.abs(V),N[R]=C,P=C,o&&null!==s&&C>s&&(P=0,T[R]="Ano - významnost",B[R]="přesah významnosti"),S[R]=P;for(L=0,j=1;j<p;j++)O=N[j]||0,M=S[j]||0,D=(Z=1===j?b:L)+M,U=Math.floor(Z/g),G=Math.floor(D/g),(H=Math.max(0,G-U))>0&&E+H>I.length&&(H=Math.max(0,I.length-E)),H>0&&(E+=H,"Ano - významnost"===T[j]?(T[j]="Ano - významnost; Ano - NPP",B[j]=B[j]?B[j]+"; NPP":"NPP"):(T[j]=1===H?"Ano - NPP":"Ano - NPP (x".concat(H,")"),B[j]="NPP")),J=(L=D)/g,z[j]=[O,L,J,T[j],B[j]];return W=p,$=i.columnIndex+i.columnCount,l.getRangeByIndexes(i.rowIndex,$,W,5).values=z,l.getRangeByIndexes(i.rowIndex,$,1,5).format.font.bold=!0,e.n=5,a.sync();case 5:ce("Generování dokončeno. Výsledky jsou vloženy do listu."+((_=k||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value||"")?" Použit seed: ".concat(_):""));case 6:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 4:return e.a(2,!0);case 5:return e.p=5,h=e.v,console.error("Chyba v generateMonetaryRandomWalkTask6:",h),ce("Chyba při generování mon. random walk: "+(h&&h.message?h.message:"")),e.a(2,!1)}},e,null,[[0,5]])})),B.apply(this,arguments)}function x(){return R.apply(this,arguments)}function R(){return R=l(n().m(function e(){var t,r,a,o,s,c,i,d,v,m,f;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("data-range").value,r=document.getElementById("value-column").value,a=document.getElementById("task6-param-sum-display"),o=document.getElementById("task6-count-area"),s=document.getElementById("task6-significant-count-display"),t&&r){e.n=1;break}return ce("Prosím nejprve vyberte oblast dat a sloupec (úloha 4)."),a&&(a.value=""),o&&(o.style.display="none"),e.a(2);case 1:c=document.getElementById("task6-exclude-over-significance"),i=c&&"yes"===c.value,d=null;try{(v=localStorage.getItem("significanceConfig"))&&(m=JSON.parse(v))&&void 0!==m.rawValue&&null!==m.rawValue&&(d=Number(m.rawValue))}catch(e){}return e.n=2,Excel.run(function(){var e=l(n().m(function e(l){var c,v,m,f,k,p,g,h,b,I,w,E,z,N,S,T,B,x,R,A,V;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return c=l.workbook.worksheets.getActiveWorksheet(),-1!==(v=t).indexOf("!")&&(v=v.split("!").pop()),v=v.replace(/\$/g,"").trim(),(m=c.getRange(v)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,l.sync();case 1:if(f=F(String(r).toUpperCase()),k="number"==typeof m.columnIndex?m.columnIndex:0,!((p=f-k)<0||p>=m.columnCount)){e.n=2;break}return ce("Zadaný sloupec není v rámci vybraného rozsahu dat."),a&&(a.value=""),o&&(o.style.display="none"),e.a(2);case 2:g=0,h=0,b=0,I=!1,w=!1,e.p=3,z=u(W(l,c,m));case 4:return e.n=5,z.next();case 5:if(!(I=!(N=e.v).done)){e.n=10;break}S=N.value.values,b++,ce("Zpracovává se dávka ".concat(b,"...")),T=1;case 6:if(!(T<S.length)){e.n=9;break}if(B=S[T][p],null!==(x=ee(B))){e.n=7;break}return e.a(3,8);case 7:R=Math.abs(x),i&&null!==d&&!Number.isNaN(d)?R<=d?g+=R:h+=1:g+=R;case 8:T++,e.n=6;break;case 9:I=!1,e.n=4;break;case 10:e.n=12;break;case 11:e.p=11,V=e.v,w=!0,E=V;case 12:if(e.p=12,e.p=13,!I||null==z.return){e.n=14;break}return e.n=14,z.return();case 14:if(e.p=14,!w){e.n=15;break}throw E;case 15:return e.f(14);case 16:return e.f(12);case 17:i?(a&&(a.value=ve(Math.ceil(g))),o&&(o.style.display="flex"),s&&(s.value=String(h))):(A=null!=y?y:Math.ceil(g),a&&(a.value=ve(Math.round(A))),o&&(o.style.display="none")),ce("Upravená suma spočítána.");case 18:return e.a(2)}},e,null,[[13,,14,16],[3,11,12,17]])}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,f=e.v,console.error("Chyba při výpočtu upravené sumy:",f),ce("Chyba při výpočtu upravené sumy.");case 4:return e.a(2)}},e,null,[[0,3]])})),R.apply(this,arguments)}function A(){try{localStorage.removeItem("reliabilityConfig"),delete v.controlRisk,delete v.inherentRisk,delete v.analyticalTests,delete v.controlTests,m=!1;var e=document.getElementById("reliability-control-risk"),n=document.getElementById("reliability-inherent-risk"),t=document.getElementById("reliability-analytical-tests"),r=document.getElementById("reliability-control-tests");e&&(e.value=""),n&&(n.value=""),t&&(t.value=""),r&&(r.value=""),P();var a=document.getElementById("reliability-modal");a&&(a.style.display="none"),ce("Nastavení bylo resetováno.")}catch(e){console.error("Chyba při resetování:",e),ce("Nepodařilo se resetovat nastavení.")}}function V(){try{var e=document.getElementById("reliability-modal"),n=document.getElementById("reliability-control-risk"),t=document.getElementById("reliability-inherent-risk"),r=document.getElementById("reliability-analytical-tests"),a=document.getElementById("reliability-control-tests"),o=n&&n.value?n.value:v.controlRisk,l=t&&t.value?t.value:v.inherentRisk,s=r&&r.value?r.value:v.analyticalTests,c=a&&a.value?a.value:v.controlTests,i=document.getElementById("reliability-rmm-level")&&document.getElementById("reliability-rmm-level").value?document.getElementById("reliability-rmm-level").value:v.rmmLevel;if(!(o&&l&&i&&s&&c))return void ce("Po uložení musí být vyplněna všechna pole (nebo zvolena dříve). Vyplňte chybějící položky.");v.controlRisk=o,v.inherentRisk=l,v.analyticalTests=s,v.controlTests=c,v.rmmLevel=i,m=!0,function(){try{var e={controlRisk:v.controlRisk,inherentRisk:v.inherentRisk,analyticalTests:v.analyticalTests,controlTests:v.controlTests,rmmLevel:v.rmmLevel};localStorage.setItem("reliabilityConfig",JSON.stringify(e))}catch(e){console.warn("Nelze uložit nastavení do localStorage:",e.message)}}(),P();var u=C(v),d=document.getElementById("reliability-factor");d&&(null!==u?(d.placeholder="",d.value=String(u),L(d,String(u))):(d.value="",d.placeholder="<Nevyplněno>",L(d,null))),e&&(e.style.display="none")}catch(e){console.error("Chyba při ukládání nastavení spolehlivosti:",e),ce("Došlo k neočekávané chybě při ukládání.")}}function C(n){if(!n||!n.controlRisk)return null;var t,a=r(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.controlRisk===n.controlRisk&&o.inherentRisk===n.inherentRisk&&o.rmmLevel===n.rmmLevel&&o.analyticalTests===n.analyticalTests&&o.controlTests===n.controlTests)return o.factor}}catch(e){a.e(e)}finally{a.f()}return null}function P(){var e=document.getElementById("reliability-factor");if(!m)return e.value="",e.placeholder="<Nevyplněno>",e.style.color="",void(e.style.fontWeight="");var n=v.controlRisk||"-",t=v.inherentRisk||"-",r=v.rmmLevel||"-",a=v.analyticalTests||"-",o=v.controlTests||"-",l="Kontrolní riziko: ".concat(n,", Přirozené riziko: ").concat(t,", Hladina RMM: ").concat(r,", Analytické testy: ").concat(a,", Testy kontrol: ").concat(o);e.placeholder="",e.value=l,e.style.color="",e.style.fontWeight=""}function L(e,n){e&&("Test kontrol Error"===n?(e.style.color="red",e.style.fontWeight="700"):(e.style.color="",e.style.fontWeight=""))}function j(){return O.apply(this,arguments)}function O(){return O=l(n().m(function e(){var t;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(n().m(function e(t){var r;return n().w(function(e){for(;;)switch(e.n){case 0:return(r=t.workbook.getSelectedRange()).load("address"),e.n=1,t.sync();case 1:document.getElementById("data-range").value=r.address,console.log("Vybrán rozsah: ".concat(r.address));case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Chyba při výběru rozsahu:",t),ce("Chyba při výběru rozsahu. Ujistěte se, že máte vybraný rozsah v Excelu.");case 3:return e.a(2)}},e,null,[[0,2]])})),O.apply(this,arguments)}function M(){return Z.apply(this,arguments)}function Z(){return Z=l(n().m(function e(){var t;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(n().m(function e(t){var r,a,o;return n().w(function(e){for(;;)switch(e.n){case 0:return(r=t.workbook.getSelectedRange()).load(["columnIndex"]),e.n=1,t.sync();case 1:a=r.columnIndex,o=D(a),document.getElementById("value-column").value=o,console.log("Vybrán sloupec: ".concat(o));case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Chyba při výběru sloupce:",t),ce("Chyba při výběru sloupce. Ujistěte se, že máte vybranou buňku v Excelu.");case 3:return e.a(2)}},e,null,[[0,2]])})),Z.apply(this,arguments)}function D(e){for(var n="",t=e+1;t>0;){var r=(t-1)%26;n=String.fromCharCode(65+r)+n,t=Math.floor((t-1)/26)}return n}function U(){return G.apply(this,arguments)}function G(){return G=l(n().m(function e(){var t,r,a,o,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("sampling-method").value,r=document.getElementById("data-range").value,a=document.getElementById("value-column").value,r&&a){e.n=1;break}return ce("Prosím vyplňte všechna povinná pole."),e.a(2);case 1:return e.n=2,Excel.run(function(){var e=l(n().m(function e(o){var l,s,c,i,u,d,v,m;return n().w(function(e){for(;;)switch(e.n){case 0:return l=o.workbook.worksheets.getActiveWorksheet(),-1!==(s=r).indexOf("!")&&(s=s.split("!").pop()),s=s.replace(/\$/g,"").trim(),(c=l.getRange(s)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,o.sync();case 1:if(i=F(String(a).toUpperCase()),u="number"==typeof c.columnIndex?c.columnIndex:0,!((d=i-u)<0||d>=c.columnCount)){e.n=2;break}return ce("Zadaný sloupec není v rámci vybraného rozsahu dat."),e.a(2);case 2:if(!((v=c.rowCount-1)>2e5)){e.n=4;break}if(confirm("Varování: Dataset obsahuje ".concat(v.toLocaleString()," řádků. ")+"To je velmi velký dataset, který může způsobit problémy s pamětí. Doporučujeme rozdělit data na menší části. Pokračovat?")){e.n=3;break}return ce("Operace zrušena uživatelem."),e.a(2);case 3:e.n=5;break;case 4:v>5e4&&ce("Info: Dataset obsahuje ".concat(v.toLocaleString()," řádků. ")+"Zpracování může trvat déle. Prosím čekejte...");case 5:if(ce("Začíná zpracování ".concat(v.toLocaleString()," řádků...")),"monetary-random-walk"!==t){e.n=7;break}return e.n=6,_(o,l,c,d,v);case 6:m=e.v,e.n=9;break;case 7:return e.n=8,K(o,l,c,d,v);case 8:m=e.v;case 9:return oe(m,v+1),e.n=10,le(o,l,r,m);case 10:ce("Vzorkování dokončeno! Vybráno ".concat(m.length," vzorků z ").concat(v.toLocaleString()," řádků."));case 11:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.error("Chyba při generování vzorku:",s),o="Chyba při generování vzorku: ",s.message&&s.message.includes("memory")?o+="Nedostatek paměti. Zkuste rozdělit data na menší části.":s.message&&s.message.includes("timeout")?o+="Operace trvala příliš dlouho. Zkuste menší dataset.":o+=s&&s.message?s.message:"Neznámá chyba",ce(o,8e3);case 4:return e.a(2)}},e,null,[[0,3]])})),G.apply(this,arguments)}function F(e){if(!isNaN(e))return parseInt(e)-1;for(var n=0,t=0;t<e.length;t++)n=26*n+(e.charCodeAt(t)-"A".charCodeAt(0)+1);return n-1}function H(e,n,t,r,a){return J.apply(this,arguments)}function J(){return J=l(n().m(function e(t,r,a,o,l){var s,c,i,u,d=arguments;return n().w(function(e){for(;;)switch(e.n){case 0:s=d.length>5&&void 0!==d[5]?d[5]:p,c=0;case 1:if(!(c<l.length)){e.n=3;break}return i=l.slice(c,c+s),u=i.length,r.getRangeByIndexes(a+c,o,u,i[0].length).values=i,e.n=2,t.sync();case 2:c+=s,e.n=1;break;case 3:return e.a(2)}},e)})),J.apply(this,arguments)}function W(e,n,t){return $.apply(this,arguments)}function $(){var e;return e=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p;return n().m(function o(){var l,c,i,u,d,v,m,y;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:l=r.rowCount,c=r.rowIndex,i=r.columnIndex,u=r.columnCount,l>5e4&&ce("Upozornění: Zpracovává se ".concat(l.toLocaleString()," řádků. Prosím čekejte...")),d=0;case 1:if(!(d<l)){n.n=8;break}return v=Math.min(a,l-d),n.p=2,(m=t.getRangeByIndexes(c+d,i,v,u)).load("values"),n.n=3,s(e.sync());case 3:return n.n=4,{values:m.values,startRow:c+d};case 4:if(!(l>1e5&&d%(10*a)==0)){n.n=5;break}return ce("Zpracováno ".concat(Math.round(d/l*100),"% - ").concat((d+v).toLocaleString(),"/").concat(l.toLocaleString()," řádků...")),n.n=5,s(new Promise(function(e){return setTimeout(e,10)}));case 5:n.n=7;break;case 6:throw n.p=6,y=n.v,console.error("Chyba při čtení dávky na pozici ".concat(d,":"),y),new Error("Chyba při čtení dat na řádku ".concat(c+d,": ").concat(y.message));case 7:d+=a,n.n=1;break;case 8:return n.a(2)}},o,null,[[2,6]])})()},$=function(){return new c(e.apply(this,arguments))},$.apply(this,arguments)}function _(e,n,t,r,a){return Y.apply(this,arguments)}function Y(){return(Y=l(n().m(function e(t,r,a,o,l){var s,c,i,d,v,m,y,f,k,g,h,b,I,w,E,z,N,S,T,B,x,R,A,V,C,P,L,j,O,M,Z,D;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:ce("Počítá se celková suma..."),s=0,c=0,i=!1,d=!1,e.p=1,m=u(W(t,r,a,p));case 2:return e.n=3,m.next();case 3:if(!(i=!(y=e.v).done)){e.n=5;break}for(f=y.value.values,c++,ce("Počítá se suma - dávka ".concat(c,"...")),k=1===c?1:0;k<f.length;k++)g=f[k][o],h=ee(g),b=null!==h?h:0,s+=Math.abs(b);case 4:i=!1,e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,Z=e.v,d=!0,v=Z;case 7:if(e.p=7,e.p=8,!i||null==m.return){e.n=9;break}return e.n=9,m.return();case 9:if(e.p=9,!d){e.n=10;break}throw v;case 10:return e.f(9);case 11:return e.f(7);case 12:if((I=Q(s))&&!(I<1)){e.n=13;break}return ce("Vypočtená velikost vzorku je neplatná."),e.a(2,[]);case 13:w=s/I,E=[],z=0,N=re(),S=("function"==typeof N?N():Math.random())*w,T=0,ce("Generuje se vzorek ".concat(I," položek z celkové sumy ").concat(s.toLocaleString(),"...")),c=0,B=!1,x=!1,e.p=14,A=u(W(t,r,a,p));case 15:return e.n=16,A.next();case 16:if(!(B=!(V=e.v).done)){e.n=20;break}C=V.value.values,c++,P=1===c?1:0,ce("Zpracování vzorku - dávka ".concat(c,"/").concat(Math.ceil(l/p),"...")),L=P;case 17:if(!(L<C.length)){e.n=19;break}if(T++,j=C[L][o],O=ee(j),M=null!==O?Math.abs(O):0,(z+=M)>=S&&E.length<I&&(E.push({rowIndex:T,rowData:C[L],value:j,cumulativeValue:z}),S+=w),!(E.length>=I)){e.n=18;break}return ce("Vzorkování dokončeno - nalezeno ".concat(E.length," vzorků.")),e.a(2,E);case 18:L++,e.n=17;break;case 19:B=!1,e.n=15;break;case 20:e.n=22;break;case 21:e.p=21,D=e.v,x=!0,R=D;case 22:if(e.p=22,e.p=23,!B||null==A.return){e.n=24;break}return e.n=24,A.return();case 24:if(e.p=24,!x){e.n=25;break}throw R;case 25:return e.f(24);case 26:return e.f(22);case 27:return e.a(2,E)}},e,null,[[23,,24,26],[14,21,22,27],[8,,9,11],[1,6,7,12]])}))).apply(this,arguments)}function K(e,n,t,r,a){return q.apply(this,arguments)}function q(){return(q=l(n().m(function e(t,r,a,o,l){var s,c,i,d,v,m,y,f,k,g,h,b,I,w,E,z,N,S,T,B,x,R,A,V,C,P,L,j;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:ce("Počítá se celková suma..."),s=0,c=0,i=!1,d=!1,e.p=1,m=u(W(t,r,a,p));case 2:return e.n=3,m.next();case 3:if(!(i=!(y=e.v).done)){e.n=5;break}for(f=y.value.values,c++,ce("Počítá se suma - dávka ".concat(c,"...")),k=1===c?1:0;k<f.length;k++)g=f[k][o],h=ee(g),b=null!==h?h:0,s+=Math.abs(b);case 4:i=!1,e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,L=e.v,d=!0,v=L;case 7:if(e.p=7,e.p=8,!i||null==m.return){e.n=9;break}return e.n=9,m.return();case 9:if(e.p=9,!d){e.n=10;break}throw v;case 10:return e.f(9);case 11:return e.f(7);case 12:if((I=Q(s))&&!(I<1)){e.n=13;break}return ce("Vypočtená velikost vzorku je neplatná."),e.a(2,[]);case 13:for(w=new Set,E=re();w.size<Math.min(I,l);)z=Math.floor(("function"==typeof E?E():Math.random())*l),w.add(z);ce("Generuje se vzorek ".concat(w.size," položek z ").concat(l.toLocaleString()," řádků...")),N=[],S=0,c=0,T=!1,B=!1,e.p=14,R=u(W(t,r,a,p));case 15:return e.n=16,R.next();case 16:if(!(T=!(A=e.v).done)){e.n=20;break}V=A.value.values,c++,C=1===c?1:0,ce("Zpracování vzorku - dávka ".concat(c,"/").concat(Math.ceil(l/p),"...")),P=C;case 17:if(!(P<V.length)){e.n=19;break}if(w.has(S)&&N.push({rowIndex:S+1,rowData:V[P],value:V[P][o]}),S++,!(N.length>=w.size)){e.n=18;break}return ce("Vzorkování dokončeno - nalezeno ".concat(N.length," vzorků.")),e.a(2,N);case 18:P++,e.n=17;break;case 19:T=!1,e.n=15;break;case 20:e.n=22;break;case 21:e.p=21,j=e.v,B=!0,x=j;case 22:if(e.p=22,e.p=23,!T||null==R.return){e.n=24;break}return e.n=24,R.return();case 24:if(e.p=24,!B){e.n=25;break}throw x;case 25:return e.f(24);case 26:return e.f(22);case 27:return e.a(2,N)}},e,null,[[23,,24,26],[14,21,22,27],[8,,9,11],[1,6,7,12]])}))).apply(this,arguments)}function Q(e){var n=null;try{var t=document.getElementById("reliability-factor");if(t&&t.value){var r=ee(t.value);null!==r&&(n=r)}}catch(p){}if(null===n||Number.isNaN(n)){var a=C(v);"number"!=typeof a||Number.isNaN(a)||(n=a)}var o=null;try{var l=localStorage.getItem("significanceConfig");if(l){var s=JSON.parse(l);if(s&&"number"==typeof s.rawValue)o=s.rawValue;else if(s&&s.rawValue){var c=ee(s.rawValue);null!==c&&(o=c)}}}catch(p){}if("number"==typeof e&&!Number.isNaN(e)&&n&&o&&o>0){var i=e*n/o,u=Math.ceil(i);return Math.max(1,u)}try{var d=v,m=d.confidence,y=d.expectedError,f=d.populationSize,k=95===m?1.96:99===m?2.58:1.645,p=y/100,g=k*k*.5*.5/(p*p);return f>0&&(g/=1+(g-1)/f),Math.ceil(g)}catch(p){return 1}}function X(e,n){return!Array.isArray(e)||e.length<=1?0:e.slice(1).reduce(function(e,t){var r=ee(t&&t.length>n?t[n]:null);return null===r?e:e+Math.abs(r)},0)}function ee(e){if(null==e)return null;var n=String(e).trim();if(""===n)return null;n=(n=-1!==(n=n.replace(/\s+/g,"")).indexOf(",")&&-1===n.indexOf(".")?n.replace(",","."):n.replace(/,/g,"")).replace(/[^0-9.\-]/g,"");var t=Number(n);return Number.isFinite(t)?t:null}function ne(e){try{localStorage.setItem("TotalSumABS",JSON.stringify(e))}catch(e){console.warn("Nelze uložit TotalSumABS:",e&&e.message?e.message:e)}}function te(e){try{localStorage.setItem("task6Seed",String(e)),k=e}catch(e){console.warn("Nelze uložit seed:",e)}}function re(){try{var e=k||document.getElementById("task6-seed")&&document.getElementById("task6-seed").value;if(!e&&0!==e)return null;var n=function(e){for(var n=2166136261,t=0;t<e.length;t++)n^=e.charCodeAt(t),n=Math.imul(n,16777619)>>>0;return n+=n<<13,n^=n>>>7,n+=n<<3,n^=n>>>17,(n+=n<<5)>>>0}(String(e));return t=n,function(){t=1831565813+(t|=0)|0;var e=Math.imul(t^t>>>15,1|t);return(((e=e+Math.imul(e^e>>>7,61|e)^e)^e>>>14)>>>0)/4294967296}}catch(e){return null}var t}function ae(){var e=Date.now().toString(36),n=Math.floor(1e6*Math.random()).toString(36);return"".concat(e,"-").concat(n)}function oe(e,n){var t=document.getElementById("results"),r=document.getElementById("sample-info"),a=document.getElementById("sample-list");r.innerHTML="\n    <strong>Celkem řádků:</strong> ".concat(n,"<br>\n    <strong>Velikost vzorku:</strong> ").concat(e.length,"<br>\n    <strong>Procento vzorku:</strong> ").concat((e.length/n*100).toFixed(2),"%\n  ");var o="<strong>Vybrané řádky:</strong><br>";e.forEach(function(e,n){o+="".concat(n+1,". Řádek ").concat(e.rowIndex+1,", Hodnota: ").concat(e.value,"<br>")}),a.innerHTML=o,t.style.display="block"}function le(e,n,t,r){return se.apply(this,arguments)}function se(){return(se=l(n().m(function e(t,a,o,l){var s,c,i,u,d;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,a.getRange(o).format.fill.clear(),s=r(l);try{for(s.s();!(c=s.n()).done;)i=c.value,u=o.split(":")[0].replace(/\d+/,(i.rowIndex+1).toString())+":"+o.split(":")[1].replace(/\d+/,(i.rowIndex+1).toString()),a.getRange(u).format.fill.color="yellow"}catch(e){s.e(e)}finally{s.f()}return e.n=1,t.sync();case 1:e.n=3;break;case 2:e.p=2,d=e.v,console.log("Varování: Nepodařilo se zvýraznit řádky:",d.message);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function ce(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;try{var t=document.getElementById("notification");if(!t)return;t.textContent=e,t.style.display="block",setTimeout(function(){t.style.display="none"},n)}catch(n){console.log("Notifikace:",e)}}function ie(){var e=document.getElementById("significance-modal"),n=document.getElementById("significance-type"),t=document.getElementById("significance-value"),r=document.getElementById("significance-justification");if(e&&n&&t&&r){var a=localStorage.getItem("significanceConfig"),o=null;try{o=a?JSON.parse(a):null}catch(e){o=null}o?(n.value=o.type||"",t.value=void 0!==o.rawValue&&null!==o.rawValue?String(o.rawValue):"",r.value=o.justification||""):(n.value="",t.value="",r.value=""),"Prováděcí"===n.value?(r.value="NEVYPLŇOVAT",r.readOnly=!0):(r.readOnly=!1,"NEVYPLŇOVAT"===r.value&&(r.value="")),n.onchange=function(){"Prováděcí"===n.value?(r.value="NEVYPLŇOVAT",r.readOnly=!0):("NEVYPLŇOVAT"===r.value&&(r.value=""),r.readOnly=!1)};var l=function(e){!function(e){if(e){var n=e.value,t=e.selectionStart,r=n.replace(/%/g,"").replace(/[^0-9\-]/g,"");if(""!==r&&"-"!==r&&"+"!==r){var a=Math.abs(parseInt(r,10));if(Number.isNaN(a))e.value="";else{for(var o=String(a).replace(/\B(?=(\d{3})+(?!\d))/g," "),l=0,s=0;s<t;s++)/[0-9]/.test(n[s])&&l++;for(var c=0,i=0;c<o.length&&i<l;)/[0-9]/.test(o[c])&&i++,c++;e.value=o;try{e.setSelectionRange(c,c)}catch(e){}}}else e.value=r}}(t)};t.removeEventListener("input",l),t.addEventListener("input",l),e.style.display="flex"}else ce("Dialog hladiny významnosti není dostupný.")}function ue(){try{var e=document.getElementById("significance-type"),n=document.getElementById("significance-value"),t=document.getElementById("significance-justification");if(!e||!n||!t)return;var r=e.value||"",a=n.value?n.value.trim():"",o=t.value?t.value.trim():"";if(!r)return void ce("Prosím vyberte typ významnosti.");if("Prováděcí"!==r&&!o)return void ce('Pokud není zvoleno "Prováděcí", je potřeba zadat zdůvodnění.');var l=null;if(a){var s=(a=a.replace(/%/g,"")).replace(/[^0-9\-]/g,"");""!==s&&"-"!==s&&"+"!==s&&(l=parseInt(s,10),l=Number.isNaN(l)?null:Math.abs(l))}if(null===l)return void ce("Prosím zadejte hodnotu hladiny významnosti jako celé číslo.");"Prováděcí"===r&&(o="NEVYPLŇOVAT");var c={type:r,rawValue:l,justification:o};localStorage.setItem("significanceConfig",JSON.stringify(c));var i=document.getElementById("significance-type-display"),u=document.getElementById("significance-value-display"),d=document.getElementById("significance-justification-display");i&&(i.value=r),u&&(u.value=ve(l)),d&&(d.value=o);var v=document.getElementById("significance-modal");v&&(v.style.display="none"),ce("Hladina významnosti uložena.")}catch(e){console.error("Chyba při ukládání hladiny významnosti:",e),ce("Nelze uložit hladinu významnosti.")}}function de(){try{localStorage.removeItem("significanceConfig");var e=document.getElementById("significance-type-display"),n=document.getElementById("significance-value-display"),t=document.getElementById("significance-justification-display");e&&(e.value="",e.placeholder="Typ významnosti"),n&&(n.value="",n.placeholder="Hodnota (bez deset.)"),t&&(t.value="",t.placeholder="Zdůvodnění / stav");var r=document.getElementById("significance-modal");r&&(r.style.display="none"),ce("Hladina významnosti byla resetována.")}catch(e){console.error("Chyba při resetování hladiny významnosti:",e),ce("Nelze resetovat hladinu významnosti.")}}function ve(e){return null==e?"":String(Math.round(e)).replace(/\B(?=(\d{3})+(?!\d))/g," ")}function me(){return ye.apply(this,arguments)}function ye(){return ye=l(n().m(function e(){var t,r,a,o,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=null,e.p=1,r=document.getElementById("data-range").value,a=document.getElementById("value-column").value,t=document.getElementById("task5-result-display"),r&&a){e.n=2;break}return ce("Prosím nejprve vyberte oblast dat a sloupec (úloha 4)."),t&&(t.value=""),e.a(2);case 2:return e.n=3,Excel.run(function(){var e=l(n().m(function e(o){var l,s,c,i,d,v,m,f,k,p,g,h,b,I,w,E;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=o.workbook.worksheets.getActiveWorksheet(),-1!==(s=r).indexOf("!")&&(s=s.split("!").pop()),s=s.replace(/\$/g,"").trim(),(c=l.getRange(s)).load(["rowIndex","columnIndex","rowCount","columnCount"]),e.n=1,o.sync();case 1:if(i=F(String(a).toUpperCase()),d="number"==typeof c.columnIndex?c.columnIndex:0,!((v=i-d)<0||v>=c.columnCount)){e.n=2;break}return ce("Zadaný sloupec není v rámci vybraného rozsahu dat."),t&&(t.value=""),e.a(2);case 2:m=0,f=0,k=!1,p=!1,e.p=3,h=u(W(o,l,c));case 4:return e.n=5,h.next();case 5:if(!(k=!(b=e.v).done)){e.n=7;break}I=b.value.values,f++,ce("Zpracovává se dávka ".concat(f,"...")),m+=X(I,v);case 6:k=!1,e.n=4;break;case 7:e.n=9;break;case 8:e.p=8,E=e.v,p=!0,g=E;case 9:if(e.p=9,e.p=10,!k||null==h.return){e.n=11;break}return e.n=11,h.return();case 11:if(e.p=11,!p){e.n=12;break}throw g;case 12:return e.f(11);case 13:return e.f(9);case 14:w=Math.ceil(m),t&&(t.value=ve(w)),y=w;try{ne(y)}catch(e){}ce("Suma byla spočítána.");case 15:return e.a(2)}},e,null,[[10,,11,13],[3,8,9,14]])}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,s=e.v,console.error("Chyba při výpočtu Task5 sumy:",s&&s.stack?s.stack:s),o=s&&s.message?s.message:String(s),t&&(t.value=""),ce("Chyba při výpočtu sumy: "+o);case 5:return e.a(2)}},e,null,[[1,4]])})),ye.apply(this,arguments)}function fe(){try{var e=document.getElementById("task5-size-display"),n=null,t=document.getElementById("reliability-factor");if(t&&t.value){var r=ee(t.value);null!==r&&(n=r)}if(null===n||Number.isNaN(n)){var a=C(v);"number"!=typeof a||Number.isNaN(a)||(n=a)}var o=null;try{var l=localStorage.getItem("significanceConfig");if(l){var s=JSON.parse(l);if(s&&"number"==typeof s.rawValue)o=s.rawValue;else if(s&&s.rawValue){var c=ee(s.rawValue);null!==c&&(o=c)}}}catch(e){}var i=y;if(null==i&&document.getElementById("task5-result-display")){var u=ee(document.getElementById("task5-result-display").value);null!==u&&(i=u)}if(null===n||null===o||null===i||0===o)return e&&(e.value=""),void ce("Pro výpočet velikosti vzorku musí být nastaven faktor, významnost a spočítaná suma.");var d=n*i/o,m=Math.ceil(d);e&&(e.value=String(m)),ce("Velikost vzorku byla spočítána.")}catch(e){console.error("Chyba při výpočtu velikosti vzorku:",e&&e.stack?e.stack:e);var f=e&&e.message?e.message:String(e),k=document.getElementById("task5-size-display");k&&(k.value=""),ce("Chyba při výpočtu velikosti vzorku: "+f)}}function ke(e){try{var n=document.getElementById("task5-use-calculated"),t=document.getElementById("task5-override-area"),r=document.getElementById("task5-override-size"),a=document.getElementById("task5-override-reason");if(!n||!t)return;"no"===n.value?(t.style.display="flex",t.style.flexDirection="column"):(t.style.display="none",r&&(r.value=""),a&&(a.value=""))}catch(e){console.error("Error handling Task5 use choice:",e)}}function pe(){try{var e=document.getElementById("task5-use-calculated"),n=document.getElementById("task5-override-size"),t=document.getElementById("task5-override-reason"),r=document.getElementById("task5-confirm-info");if(!e)return void ce("Vyberte prosím, zda chcete použít vypočtenou velikost.");if("yes"===e.value){var a=document.getElementById("task5-size-display");if(!a||!a.value)return void ce("Neexistuje vypočtená hodnota. Nejprve spočítejte velikost.");var o=ee(a.value);if(null===o)return void ce("Nelze načíst vypočtenou velikost z pole.");var l=Math.ceil(o);f=l,r&&(r.textContent="");var s=document.getElementById("task6-final-size-display");s&&(s.value=String(f));var c=document.getElementById("task6-method-display"),i=document.getElementById("sampling-method");return c&&i&&(c.value=i.options[i.selectedIndex].text),ce("Velikost vzorku potvrzena (použito vypočtené)."),void(a&&(a.value=String(f)))}if("no"===e.value){if(!n||!n.value)return void ce("Zadejte prosím požadovanou velikost.");var u=ee(n.value);if(null===u||u<=0)return void ce("Žádaná velikost musí být kladné číslo.");var d=Math.ceil(u);f=d,t&&t.value,r&&(r.textContent="");var v=document.getElementById("task6-final-size-display");return v&&(v.value=String(f)),void ce("Žádaná velikost byla potvrzena a aplikována pouze do Úkolu 6.")}ce("Vyberte prosím možnost Ano nebo Ne.")}catch(e){console.error("Chyba při potvrzení požadované velikosti:",e),ce("Chyba při potvrzení velikosti.")}}function ge(e){var n=document.getElementById(e);if(n){if("SELECT"===n.tagName)try{return n.options[n.selectedIndex].text}catch(e){return""}return n.value||""}return""}function he(e){var n=document.getElementById(e);return n?n.value:""}function be(e){var n=[];for(var t in n.push(["Parametry vzorkovače",""]),e)if(Object.hasOwnProperty.call(e,t)){var r=e[t];n.push([t,null==r?"":r])}return n}function Ie(e,n){return we.apply(this,arguments)}function we(){return we=l(n().m(function e(t,r){var a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=l(n().m(function e(a){var o,l,s,c,i,u,d,v,m,y,f,k,p;return n().w(function(e){for(;;)switch(e.n){case 0:if(o=be(t),s=0,c=0,"new-sheet"!==r){e.n=1;break}(i=a.workbook.worksheets.add("ParametryVzorku")).activate(),l=i,s=0,c=0,e.n=5;break;case 1:if("above"!==r){e.n=5;break}if(u=document.getElementById("data-range").value){e.n=2;break}ce("Oblast dat není vybrána. Parametry budou vloženy na nový list."),(d=a.workbook.worksheets.add("ParametryVzorku")).activate(),l=d,s=0,c=0,e.n=5;break;case 2:return-1!==(v=u).indexOf("!")&&(v=v.split("!").pop()),v=v.replace(/\$/g,"").trim(),(m=a.workbook.worksheets.getActiveWorksheet().getRange(v)).load(["rowIndex"]),e.n=3,a.sync();case 3:return s=m.rowIndex,c=0,l=a.workbook.worksheets.getActiveWorksheet(),(y=l.getUsedRange()).load("columnCount"),e.n=4,a.sync();case 4:f=y.columnCount,l.getRangeByIndexes(s,0,o.length,f).insert(Excel.InsertShiftDirection.down);case 5:l.getRangeByIndexes(s,c,o.length,2).values=o,k=0;case 6:if(!(k<o.length)){e.n=8;break}if("Autor vzorku"!==o[k][0]||"Neznámý uživatel"!==o[k][1]){e.n=7;break}return(p=l.getRangeByIndexes(s+k,c+1,1,1)).format.font.bold=!0,p.format.fill.color="#FFFF00",p.format.font.color="#000000",e.a(3,8);case 7:k++,e.n=6;break;case 8:return e.n=9,a.sync();case 9:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error("Chyba při tisku parametrů:",a),ce("Chyba při tisku parametrů.");case 3:return e.a(2)}},e,null,[[0,2]])})),we.apply(this,arguments)}function Ee(){var e={};e["Kontrolní riziko"]=v.controlRisk||"",e["Přirozené riziko"]=v.inherentRisk||"",e["Hladina RMM"]=v.rmmLevel||"",e["Provádím analytické testy?"]=v.analyticalTests||"",e["Provádím testy kontrol?"]=v.controlTests||"",e["Faktor spolehlivosti (výsledný)"]=ge("reliability-factor"),e["Typ významnosti"]=ge("significance-type-display"),e["Hodnota významnosti"]=ge("significance-value-display"),e["Zdůvodnění významnosti"]=ge("significance-justification-display"),e["Oblast dat"]=ge("data-range"),e["Sloupec pro výběr"]=ge("value-column"),e["Celková suma absolutních hodnot"]=ge("task5-result-display"),e["Vypočtená velikost vzorku"]=ge("task5-size-display");var n=ge("task5-use-calculated");return e["Použít vypočtenou velikost"]=n,"Ne"===n&&(e["Uživatelská velikost vzorku"]=ge("task5-override-size"),e["Důvod uživatelské velikosti"]=ge("task5-override-reason")),e["Metoda výběru vzorku"]=ge("task6-method-display"),e["Finální velikost vzorku"]=ge("task6-final-size-display"),e["Vyloučit nadlimitní položky"]=ge("task6-exclude-over-significance"),e["Suma pro výpočet (po úpravě)"]=ge("task6-param-sum-display"),e["Počet položek nad významností"]=ge("task6-significant-count-display"),e["Seed pro generátor"]=ge("task6-seed"),e["Autor vzorku"]="Neznámý uživatel",e["Datum a čas vyhotovení"]=(new Date).toLocaleString(),e}Office.onReady(function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var n=document.getElementById("set-reliability");n&&(n.onclick=g);var t=document.getElementById("reset-sampler");t&&(t.onclick=b);var r=document.getElementById("select-range");r&&(r.onclick=j);var a=document.getElementById("select-column");a&&(a.onclick=M);var o=document.getElementById("task5-compute-sum");o&&(o.onclick=me);var l=document.getElementById("task5-calc-size");l&&(l.onclick=fe);var s=document.getElementById("task5-use-calculated");s&&(s.onchange=ke);var c=document.getElementById("task5-confirm-size");c&&(c.onclick=pe);var i=document.getElementById("sampling-method");i&&(i.onchange=function(){var e=document.getElementById("task6-method-display");e&&(e.value=i.options[i.selectedIndex].text)});try{var u=document.getElementById("task6-method-display"),d=document.getElementById("sampling-method");u&&d&&(u.value=d.options[d.selectedIndex].text)}catch(e){}var f=document.getElementById("task6-exclude-over-significance");f&&(f.onchange=function(e){try{!function(e){try{localStorage.setItem("task6ExcludeOverSignificance",String(e))}catch(e){console.warn("Nelze uložiť volbu Task6 do storage:",e&&e.message?e.message:e)}}(f.value)}catch(e){console.warn("Nelze uložit volbu v Task6:",e)}});try{!function(){try{var e=localStorage.getItem("task6ExcludeOverSignificance"),n=document.getElementById("task6-exclude-over-significance");if(!n)return;if(!e)return void(n.value="");n.value=e}catch(e){console.warn("Nelze načíst volbu Task6 z storage:",e&&e.message?e.message:e)}}()}catch(e){}try{!function(){try{var e=localStorage.getItem("task6PrintTarget"),n=document.getElementById("task6-print-target");if(!n)return;n.value=e||""}catch(e){console.warn("Nelze načíst tisk target:",e)}}()}catch(e){}var p=document.getElementById("task6-compute-adjusted-sum");p&&(p.onclick=x);var h=document.getElementById("task6-print-target");h&&(h.onchange=function(){try{!function(e){try{localStorage.setItem("task6PrintTarget",String(e))}catch(e){console.warn("Nelze uložit tisk target:",e)}}(h.value)}catch(e){console.warn(e)}});var w=document.getElementById("task6-generate-sample");w&&(w.onclick=I);var z=document.getElementById("task6-generate-parameters");z&&(z.onclick=E);var N=document.getElementById("task6-seed");N&&(N.onchange=function(){try{te(N.value)}catch(e){console.warn(e)}});try{!function(){try{var e=localStorage.getItem("task6Seed"),n=document.getElementById("task6-seed");e&&n&&(n.value=e,k=e)}catch(e){console.warn("Nelze načíst seed:",e)}}()}catch(e){}var S=document.getElementById("task6-generate-seed"),T=document.getElementById("task6-regenerate-seed");S&&(S.onclick=function(){var e=ae();try{document.getElementById("task6-seed").value=e,te(e),ce("Seed vygenerován.")}catch(e){console.warn(e)}}),T&&(T.onclick=function(){var e=ae();try{document.getElementById("task6-seed").value=e,te(e),ce("Seed znovu vygenerován.")}catch(e){console.warn(e)}});var B=document.getElementById("fill-significance");B&&(B.onclick=ie);var R=document.getElementById("significance-save-btn"),O=document.getElementById("significance-cancel-btn"),Z=document.getElementById("significance-reset-btn");R&&(R.onclick=ue),O&&(O.onclick=function(){var e=document.getElementById("significance-modal");e&&(e.style.display="none")}),Z&&(Z.onclick=de),function(){try{var e=localStorage.getItem("reliabilityConfig");if(!e)return;var n=JSON.parse(e);if(!n)return;v.controlRisk=n.controlRisk||v.controlRisk,v.inherentRisk=n.inherentRisk||v.inherentRisk,v.rmmLevel=n.rmmLevel||v.rmmLevel,v.analyticalTests=n.analyticalTests||v.analyticalTests,v.controlTests=n.controlTests||v.controlTests,m=!0;var t=C(v),r=document.getElementById("reliability-factor");r&&(null!==t?(r.placeholder="",r.value=String(t),L(r,String(t))):P())}catch(e){console.warn("Nelze načíst nastavení z localStorage:",e.message)}}(),P(),function(){try{var e=localStorage.getItem("significanceConfig"),n=null;try{n=e?JSON.parse(e):null}catch(e){n=null}var t=document.getElementById("significance-type-display"),r=document.getElementById("significance-value-display"),a=document.getElementById("significance-justification-display");n?(t&&(t.value=n.type||""),r&&(r.value=void 0!==n.rawValue&&null!==n.rawValue?ve(n.rawValue):""),a&&(a.value=n.justification||"")):(t&&(t.value="",t.placeholder="Typ významnosti"),r&&(r.value="",r.placeholder="Hodnota (bez deset.)"),a&&(a.value="",a.placeholder="Zdůvodnění / stav"))}catch(e){console.warn("Nelze načíst hladinu významnosti ze storage:",e.message)}}();try{!function(){try{var e=localStorage.getItem("TotalSumABS");if(!e)return;var n=JSON.parse(e);if(null!=n){y=n;var t=document.getElementById("task5-result-display");t&&(t.value=ve(Math.round(y)))}}catch(e){console.warn("Nelze načíst TotalSumABS:",e&&e.message?e.message:e)}}()}catch(e){}var D=document.getElementById("reliability-modal"),U=document.getElementById("modal-save-btn"),G=document.getElementById("modal-cancel-btn"),F=document.getElementById("modal-reset-btn");U&&(U.onclick=V),G&&(G.onclick=function(){D&&(D.style.display="none")}),F&&(F.onclick=A)}})}(),new URL(t(58394),t.b),new URL(t(3432),t.b)}();
//# sourceMappingURL=taskpane.js.map